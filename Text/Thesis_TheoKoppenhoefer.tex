

\input{../Latex_Templates/Preamble_Thesis}

%%%%% TITLE PAGE


% \usepackage{../Latex_Templates/MA_Titlepage}

% birthdate
% \birthday{November 9th 2000}
% % birthplace
% \birthplace{Heidelberg}
% \date{\today}

% supervisor
\supervisor{Supervisor: Erik Wahlén}
% examinor
\examinor{Examiner: Evgeniy Lokharu}
%Name des Instituts an dem der Betreuer der Arbeit tätig ist.
%z.B.: Mathematisches Institut
% \institute{Institut }
%\institute{Mathematisches Institut}
\documenttype{Master thesis in mathematics}

%\subject{, VT23}
\title{Some relations between equilibria of harmonic vector fields and the domain topology}
%\subtitle{}
\author{Theo Koppenhöfer}
\date{\today}

\addbibresource{bibliography.bib}

% \usepackage{mdframed}
% \surroundwithmdframed[nobreak=true]{question}


\usepackage{pdfpages}
\usepackage{svg}
\graphicspath{{../Plots/}}
\graphicspath{{../Figures/}}

\usepackage{makecell}
\newcounter{symbolCount}
\newcommand{\nomenclature}[2]{\stepcounter{symbolCount}
\glsxtrnewsymbol[description={#2}]{\arabic{symbolCount}}{#1}}
\usepackage[symbols,
  stylemods={tree},% loads glossaries-extra-stylemods to patch styles
  record, % using 'bib2gls'
  nonumberlist
]{glossaries-extra}

% % assign titles to group labels: 
% \glsxtrsetgrouptitle{latin}{Latin}
% \glsxtrsetgrouptitle{greek}{Greek}

% \GlsXtrLoadResources[
%  src={symbolsList.bib},
%  type=symbols,
% %  group={latin},% assign group label
% %  set-widest,% needed for 'alttree' styles
%  save-locations=false
% ]

% \glsxtrnewsymbol[description={velocity}]{v}{\ensuremath{v}}



% The following displays the labels, uncomment for final version
% \usepackage{showlabels}

\newcommand{\ownresult}{{[$*$]}}
\newcommand{\bigsetminus}{\mathbin{\big\backslash}}
% \renewcommand{\chaptername}{Section}
\newcommand{\openX}{\interior\brk*{X}}

%%%%% The content starts here %%%%%%%%%%%%%


\begin{document}

% \maketitle 
\includepdf[pages={1}]{../Mall/omslag.pdf}

\setcounter{page}{-4}

\section*{Abstract}

% This 
% In this thesis we will broadly speaking inspect how the number $M$
% of critical points of a harmonic function $f$ on a domain $X$
% relate to the topology of this domain and the 
Given a harmonic vector field $u$ on a bounded domain we call the set on which $u$ enters
the domain entrant boundary and the set on which $u$ exits the domain emergent boundary.
In the first part of this thesis we ask the question of 
when it is possible to have interior stagnation points and
connected entrant and connected emergent boundaries.
The answer in two dimensions is essentially `no'.
If one allows for holes in the domain the answer becomes a `yes'
for which we give explicit examples.
In four dimensions a simple example shows that
this is possible with the ball as the domain.
In three dimensions we use Morse theory to argue that the number of
stagnation points is even. With the help of this result and numerical methods we found a harmonic
polynomial on the ball which has interior stagnation points and simply connected
entrant and emergent sets.

The second part revolves around whether there exist harmonic vector fields
with interior stagnation points and without boundary stagnation points.
This question in two dimensions yields a very elegant relation between the
domain topology and the number of interior critical points. 
As a special case we obtain statements about harmonic vector fields which are tangential at the boundary.
We also give examples of vector fields illustrating this point.
In three dimensions we do not find such an example but we use Morse theory to infer 
that for such an example the number of critical points has to be even.

As part of the thesis we formulate a version of Morse theory by \cite{Agrach1991}
and \cite{Handron2002}
for manifolds with boundaries.
This relates the domain topology with the number of critical points.
Additionally we give a proof for the density of Morse functions
for this type of Morse theory.

\section*{Populärvetenskaplig sammanfattning}

Givet ett harmoniskt vektorfält $u$ på en begränsad domän kallar vi den mängd där $u$ träder in i
domänen för entrantrand och den mängd där $u$ lämnar domänen emergentrand. I den första
delen av detta examensarbete ställer vi frågan om när det är möjligt att ha inre stagnationspunkter
och sammanhängande entrant- och sammanhängande emergentrand. Svaret i två dimensioner är
i huvudsak `nej'. Om man tillåter hål i domänen blir svaret ett `ja', vilket vi
ger explicita exempel på. I fyra dimensioner visar ett enkelt exempel att detta är möjligt med
bollen som domän. I tre dimensioner använder vi Morse-teorin för att visa att antalet
stagnationspunkter är jämnt. Med hjälp av detta resultat och numeriska metoder fann vi ett harmoniskt
polynom på bollen som har inre stagnationspunkter och enkelt sammanhängande entrant- och
emergentrand.

Den andra delen handlar om huruvida det finns harmoniska vektorfält med inre
stagnationspunkter och utan stagnationspunkter på gränsen. Denna fråga i två dimensioner ger
ett mycket elegant samband mellan domänens topologi och antalet inre kritiska punkter.
Som ett specialfall får vi uttalanden om harmoniska vektorfält som är tangentiella vid
randen. Vi ger också exempel på vektorfält som illustrerar denna punkt. I tre dimensioner
hittar vi inget sådant exempel, men vi använder Morse-teorin för att dra slutsatsen att för ett sådant exempel
antalet kritiska punkter måste vara jämnt.

Som en del av examensarbetet formulerar vi en version av Morse-teorin enligt \cite{Agrach1991}
och \cite{Handron2002}
för mångfalder med kantiga ränder.
Denna relaterar domäntopologin till antalet kritiska punkter.
Dessutom ger vi ett bevis för tätheten av Morsefunktioner
för denna typ av Morse-teori.

\section*{Acknowledgements}
\td{Heap praise on people here. In particular:
Erik Wahlén, Martin Löfström, Ludvig Sundell, Anne-Lisa Rathsmann, Thomas Renström,
others}

% \td{Heap praise on whoever comes to mind.}

\tableofcontents

% \listoftodos

\todoin[]{
  General TODOs
  \begin{itemize}
    \item Check for typos.
    \item add Alber to sources
    \item Should I call thesis `Some applications of Morse theory to harmonic vector fields'?
    \item Make sure tangential to boundary is excluded.
  \end{itemize}
}

\chapter{Introduction}

Harmonic vector fields arise naturally within certain areas of mathematics and physics.
Classical electrostatic, magnetic and gravitational fields in vacuum are examples of harmonic vector fields.
Other examples are the heat flow in a system that has reached steady state or
an irrotational flow through an inviscid incompressible medium.
The null points of for instance the electrostatic or magnetic fields
are particularly interesting.
These are examples of stagnation points of harmonic vector fields.
If one considers the underlying potentials which exist at least locally then these stagnation points
are critical points of a harmonic function.
The study of these points has a long tradition.
Walsh gives in \cite{Walsh1950} a comprehensive overview of the state of knowledge regarding 
critical points of harmonic functions in 1950.
In particular complex analysis by that time had clarified the situation in two dimensions
significantly though far less was (and is) known about the situation in three dimensions.
20 years later Morse applies his theory in \cite{Morse1969} and \cite{Morse1970}
to the critical points of harmonic functions.
Morse gives in both works a set of inequalities for two and three dimensions relating the number and type of critical points on the
boundary and the interior with the domain topology.
He then poses in \cite{Morse1970} the question: To a given
set of numbers of critical points and a domain topology fulfilling these inequalities does there exists a
harmonic function in $\R^3$ with precisely these numbers of critical points?
This question is answered affirmatively in 1980 in \cite{Shelton1980} with a 
construction using line charges. 
Inspired by this we will apply Morse theory to harmonic functions in an attempt to
answer the following question:
\begin{question}[Flowthrough with stagnation point]\label{qu:flowthroughStagnationPoint}
  Does there exist a domain $X\subseteq\R^d$ homeomorphic to a ball and a harmonic vector field $u\colon X\to\R^d$ on $X$ such that
  \begin{enumerate}
    \item $u$ has an interior stagnation point
    \item the boundary on which $u$ enters the region is simply connected?
  \end{enumerate}
\end{question}
The answer to this will turn out to be `yes' for dimensions $d\geq3$ and `no' for $d=2$ dimensions.
Somewhat related, \cite[p.198]{Lortz1970} poses the question whether it is possible to have a harmonic vector field
without inflow or outflow through the boundary with interior stagnation points in $\R^3$.
Inspired by this we will also consider the following question:
\begin{question}[Harmonic vector fields without inflow or outflow]
  Let $u$ be a harmonic vector field in a domain $X$ such that at every boundary point it is tangential to the boundary
  and non-vanishing.
  What can be said about the relation between the number of stagnation points and the domain topology?
\end{question}
In fact we will use Morse theory to deal with the following more general question:
\begin{question}[Harmonic vector fields without boundary stagnation points]
  \label{qu:noInflowNoOutflow}
  Let $u\colon X\to\R^d$ be a harmonic vector field on a domain $X$ without boundary stagnation points.
  What can be said about the relation between the number of stagnation points and the domain topology?
\end{question}
This question yields a very nice result in the case of $d=2$ dimensions.
More concretely we will show that the number of stagnation points equals the negative Euler characteristic of the domain.
In $d=3$ dimensions we will show that the number of stagnation points has to be even.

The thesis starts out with some mathematical preliminaries.
Here we discuss some important definitions to make the formulation of these
questions more precise
and show the density of Morse functions.
In the next chapter we state the Morse inequalities for manifolds with corners and give a motivation as to why they hold.
The next chapter gives an essentially negative answer to question \ref{qu:flowthroughStagnationPoint} in the case of two dimensions.
Here we also give examples of planar
harmonic vector fields on domains with holes and an example in four dimensions.
Chapter \ref{ch:n3_inflowOutflow} then deals with the three-dimensional case where we give an explicit example which answers question \ref{qu:flowthroughStagnationPoint}
affirmatively in three dimensions.
Chapter \ref{ch:n2_hvf_noInflowNoOutflow} then deals with question \ref{qu:noInflowNoOutflow} in two dimensions where we give an elegant relation
between the number of critical points and the domain topology.
In the final chapter we discuss the case of question \ref{qu:noInflowNoOutflow} in three dimensions where we give a condition
on the number of interior stagnation points.

This thesis is directed to an audience with basic knowledge of harmonic functions such
as the maximum principle, the mean value property and the existence and uniqueness of solutions.
For a comprehensive introduction to the
theory of partial differential equations more generally we refer the reader to \cite{Evans2010}.
We also assume the reader has had exposure to basic topology and some form of differential topology or
differential geometry. 
In some parts knowledge of complex analysis as in for example \cite{Gamelin2001} is required though it is not 
essential to understand the thesis.
Elementary knowledge of convex optimisation is helpful but not a prerequisite.
Despite Morse theory playing a central role in this thesis we do not assume that the reader has had
prior exposure to this topic. To simplify things we avoid the language of homology
theory where possible and instead give the theory in the classical sense as a set of inequalities.
Thus we do not require prior knowledge of algebraic topology.

\chapter{Mathematical preliminaries}

In this chapter we give some important definitions. We start of by defining harmonic vector fields.
After this we define Manifolds with corners, stratified spaces and the entrant and emergent boundaries.
We then give a definition of stagnation points, type numbers and Morse functions for
vector fields. Throughout we give examples and elementary results to illustrate the definitions.
In the final part of this chapter we prove that harmonic functions can essentially be approximated by harmonic Morse functions
whilst preserving certain properties.

\section{Harmonic vector fields}

Unless otherwise stated we denote by $X\subseteq\R^d$ a compact subset of $\R^d$ with boundary $\Sigma=\partial X$ and nonempty interior
$\openX$.
In the following we will work in dimensions $d\in\brk[c]{2,3}$.
Throughout the thesis we denote by
\begin{align*}
  f\colon X\to\R
\end{align*}
a $C^2$ function on $X$. Often $f$ will be assumed to be \emph{harmonic},
that is $\Delta f=0$ on $\openX$ where $\Delta$ denotes the Laplace operator.
We also denote by
\begin{align*}
  u\colon X\to\R^d
\end{align*}
a vector field of class $C^1$.
In the following we often assume that $u$ is in fact a \emph{harmonic vector field}, that is $u$ fulfils
$\diver u=0$ and $\curl u=0$ on $\openX$.
Note that a harmonic function $f$ gives rise to a harmonic vector field via its gradient $u=\nabla f$.
In general a harmonic vector field $u$ is not the gradient of a harmonic function which one sees for instance in example \ref{ex:n2_flowthroughHole}.
% \section{On harmonic vector fields}
% In the following we deduce some basic relations for harmonic vector fields in dimensions $d\in\brk[c]{2,3}$.
On simply connected domains this implication is however true:
\begin{proposition}[Harmonic vector fields on simply connected domains]\label{pr:n2:hvf:simplyConnected}
  Let $d\in\brk[c]*{2,3}$ and $\Omega\subseteq\R^d$ be open and simply connected and $u\colon\Omega\to\R^d$ be a harmonic vector field. Then
  \begin{enumerate}
    \item 
    $u=\nabla f$ is the gradient field of some
    function $f\colon\Omega\to\R$.
    \item  $f$ is harmonic.
    \item $u$ is in fact smooth.
    \item The components $u_i$ are harmonic.
  \end{enumerate}
\end{proposition}
\begin{proof}
  \begin{enumerate}
    \item 
    Since $\curl u =0$ this is a direct consequence of Stokes theorem.
    \item This follows from $\Delta f = \diver u=0$.
    \item This follows from the fact that $f$ is harmonic.
    \item This follows from $u_i=\partial_if$.\qedhere
  \end{enumerate}
\end{proof}
If one considers not necessarily simply connected domains $\Omega$ then we obtain the
properties of proposition \ref{pr:n2:hvf:simplyConnected} at least locally.

% \begin{align*}
%   \diver u=0 \qquad \text{ and }\qquad \curl u=0\,.
% \end{align*}
% Often but not always we assume that in fact $u=\nabla f$ is a gradient field.


\nomenclature{$d$}{Dimensions $d=2$ or $d=3$}
\nomenclature{$X$}{Compact domain in $\R^d$, often assumed to be a manifold with corners.}
% \nomenclature{$\Omega$}{Interior $\Omega=\interior\brk*{X}$}
\nomenclature{$f\colon X\to\R$}{A harmonic function.}
\nomenclature{$u\colon X\to\R^d\text{ or }T^*X$}{A harmonic vector field.}

\section{Stratified spaces and the entrant and emergent boundary}

We start by requiring some regularity for the boundary of $X$.
More precisely, we require $X$ to be a compact Riemannian manifold with corners:
\begin{definition}[Manifolds with corners, \cite{Handron2002}]
  We introduce the notation
  \begin{align*}
    H_j^d\leftdef\R_{\geq0}^j\times\R^{d-j}\subseteq\R^d\,.
  \end{align*}
  where $j\in\brk[c]*{0,\dots,d}$.
  A \emph{manifold with (convex) corners} is a topological space $X$ together with an atlas $\cA$ such that for every point
  $x\in X$ there exists an open neighbourhood $U_x$ of $x$, a number $j=j(x)$ and a
  diffeomorphism $\phi_x\colon U_x\to H_j^d$ in $\cA$ with $\phi_x(x)=0$.
  We further define for $k\in\brk[c]*{0,\dots,d}$ a collection of sets 
  \begin{align}
    X_k\leftdef\brk[c]*{x\in X\colon j(x)=d-k}\label{eq:def_mfCorners_stratification},
  \end{align}
  which form a stratification of $X$.
\end{definition}

More generally we give the definition of a stratification as follows:
\begin{definition}[Stratified space, \cite{Handron2002}]\label{df:stratified_space}
  Let $X$ be a topological space. A \emph{stratum} is a subspace $X_j\subseteq X$, $j\in\cJ$, indexed by a partially ordered set $\cJ$ such that
  \begin{enumerate}
    \item each $X_j$ is a manifold (without boundary) of dimension $n=n(j)$
    \item $X=\bigcup_jX_j$
    \item $X_j\cap \overline{X}_k\neq\emptyset$ iff $X_j\subseteq\overline{X}_k$ iff $j\prec k$.
  \end{enumerate}
  The pair of $X$ and the collection of strata is called a \emph{stratified space} and we call
  $n$ the \emph{dimension of the stratum $X_j$}.
  In the case that $X_j\subseteq\overline{X}_k$ 
  we will write $X_j\prec X_k$ using the notation of \cite{Handron2002}.
  If additionally $n(k)=n(j)+1$ we will
  write $X_j\precsim X_k$ or, indicating that the strata differ by one in their dimension, we may write $X_k=X_{j+1}$.
\end{definition}
\nomenclature{$X_j$}{A stratification of $X$ as given in definition \ref{df:stratified_space}.
   Often but not always assumed to be given by equation \eqref{eq:def_mfCorners_stratification}}
\nomenclature{$\prec$}{We write $X_j\prec X_k$ if $X_j\subseteq\overline{X}_k$. See definition \ref{df:stratified_space} for details.}
\nomenclature{$\precsim$}{We write $X_j\precsim X_k$ if $X_j\prec X_k$ and the strata differ in dimension by one. See definition \ref{df:stratified_space} for details.}

In the case that the stratification arises through relation \eqref{eq:def_mfCorners_stratification}
we have precisely $X_{j}\precsim X_{j+1}$ for $j\in\brk[c]*{1,\dots,d-1}$.
Note that in general for a given stratum $X_j$ the stratum $X_{j+1}$ such that $X_j\precsim X_{j+1}$ need not be unique.
In the following we assume, unless otherwise stated, that the stratification is finite, that is $\#\cJ<\infty$ and 
that the interior $\openX$ corresponds to a single stratum.

We now give the definition of the contingent cone:
\begin{definition}[Contingent cone, {\cite[Def. 4.6]{Jahn2020}}]
  Denote the \emph{(Bouligand) contingent cone} for a set $Y\subseteq X$ at the point $x\in\overline{Y}$ by $C_xY$.
  It is defined as the set of all $v\in\R^d$ such that there exist sequences $\lambda\colon\N\to\R_{>0}$ and $x_n\to x$ in
  $Y$ such that
  $$\lim_n\lambda_n\brk*{x_n-x}=v\,.$$
\end{definition}

To clarify we give an example:
\begin{example}[Cubical domain]
  Consider the domain to be the cube $X=[-1,1]^2\subseteq\R^2$.
  Then we have a stratification given by
  \begin{align*}
    X_0&=\brk[c]*{\vect{-1\\-1},\vect{-1\\1},\vect{1\\1},\vect{1\\-1}}\\
    X_1&=\brk*{I\times\brk[c]*{-1}}\cup \brk*{I\times\brk[c]*{1}}\cup\brk*{ \brk[c]*{-1}\times I}\cup\brk*{ \brk[c]*{1}\times I}\\
    X_2&=I\times I
  \end{align*}
  where $I=(-1,1)\subseteq\R$.
  The stratification is depicted in figure \ref{fi:n2_stratificiation_square}.
  \begin{figure}
    \centering
    \begin{minipage}[h]{0.35\textwidth}
      \input{../Figures/n2_stratificiation_square.pdf_tex}
      \caption{A stratification of $X$.}
      \label{fi:n2_stratificiation_square}
    \end{minipage}
    \hfill
    \begin{minipage}[h]{0.6\textwidth}
      \input{../Figures/n2_tangencyCone_square.pdf_tex}
      \caption{The contingent cones for various $x\in X$.}
      \label{fi:n2_tangencyCone_square}
    \end{minipage}
  \end{figure}
  For an interior point $x\in X_2$ we have 
  the contingent cone $C_xX=\R^2$.
  For a boundary point $x\in Y\leftdef I\times \brk[c]*{1}\subset X_1$ we have the contingent cone
  \begin{align}
    C_xX=\brk[c]*{v\in T_x\R^2\colon v\cdot n\leq 0}\label{eq:n2_cube_boundaryPt}
  \end{align}
  where the basis vector $n=e_2$ is the outer unit normal. At the boundary point $x=\vect{1&1}^\top\in X_0$ we have
  \begin{align}
    C_xX=\brk[c]*{v\in T_x\R^2\colon v_1\leq0\text{ and }v_2\leq 0}\,.\label{eq:n2_cube_cornerPt}
  \end{align}
  The situation is depicted in figure \ref{fi:n2_tangencyCone_square}.
  The contingent cone on the other parts of the square $\Sigma=\partial X$ is given by similar formulas.
\end{example}

In the following we define the emergent and the entrant boundary in a way that generalises
\cite[p.282]{Morse1970} for stratified manifolds.
\begin{definition}[Emergent and entrant boundary]\label{df:emergentEntrantBd}
  We call a vector $v\in T_xX$ \emph{entrant} at a boundary point $x\in\Sigma$ if
  \begin{enumerate}
    \item $v$ lies in the contingent cone $C_xX$ or
    \item $v$ lies in the dual cone of the contingent cone $C_xX$, that is
    \begin{align*}
      v\in \brk*{C_xX}^*=\brk[c]*{w\in T_xX\colon w\cdot w'\geq0\text{ for all }w'\in C_xX}\,.
    \end{align*}
  \end{enumerate}
  We call $v$ \emph{strictly entrant} if in addition $v$ lies in the relative interior $\relint C_xX$ or if $v\in\brk*{C_xX}^*$ then
  $v$ lies in the relative interior $\relint\brk*{C_xX}^*$.
  Analogously $v$ is \emph{(strictly) emergent} if $-v$ is (strictly) entrant.
  Now define the \emph{entrant boundary} $\Sigma^{\leq0}$ to be the set of boundary points at which $u$ is entrant.
  We define the \emph{strictly entrant boundary} $\Sigma^-$ to be the set of strictly entrant boundary points of $u$.
  In the same manner we define the \emph{emergent boundary} $\Sigma^{\geq0}$ and the \emph{strictly emergent boundary} $\Sigma^+$.
  Further define the \emph{tangential boundary} $\Sigma^0$ to be
  \begin{align*}
    \Sigma^0\leftdef\brk*{\Sigma^{\leq0}\cup\Sigma^{\geq0}}\bigsetminus\brk*{\Sigma^+\cup\Sigma^-}\subseteq\Sigma\,.
  \end{align*}
\end{definition}
\nomenclature{$\Sigma$}{Boundary $\Sigma=\partial X$}
\nomenclature{$\Sigma^-$, $\Sigma^{\leq0}$}{(Strictly) entrant boundary. See definition \ref{df:emergentEntrantBd}.}
\nomenclature{$\Sigma^+$, $\Sigma^{\geq0}$}{(Strictly) emergent boundary. See definition \ref{df:emergentEntrantBd}.}
\nomenclature{$\Sigma^0$}{Tangential boundary. See definition \ref{df:emergentEntrantBd}.}
\nomenclature{$\Sigma^\text{irr}$}{Irregular boundary. See definition \ref{df:nonDegeneracy}.}
\nomenclature{$B_r(x)$, $B_r$}{Ball of radius $r$ around the point $x$ / the origin.}
\nomenclature{$S^{d-1}(x)$, $S^{d-1}$}{$(d-1)$-dimensional sphere around $x$ / the origin.}
\nomenclature{$e_j$}{$j$-th unit vector in $\R^d$.}
% We would now like to illustrate the preceding definitions.
% \begin{example}\label{ex:n3_hvf_canonical}
%   We now consider our domain to be the ball $B_1\subseteq\R^3$ around the origin in $d=3$ dimensions.
%   Consider the harmonic function
%   \begin{equation}
%     \begin{aligned}
%     f\colon \Omega&\to\R \\
%     x&\mapsto x_1^2+x_2^2-2x_3^2\label{eq:n3_hf_canonical}
%     \end{aligned}
%   \end{equation}
%   Which induces the harmonic vector field $u=\nabla f$, or more precisely
%   \begin{equation}
%     \begin{aligned}
%     u\colon \Omega&\to\R^3 \\
%     x&\mapsto \vect{2x_1 & 2x_2 & -4x_3}^\top\,.\label{eq:n3_hvf_canonical}
%     \end{aligned}
%   \end{equation}
%   We have that the normal to the boundary $\Sigma=S^2$ is given by
%   \begin{align*}
%     n\colon S^2&\to S^2 \\
%     x&\mapsto x
%   \end{align*}
%   and thus we have that $x\in\Sigma^-$ iff 
%   \begin{align*}
%     0>n\cdot u = 2\brk*{x_1^2+x_2^2-2x_3^2}=2f(x)
%   \end{align*}
%   A plot of the sets can be seen in figure \ref{pl:n3_hvf_canonical_boundary}.
%   \begin{figure}
%     \centering
%     \missingfigure[figwidth=0.7\textwidth]{}
%     \caption{Plots of the entrant, emergent and tangential boundary for the
%       function $f$ given by equation \eqref{eq:n3_hf_canonical}}
%     \label{pl:n3_hvf_canonical_boundary}
%   \end{figure}
% \end{example}
% \td{illustrate on boundary with corners}

Although the condition that we call a vector entrant if it lies in the contingent cone $C_xX$ is more or less intuitive
the second criteria requires a little motivation.
For this consider a vector field $u$ and a tangent vector $v$ at the corner point $x$ as in figure \ref{fi:n2_entrantVector}.
Since $v$ does not point into $X$ it does not satisfy the first condition.
Now assume we place a test particle at $x$ which is confined to $X$ and $u$ describes a force acting on this particle.
This test particle
will then move away from the point $x$ and in this manner we would like to call $u$ at $x$ entrant.
This type of reasoning is made precise in the proof of the Morse inequalities in \cite{Agrach1991} and \cite{Handron2002}
where a flow on $X$ is constructed.
This motivates why we added a second criteria for calling $v$ entrant.
\begin{figure}
  \centering
  \begin{minipage}[h]{0.45\textwidth}
    \centering
    \input{../Figures/n2_entrantVector.pdf_tex}
    \caption{The vector $v$ is entrant.}
    \label{fi:n2_entrantVector}
  \end{minipage}
  \hfill
  \begin{minipage}[h]{0.45\textwidth}
    \centering
    \input{../Figures/n2_contingentCone_smooth.pdf_tex}
    \caption{Depiction of $\brk*{C_xX}^*$ for a manifold with $C^1$ boundary.}
    \label{fi:n2_contingentCone_smooth}
  \end{minipage}
\end{figure}

We would also like to motivate the naming of the tangential boundary.
Assume that $X$ is a manifold with $C^1$ boundary and without corners.
Let $x\in\Sigma$ be a boundary point and let $n$ denote the outer unit normal at $x$.
Then we have that
\begin{align*}
  \brk*{C_xX}^*=\brk[c]*{w\in T_xX\colon w\cdot w'\geq0\text{ for all }w'\in C_xX}
  =\brk[c]*{-rn\colon r\geq0}\,.
\end{align*}
This situation is depicted in figure \ref{fi:n2_contingentCone_smooth}.
If the vector $v$ lies in $\brk*{C_xX}^*$ but not in the relative interior $\relint\brk*{C_xX}^*$
we in fact have that $v=0$. Thus the tangential boundary $\Sigma^0$ consists in this case of
precisely those boundary points at which $u$ is tangential to the boundary or vanishes.

We would now like to illustrate definition \ref{df:emergentEntrantBd} with a more concrete example.
\begin{example}[A vector field on the cube]\label{ex:n2_hvf_canonical}
  Consider the domain to be the cube $X=[-1,1]^2\subseteq\R^2$
  and the harmonic function
  \begin{equation}
    \begin{aligned}
    f\colon X&\to\R \\
    x&\mapsto x_1^2-x_2^2\,.\label{eq:n2_hf_canonical}
    \end{aligned}
  \end{equation}
  This induces the harmonic vector field $u=\nabla f$, or more precisely
  \begin{equation}
    \begin{aligned}
    u\colon X&\to\R^3 \\
    x&\mapsto 2\vect{x_1 & -x_2}^\top\,.\label{eq:n2_hvf_canonical}
    \end{aligned}
  \end{equation}
  % For a boundary point $x\in I\times\brk[c]*{1}$ the dual cone of the contingent cone
  % $C_xX$ is given by
  % \begin{align*}
  %   \brk*{C_xX}^*=\brk[c]*{-r e_2\colon r\geq0}\,.
  % \end{align*}
  % By equation \eqref{eq:n2_cube_boundaryPt} we have that $x\in\Sigma^{-}$ if
  For a boundary point $x\in I\times\brk[c]*{1}$ we have that
  \begin{align*}
    0>  -2x_2=n\cdot u
  \end{align*}
  and thus by equation \eqref{eq:n2_cube_boundaryPt} it follows that $x\in\Sigma^{-}$
  so $I\times\brk[c]*{1}\subseteq\Sigma^{-}$.
  At the corner point $x=\vect{1&1}^\top$ the dual of the contingent cone is given by
  \begin{align}
    \brk*{C_xX}^*=C_xX\label{eq:n2_hvf_canonical_CxX}
  \end{align}
  where we used the characterisation of equation \eqref{eq:n2_cube_cornerPt}.
  Since $v=u(x)=2\vect{1 &-1}^\top$ we have that $v\notin\brk*{C_xX}^*$ and $-v\notin\brk*{C_xX}^*$
  and thus $x\notin\Sigma^{\geq0}\cup\Sigma^{\leq0}$.
  By analogous argumentation on the other sides of the square $\Sigma=\partial X$
  one obtains that
  \begin{align*}
    \Sigma^-=\Sigma^{\leq0}&=I\times\brk[c]*{-1,1}\\
    \Sigma^+=\Sigma^{\geq0}&=\brk[c]*{-1,1}\times I\,.
  \end{align*}
  % In particular the tangential boundary $\Sigma^{0}=\emptyset$ is empty.
  A sketch of the sets can be seen in figure \ref{pl:n2_hvf_canonical_boundary}.
%   \begin{figure}[h]
% \end{figure}
\end{example}

% \begin{wrapfigure}{o}{0.45\textwidth}
\begin{figure}
  \centering
  % \hspace*{1cm}
  \input{../Figures/n2_cube_inflowOutflow.pdf_tex}
  \caption{The entrant and emergent boundaries in 
  example \eqref{ex:n2_hvf_canonical}}
  \label{pl:n2_hvf_canonical_boundary}
\end{figure}
% \end{wrapfigure}

Since the dual of the contingent cone $\brk*{C_xX}^*$ will also play a role later on we make a
further remark to illustrate the concept.
\begin{remark}[Contingent cone]
  If the angle of the cone $C_xX$ at a corner point $x$ in the plane is $\alpha$ the angle formed by the
  cone $\brk*{C_xX}^*$ is $\pi-\alpha$.
  Thus equation \eqref{eq:n2_hvf_canonical_CxX} in the previous example is a special case for $\alpha=\pi/2$.
  The more general case is illustrated in figure \ref{fi:n2_contingentCone_greaterLess}.
  \begin{figure}
    \centering
    \begin{subfigure}{0.45\textwidth}
      \centering
      \input{../Figures/n2_contingentCone_greater.pdf_tex}
      \caption{$\alpha>\pi/2$}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.45\textwidth}
      \centering
      \input{../Figures/n2_contingentCone_less.pdf_tex}
      \caption{$\alpha<\pi/2$}
    \end{subfigure}
    \caption{Illustration of a planar contingent cone and its dual cone at a corner.}
    \label{fi:n2_contingentCone_greaterLess}
  \end{figure}
\end{remark}

\section{Stagnation points}

Given a vector field $u\colon X\to\R^d$ and a stratification $X_j$ of $X$ we can construct for every
$j\in\cJ$ a vector field
\begin{align*}
  u_j\colon X_j\to T^*X_j\,.
\end{align*}
Here $T^*X_j$ denotes the cotangent space of the manifold $X_j$ which is defined for instance in \cite[Chapter 6]{Hirsch1994}.
More precisely, for $x\in X_j$ let
\begin{align}
  \pi_j\big\vert_x\colon T_x^*X\to T_x^*X_{j}\label{eq:def_projectionStratification}
\end{align}
denote the orthogonal projection of a vector at $x$ onto the cotangent space of the stratum $X_j$ at $x$.
Let
\begin{align}
  u_j\leftdef\pi_j\circ u\big\vert_{X_j}\in C^1\brk*{T^*X_j}\label{eq:def_projectionUStratification}
\end{align}
be the projection of $u$ onto the cotangent bundle $T^*X_j$. We can now give a definition
of stagnation points and their index. 
This generalises definitions given in \cite[p.138f]{Shelton1980}, \cite[§5]{Morse1969} and \cite[p.282f]{Morse1970}
to include vector fields which are not necessarily gradient fields.
\nomenclature{$u_j$}{Projection of $u$ to the cotangent bundle $T^*X_j$. See equation \eqref{eq:def_projectionUStratification}.}
\nomenclature{$\pi_j$}{Orthogonal projection onto the cotangent bundle $T^*X_j$. See equation \eqref{eq:def_projectionStratification}.}
\begin{definition}[Stagnation points]\label{df:nonDegeneracy}
  Let $u_j\colon X_j\to T^*X_j$ be a $C^1$ vector field on a stratum $X_j$ of $X$.
  We call the zeroes $x\in X_j$ of $u_j$ \emph{stagnation points of $u_j$ on $X_j$}.
  If $x\in\openX$ is a stagnation point of a stratum with dimension $d$
  then we call $x$ an \emph{interior stagnation point} else $x$ is a \emph{boundary stagnation point}.
  If $u(x)\in \brk*{C_xX}^*$, that is $x$ lies in the entrant boundary $\Sigma^{\leq0}$, we call $x$ an \emph{essential stagnation point}.
  The set of all essential stagnation points of $u_j$ is denoted by $\critical_j=\critical_j(u)$ and
  the essential stagnation points of $u$ and $-u$ on $X_j$ are called \emph{stagnation points of $u$ on $X_j$}.
  A stagnation point $x$ of $u_j$ is called
  \emph{non-degenerate} if the derivative
  \begin{align*}
    Du_j(x)=Du_j\big\vert_x\in T_xT^*X_j\cong \R^{n(j)\times n(j)}
  \end{align*}
  is bijective.
  In addition we say that $x$ has \emph{index} $k$
  if $Du_j(x)$ has exactly $k$ negative eigenvalues.
  $u_j$ is called \emph{(essentially) non-degenerate} if all its (essential) stagnation points
  are non-degenerate.
  Finally, we call a non-degenerate essential stagnation point $x$ of $u_j$ \emph{regular} if additionally $u(x)\in\relint \brk*{C_xX}^*$,
  that is $x$ lies in the strictly entrant boundary $\Sigma^-$.
  Boundary points which are non-regular essential stagnation points are called \emph{irregular boundary points}.
  We call the set of all irregular boundary points the irregular boundary $\Sigma^\text{irr}$.
  $u_j$ is called \emph{regular} if it has no irregular boundary points.
  We can define the \emph{$k$-th type number} $\ind_{j,k}(u)$ of the
  stratum $X_j$ to be the number of regular stagnation points of $u_j$ of index $k$,
  that is
  \begin{align}
    \ind_{j,k}(u)\leftdef\#\brk[c]*{x\in\critical_j(u)\colon x\text{ has index }k}\,.\label{eq:def_typenbr_strata}
  \end{align}
\end{definition}
\nomenclature{$\critical_j$}{Set of essential stagnation points. See definition \ref{df:nonDegeneracy}.}
\nomenclature{$\ind_{j,k}$}{$k$-th type number on the stratum $X_j$. See equation \eqref{eq:def_typenbr_strata}.}
The reason for only considering essential stagnation points has to do with the Morse inequalities.
In the proof given by \cite{Handron2002} a flow along the vector field $-u$ on $X$ is constructed.
Since this flow would leave the domain at the entrant boundary this flow is modified on $\Sigma^{\leq0}$ 
so as to not leave $X$ and becomes discontinuous.
For more details we refer the reader to chapter \ref{ch:Morse}.
% This explains the asymmetry in the definition.
To illustrate the preceding definitions we return to our previous example.
\begin{example}\label{ex:n2_hvf_index}
  Let $X$, $f$ and $u$ be as in example \ref{ex:n2_hvf_canonical}.
  We have that $u_2=u$ and thus
  one sees from equation \eqref{eq:n2_hvf_canonical}
  that the origin $0$ is the sole stagnation point of $u$ on the stratum $X_2$. Since we have that
  \begin{align*}
    Du(x) = \begin{bmatrix}
      2 & \\
       & -2
    \end{bmatrix}
  \end{align*}
  for all $x\in\openX$ we see that $Du(0)$ is bijective and thus the origin is a non-degenerate interior stagnation point.
  As $Du(0)$ has
  exactly one negative eigenvalue we see that the origin has index $1$. 
  Since an interior stagnation point is also an essential stagnation point 
  we have $\ind_{2,k}=\delta_{k1}$ where $\delta$ denotes the Kronecker delta.
  For $x\in I\times\brk[c]*{1}\rightdef Y$ we calculate
  \begin{align*}
    u_1(x)=\pi_1\circ u(x)=\brk*{u-\brk*{n\cdot u}n}(x)
    =2x_1e_1
  \end{align*}
  with $n$ the outer unit normal.
  Thus we have that $x=e_2$ is the unique stagnation point of $u$ on $Y$.
  Consider the curve
  \begin{align*}
    \gamma\colon I&\to Y\\
    t&\mapsto te_1+e_2
  \end{align*}
  then $\gamma(0)=e_2$ and we have
  \begin{align*}
    Du_1(e_1)\brk*{\gamma'(0)}
    =\brk*{u_1\circ \gamma}'(0)
    =\brk*{2te_1}'(0)=2e_1=2\gamma'(0)
  \end{align*}
  and thus $e_1$ is an eigenvector of $Du_1(e_2)$ to the eigenvalue $2$. Since $e_1$
  spans the eigenspace $T_{e_2}Y$ it follows that $e_2$ is a non-degenerate stagnation point
  of $u_1$ with index $0$.
  Now since $u\brk*{e_2}\in\relint\brk*{C_xX}^*$ we have that $e_2$ is in fact a regular point.
  Proceeding in this manner for the other segments of the square $\Sigma$ we obtain that
  $\ind_{1,k}=2\delta_{0k}$.
  If we now consider the point $x=\vect{1&1}^\top$ then we have that $u_0(x)=0$ and thus $x$ is a stagnation
  point.
  Now the derivative $Du_0=0\in T_xT^*X_0=0$ is bijective and thus
  we have that $x$ has
  index $0$. Since however $u(x)\notin \brk*{C_xX}^*$ we have that $x$ is not an essential stagnation point.
  Analogous argumentation on the other three corners yields that $\ind_{0,0}=0$.
\end{example}

The following characterisation of the irregular boundary will come in handy for showing the density of Morse functions later on:
\begin{proposition}[Characterisation of the irregular boundary]\label{pr:characterisation_irregular_bd}
  The condition that the stagnation point $x\in X_j$ lies in $\Sigma^\text{irr}$ is equivalent to that
  $x$ is stagnation point of $u_{j+1}$ for a stratum $X_j\precsim X_{j+1}$.
\end{proposition}
We first remark that $x$ being a stagnation point of $u_{j+1}$ makes at first sight no sense since $x\notin X_{j+1}$.
We have however that $x\in\overline{X}_{j+1}$. The concept of tangent space $T_xX_{j+1}$ and the projection $\pi_{j+1}$
can be extended to $\overline{X}_{j+1}$ by continuity and so we can reasonably speak of evaluating $u_{j+1}$ at the point $x$.
\begin{proof}
  We first claim that for some boundary point $x\in\Sigma\cap X_j$ the relations
  \begin{align}
    \begin{aligned}
    \partial\brk*{C_xX}^* &\leftdef\brk*{C_xX}^*\setminus\relint\brk*{C_xX}^*\\
    &\stackrel{\brk*{+}}{=}\left\{w\in T_xX\;\begin{array}{|l}
      w\cdot w'\geq0\text{ for all }w'\in C_xX\text{ and }\\
      w\cdot w'=0\text{ for some }w'\in C_xX\setminus T_xX_{j}
    \end{array}\right\}\\
    &\stackrel{\brk*{*}}{=}\left\{w\in T_xX\;\begin{array}{|l}
      w\cdot w'\geq0\text{ for all }w'\in C_xX\text{ and }\\
      w\cdot w'=0\text{ for some }w'\in T_xX_{j+1}\setminus T_xX_{j}\\
      \text{where }X_{j}\precsim X_{j+1}
    \end{array}\right\}
    \end{aligned}
    \label{eq:characterisation_irregular_bd_relationCxX}
  \end{align}
  hold.
  To see the equality $\brk*{+}$ let $w\in\partial \brk*{C_xX}^*$
  and $w_k\in T_xX\setminus\brk*{C_xX}^*$ be a sequence converging to $w$. Then there
  exists for each $w_k$ a $w_k'\in C_xX$ such that $w_k\cdot w_k'<0$. We can assume that $\abs*{w_k'}=1$
  and after taking a subsequence that the $w_k'$ converge to a $w'\in C_xX$. But then we have by continuity that
  $w\cdot w'\leq 0$ so the inclusion `$\subseteq$' follows.
  On the other hand if $w\in \relint\brk*{C_xX}^*$ then there exists a relatively open neighbourhood $U\subseteq \brk*{C_xX}^*$ of $w$.
  Assume that $w\cdot w'=0$ for some $C_xX\setminus T_xX_j$.
  Since we have that $T_xX_j\perp \brk*{C_xX}^*$ are perpendicular we can assume that the component of $w'$ projected onto the space $T_xX_j$
  vanishes.
  Then we have for $\lambda<0$ small enough that $w+\lambda w'\in U$
  and it follows that $\brk*{w+\lambda w'}\cdot w'=\lambda\abs*{w'}^2<0$, a contradiction. Thus `$\supseteq$' follows.
  \begin{figure}
    \centering
    \input{../Figures/irregularCPs_X12.pdf_tex}
    \label{fi:irregularCPs_X12}
    \caption{An overview of the proof of $\brk*{+}$ in equation \eqref{eq:characterisation_irregular_bd_relationCxX}.}
  \end{figure}
  \td{Argue why $\supseteq$ follows precisely. Argue why in the first part $w'\notin T_xX$.}

  For $\brk*{*}$ we show the
  inclusion `$\subseteq$'. Let $w\in \partial\brk*{C_xX}^*$ and $w'\in \brk*{T_xX_k\cap C_xX}\setminus T_xX_j$ for some stratum $X_j\prec X_k$ with $w\cdot w'=0$.
  We assume that $X_k$ is chosen to be of minimal dimension.
  Now if $X_j\precsim X_k$ we are finished. Else there exist strata $X_{k-1}^1,X_{k-1}^2\precsim X_k$
  adjacent to $X_j$. Then there further exist $w_1'\in \brk*{T_xX_{k-1}^1\cap C_xX}\setminus T_xX_j$ and $w_2'\in \brk*{T_xX_{k-1}^2\cap C_xX}\setminus T_xX_j$
  such that $w'=w_1'+w_2'$. But then it follows from
  \begin{align*}
    0=w\cdot w'=\underbrace{w\cdot w_1'}_{\geq0}+\underbrace{w\cdot w_2'}_{\geq0}
  \end{align*}
  that also $0=w\cdot w_1'$ which contradicts the choice of $X_k$ having minimal dimension.
  Hence the inclusion `$\subseteq$' follows.
  \begin{figure}
    \centering
    \input{../Figures/irregularCPs_X123.pdf_tex}
    \label{fi:irregularCPs_X123}
    \caption{An overview of the proof of $\brk*{*}$ in equation \eqref{eq:characterisation_irregular_bd_relationCxX}.}
  \end{figure}
  \td{Update figure to the notation of the proof. Argue why $\supseteq$ follows. Also update the figure.}

  Now let $x$ be an irregular stagnation point of $u_j$ then  $u(x)\in \partial\brk*{C_xX}^*$. Hence there
  exists a $w'\in T_xX_{j+1}\setminus T_xX_j$ such that $u(x)\cdot w'=0$. 
  Additionally we have that $u(x)\cdot w=0$ for all $w\in T_xX_j$ since $x$ is stagnation point of $u_j$.
  Since we have that
  $\Span\brk*{w'}+T_xX_j=T_xX_{j+1}$ by dimension reasons it then follows that
  $u(x)\cdot w=0$ for all $w\in T_xX_{j+1}$ which means that $u_{j+1}(x)=0$.

  Conversely assume that $x\in X_j$ is stagnation point for some stratum $X_{j+1}$. Then we have that
  $u(x)\cdot w=0$ for all $w\in T_xX_{j+1}$. Since  $\Span\brk*{w'}+T_xX_j=T_xX_{j+1}$
  for some $w'\in T_xX_{j+1}\setminus T_xX_j$
  it then follows from equation \eqref{eq:characterisation_irregular_bd_relationCxX} that $u(x)\in \partial\brk*{C_xX}^*$
  and $x$ is an irregular stagnation point.
\end{proof}
% \begin{proof}
%   We calculate for some boundary point $x\in\Sigma$:
%   \begin{align*}
%     \brk*{C_xX}^*\setminus\relint\brk*{C_xX}^*
%     &=\left\{w\in T_xX\;\begin{array}{|l}
%       w\cdot w'\geq0\text{ for all }w'\in C_xX\text{ and }\\
%       w\cdot w'=0\text{ for some }w'\in \partial C_xX\setminus\brk[c]*{0}
%     \end{array}\right\}\,.
%   \end{align*}
%   Now $w'\in\partial C_xX\setminus\brk[c]*{0}$ iff $w'\in T_xX_{j+1}$ is orthogonal to $T_xX_j$ at $x$.
%   Thus we have that $$u(x)\in \brk*{C_xX}^*\setminus\relint\brk*{C_xX}^*$$ iff $u(x)\in \brk*{C_xX}^*$
%   and there exists a normal $n\in T_xX_{j+1}$ such that
%   \begin{align*}
%     0=\brk*{n\cdot u\;n}(x)=\brk*{n\cdot u_{j+1}\;n}(x)=u_{j+1}(x)-u_j(x)
%   \end{align*}
%   from which the claim follows.
% \end{proof}

\section{Morse functions}

The following definition of type numbers is inspired by \cite[Definition 10.3]{Morse1969}:
\begin{definition}[Morse functions, {\cite[Definition 10.3]{Morse1969}}]
  We call $u$ \emph{Morse} if for all $j\in\cJ$ we have that $u_j$ is regular.
  If both $u$ and $-u$ are Morse we call $u$ \emph{strongly Morse}.
  For a Morse function $u$ we define 
  the \emph{interior type numbers} $M_k$ to be the number of essential interior stagnation points of $u$ of index $k$, that is
  \begin{align}
    M_k\leftdef\sum_{\substack{j\in\cJ\text{ s.t.} \\ n(j)=d}}\ind_{j,k}(u)
    =\#\brk[c]3{x\in\bigcup_{\substack{j\in\cJ\text{ s.t.} \\ n(j)=d}}\critical_j(u)\colon x\text{ has index }k}\,.
    \label{eq:def_typenbr_interior}
  \end{align}
  The total number $M$ of interior
  stagnation points of $u$ is then given by
  \begin{align}
    M\leftdef\sum_kM_k\,.\label{eq:def_stagnationPtNbr}
  \end{align}
  Analogously we define the \emph{$k$-th boundary type numbers} to be the number of essential boundary 
  stagnation points of $u$ of index $k$, that is
  \begin{align}
    \mu_k\leftdef\sum_{\substack{j\in\cJ\text{ s.t.}\\ n(j)<d}}\ind_{j,k}(u)\label{eq:bdTypeNbrs}
  \end{align}
  We further write $\nu_k$ for the $k$-th boundary type number of $-u$.
  We define the \emph{type number} to be the number of
  essential stagnation points of $u$ of index $k$, that is
  \begin{align}
    \ind_k(u)\leftdef\sum_{j\in\cJ}\ind_{j,k}(u)=M_k+\mu_k\,.\label{eq:def_typenbr_total}
  \end{align}
\end{definition}
\nomenclature{$\ind_k$}{$k$-th type number. See equation \eqref{eq:def_typenbr_total}.}
\nomenclature{$M_k$}{$k$-th interior type numbers. See equation \eqref{eq:def_typenbr_interior}.} 
\nomenclature{$M$}{Total number of stagnation points. See equation \eqref{eq:def_stagnationPtNbr}.}
\nomenclature{$\mu_k$}{$k$-th boundary type numbers of $f$. See equation \eqref{eq:bdTypeNbrs}.}
\nomenclature{$\nu_k$}{$k$-th boundary type numbers of $-f$. See definition \ref{df:nonDegeneracy}.}

% To better describe the boundary of the emergent boundary $\partial\Sigma^+$ we introduce the
% concept of tangency regularity, which is inspired by similar definitions made in \cite{Katz2014}.
% In order to avoid the technical intricacies involved with manifolds with corners we assume that
% $\Sigma$ is a differentiable manifold for the following definitions to make sense.
% \begin{definition}[Normal bundle]
%   We define the \emph{normal bundle} for a stratification of $X$ to be the quotient space
%   \begin{align}
%     NX_j=TX_{j-1}/TX_j,
%   \end{align}
%   where $TX_j$ is the tangent space of $X_j$. This is well-defined if $X_{j-1}$ is uniquely determined
%   by $X_j$. This is the case if $\Sigma$ is a $C^1$ manifold.
%   The \emph{conormal bundle} $N^*X_j$ is defined as its pointwise dual, that is
%   \begin{align*}
%     N_x^*X_j=\brk*{N_xX_j}'\,.
%   \end{align*}
% \end{definition}

% Analogously to the definition of $u_j$ we can define the vector field
% \begin{align*}
%   u_j^N\colon X_j\to N^*X_j
% \end{align*}
% as the restriction of $u$ to the conormal bundle $N^*X_j$, that is
% \begin{align}
%   u_j^N=u\big\vert_{N^*X_j}\,.\label{eq:def_projectionUNStratification}
% \end{align}

% The following definition is inspired by \cite{Katz2014}.
% \begin{definition}[Tangency points]
%   Let $u^N_j$ be as in equation \eqref{eq:def_projectionUNStratification}.
%   We call the zeroes $x\in X_j$ of $u^N_j$ \emph{tangency points}.
%   A tangency point is called \emph{regular} if the derivative $Du^N_j(x)$ is bijective.
%   We call a function $u\colon X\to\R^d$ \emph{tangency regular} if every tangency point
%   is regular.
% \end{definition}

% As in \cite{Katz2014} we call $u$ \emph{boundary generic} if $u$ is Morse and tangency regular.

We illustrate this with our example:
\begin{example}
  Let $X$, $f$ and $u$ be as in example \ref{ex:n2_hvf_canonical}. By the calculations of the previous example
  \ref{ex:n2_hvf_index} we have that $u$ is Morse and we can calculate the interior type numbers
  \begin{align*}
    M_k=\ind_{2,k}=\delta_{1k}
  \end{align*}
  and the boundary type numbers
  \begin{align*}
    \mu_k=\ind_{0,k}(u)+\ind_{1,k}(u)=2\delta_{0k}\\
  \end{align*}
  This then yields the type numbers
  \begin{align*}
    \ind_k(u)=M_k+\mu_k=\delta_{1k}+2\delta_{0k}\,.
  \end{align*}
\end{example}

The finiteness of the number of critical points for Morse functions is a known fact which is mentioned
for example in \cite{Morse1970}. For completeness we give the following proposition:
\begin{proposition}\label{pr:finiteness_critical_points}
  The number of non-degenerate
  stagnation points of $u_j$ on $X_j$ is finite.
\end{proposition}
\begin{proof}
  Let $x\in X_j$ be a non-degenerate stagnation point of $u_j$. Since $Du_j(x)$ is invertible there exists
  by the inverse function theorem an open neighbourhood $U_x\subseteq X_j$ of $x$ on which 
  $u_j$ is bijective. Hence $x$ is the only stagnation point in $U_x$. Let $C$ denote the set of all
  non-degenerate stagnation points of $u_j$. Then the sets $U_x$ for $x\in C$ together with
  \begin{align}
    U_C=\overline{X}_j\setminus \overline{C}
  \end{align}
  form an open cover of $\overline{X}_j$. But $\overline{X}_j$ is compact and thus there exists
  a finite subcover. Since we have for every stagnation point $x\in C$ that
  $x\not\in U_y$ for all other $y\in C\setminus\brk[c]*{x}$ and $x\not\in U_C$ we must have that $U_x$
  is contained in the finite subcover. Thus it follows that $\#C<\infty$ is finite.
\end{proof}
As a consequence we obtain the following observation:
\begin{corollary}\label{co:finiteness_type_nbrs}
  For a Morse vector field $u\colon X\to\R^d$ the type numbers $M_0,\dots,M_d$ and the boundary type numbers $\mu_0,\dots,\mu_{d-1}$
  are finite.
\end{corollary}

The previous definitions translate naturally to a skalar function $f\colon X\to\R$.
That is, we call $f$ Morse, non-degenerate, et cetera if $u=\nabla f$ is Morse, non-degenerate, et cetera.
Similarly we call a point $x$ a \emph{critical point} of $f$ if it is a
stagnation point of $u$.
Note that most authors refer to regular and essential stagnation points as non-degenerate stagnation points
and that this naming was introduced simply to distinguish between these different concepts.


% To illustrate the preceding definitions we return to our previous example.
% \begin{example}
%   Let $f$ and $u$ be as in example \ref{ex:n3_hvf_canonical}. One sees from equation \eqref{eq:n3_hvf_canonical}
%   that the origin $0$ is the sole interior critical point of $f$. Since we have that
%   \begin{align*}
%     Du(x) = \begin{bmatrix}
%       2 & & \\
%        & 2 & \\
%       & & -4
%     \end{bmatrix}
%   \end{align*}
%   for all $x\in\Omega$ we see that $Du(0)$ is bijective and thus $0$ is a non-degenerate critical point. Since $Du(0)$ has
%   exactly one negative eigenvalue we see that the origin has index $1$. Since there are no other critical points we have
%   $M=1$ and
%   \begin{align*}
%     M_k=\delta_{k1}
%   \end{align*}
%   where $\delta$ denotes the Kronecker delta.
%   We now calculate for $x\in S^2$
%   \begin{align*}
%     \tiu(x) = \brk*{u-\brk*{n\cdot u}n}(x)
%     = \brk*{u-2f\,n}(x)
%     = 2\vect{(1-f(x))x_1 \\(1-f(x))x_2 \\(-2-f(x))x_2}
%   \end{align*}
%   Hence we see that $x\in\Sigma$ is a critical point iff 
%   \begin{align}
%     f(x)=1 \text{ and }x_3=0\text{ or } \label{eq:n3_hf_canonical_cps_degenerate} \\
%     f(x)=-2 = \text{ and }x_1=0=x_2\,. \label{eq:n3_hf_canonical_cps_nondegenerate}
%   \end{align}
%   The former equation \eqref{eq:n3_hf_canonical_cps_degenerate} gives that every
%   point belonging to $S^1\times\brk[c]{0}\subseteq\R^3$ is in fact a critical point of $f$.
%   But since $f=1$ on this set these points are degenerate.
%   We will discuss a fix to this issue in the upcoming section.
%   We now consider equation \eqref{eq:n3_hf_canonical_cps_nondegenerate} and take 
%    $f(x)=-2$ then we must have that $x=\pm e_3$ where $e_k=\delta_{k\cdot}$
%   is the $k$-th basis vector in $\R^d$. We now determine their index. For this consider the curves
%   \begin{align*}
%     \gamma_k\colon\R&\to S^2\\
%     t&\mapsto \sin(t)e_k\pm\cos(t)e_3
%   \end{align*}
%   for $k\in\brk[c]*{1,2}$.
%   Note that $\gamma_k'(0)=e_k$ and $\gamma_k(0)=\pm e_3$.
%   We see that
%   \begin{align*}
%     Du(e_1)(\gamma_k'(0))=(u\circ\gamma_k)'(0)
%     =\brk*{\sin(t)e_k\mp2\cos(t)e_3}'(0)
%     =e_k=\gamma_k'(0)
%   \end{align*}
%   and thus $e_k\in T_{\pm e_3}S^2$ are eigenvectors of $Du(e_k)$ to eigenvalues $1$.
%   Since the $e_k$ span the tangent space $T_{\pm e_3}S^2$ it follows that
%   the $\pm e_3$ are non-degenerate critical points of $f$ with index $0$.
% \end{example}

\section{Density of Morse functions}\label{se:assuming_nonDegeneracy}

In the following section we argue that 
$u$ and $f$ being Morse is not a great restriction.
Given $u$ we define the modification
\begin{align}
  u^\e\leftdef u+\e\label{eq:nonDegeneracy:definitionUEps}
\end{align}
for some $\e\in\R^d$. We would like to show that the set $E$ of $\e$ for which $u^\e$ is Morse
is residual in $\R^d$.
Recall that a \emph{residual} set is a set whose complement is \emph{meagre}, that is whose complement
is the countable union of nowhere dense subsets.
Since residual sets are dense in a Baire space by the Baire category theorem we can 
use $u^\e$ to approximate a degenerate $u$.
Our approach is to use Thom's transversality theorem which is inspired by the approach in \cite[Chapter 6]{Hirsch1994}.
\nomenclature{$u^\e$}{modification to $u$ as in equation \eqref{eq:nonDegeneracy:definitionUEps}}
\begin{definition}[Transversality, {\cite[§3.2]{Hirsch1994}} and {\cite{Agrach1991}}]
  Let $X$ be a manifold with corners and $Y$ a manifold without boundary.
  We call a function $g\colon X\to Y$
  \emph{transverse} to a submanifold $A\subseteq Y$ with corners if for all points in the 
  preimage $x\in g^{-1}(A)$ we have that
  \begin{align}
    Dg\big\vert_x\brk*{C_xX}+C_{g(x)}A = T_{g(x)}Y\,.\label{eq:nonDegeneracy_defTransversality}
  \end{align}
\end{definition}
\nomenclature{$A$}{submanifold, can be thought of as the zero section of $T^*X$}
In the remainder of this section we will deal with manifolds without boundaries and then condition
\eqref{eq:nonDegeneracy_defTransversality} reduces to
\begin{align*}
  \Image\brk*{Dg_x}+T_{g(x)}A = T_{g(x)}Y\,.
\end{align*}
As an application of this definition we make the following observation:
\begin{proposition}[Transversal characterisation of non-degeneracy]\label{pr:nonDegeneracy:alternativeCharacterisation}
  Let $u_j\colon X_j\to T^*X_j$ be a differentiable vector field.
  Then $u_j$ is non-degenerate iff $u_j$ is transverse to the zero section $A$ of the cotangent space $T^*X_j$.
\end{proposition}
\begin{proof}
  First note that we have that $x\in u_j^{-1}(A)$ iff $u_j(x)=0$ and thus $u_j^{-1}(A)=C$ is the set of stagnation points.
  Unravelling the definition of transversality we get that $u_j$ is transverse to the zero section iff for all $x\in C=u_j^{-1}(A)$
  we have that
  \begin{align}
    \Image\brk*{Du_j(x)}+T_{u_j(x)}A = T_{u_j(x)}T^*X_j\,. \label{eq:nonDegeneracy:uTransverse}
  \end{align}
  As $A$ is the zero section we have $T_{u_j(x)}A=0$ and equation \eqref{eq:nonDegeneracy:uTransverse}
  is equivalent to stating that $Du_j$ is of full rank at $x$. But $Du_j$ being of full rank at all stagnation points
  is equivalent to $u_j$ being non-degenerate.
\end{proof}
% Analogously we make the following observation.
% \begin{proposition}[Transversal characterisation of tangency regularity]\label{pr:tanRegular_alternativeCharacterisation}
%   Let $u^N_j$ be given as in equation \eqref{eq:def_projectionUNStratification}.
%   Then we have that $u$ is tangency regular on a stratum $X_j$ iff
%    $u^N_j$ is transverse to the zero section of $N^*X_j$.
% \end{proposition}
The alternative characterisation of non-degeneracy given in proposition \ref{pr:nonDegeneracy:alternativeCharacterisation}
is sometimes used as a definition of non-degeneracy.
We can now state a weakened version of Thom's transversality theorem which is proven in \cite[§3 Theorem 2.7]{Hirsch1994}:
\begin{theorem}[Parametric transversality theorem, {\cite[§3 Theorem 2.7]{Hirsch1994}}]
  Let $\cE,Y_1,Y_2$ be $C^r$-manifolds (without boundary) and $A\subseteq Y_2$ a $C^r$ submanifold such that
  \begin{align*}
    r>\dim Y_1-\dim Y_2+\dim A\,.
  \end{align*}
  Let further $F\colon \cE\to C^r\brk*{Y_1,Y_2}$ be such that the evaluation map
  \begin{align*}
    F^\text{ev}\colon \cE\times Y_1&\to Y_2 \\
    (\e,x)&\mapsto F_\e(x)
  \end{align*}
  is $C^r$ and transverse to $A$.
  Then the set
  \begin{align*}
    E=\brk[c]*{\e\in \cE\colon F_\e\text{ is transverse to } A}
  \end{align*}
  is residual in $\cE$.
\end{theorem}
% \begin{proof}
%   See \cite[Theorem 2.7]{Hirsch1994} for details.
% \end{proof}
From this we obtain
a generalisation of the results in \cite[§2]{Morse1970} which will be useful later:
\begin{corollary}[Density of harmonic Morse functions]\label{co:density_boundaryGeneric}
  Let $u\colon X\to T^*X$ be a vector field on $X$ and let $X_j$ be a stratification of $X$.
  Assume that $u$ has no irregular stagnation points.
  Then there exists a $\delta>0$ and a residual (and thus dense) set $E\subseteq B_\delta\subseteq\R^d$ such that for every $\e\in E$
  the following statements hold:
  \begin{enumerate}
    \item $u_j^\e\to u_j$ converge uniformly on all strata $X_j$ as $\e\to0$.\label{co:nonDegeneracy_density_uniform}
    \item If $x_\e\to x$ is a convergent sequence of stagnation points of $u_j^\e$ as $\e\to0$ then
      $x$ is a stagnation point of $u_j$.\label{co:nonDegeneracy_density_limitPoint}
    \item $u^\e$ is strongly Morse. \label{co:nonDegeneracy_density_nonDeg}
    % \item if in addition $\Sigma$ is a differentiable manifold then $u^\e$ is tangency regular on $X_j$ \label{co:nonDegeneracy_density_tanReg}
    \item Additionally we can find for every $\eta>0$ a $\delta>0$ such that all stagnation points of $u^\e$ are contained in an 
    $\eta$-neighbourhood of the set of stagnation points of $u$.\label{co:nonDegeneracy_density_etaNbh}
    \item the property of being strictly entrant or strictly emergent of stagnation points of $u^\e$ is preserved, that is 
      a stagnation point $x^\e$ of $u^\e$ lies in $\Sigma^\pm\brk*{u^\e}$ iff it lies in $\Sigma^\pm\brk*{u}$.\label{co:nonDegeneracy_density_entrEmerg}
    \item If $u_j$ is non-degenerate on the stratum $X_j$ we have\label{co:nonDegeneracy_density_index}
      for all $k$ that
      \begin{align*}
        \ind_{X_j,k}\brk*{u^\e}=\ind_{X_j,k}\brk*{u}\qquad\text{ and }\qquad\ind_{X_j,k}\brk*{-u^\e}=\ind_{X_j,k}\brk*{-u}\,.
      \end{align*}
  \end{enumerate}
  In addition note that if $u$ is harmonic then by construction $u^\e$ is also harmonic.
\end{corollary}
We remark that the fact that $u$ has no irregular stagnation points is essential to the point 
\ref{co:nonDegeneracy_density_index} of this corollary. 
Assume for instance $u_d$ has a non-degenerate stagnation point $x$ on the boundary $\Sigma$, 
which means by proposition \ref{pr:characterisation_irregular_bd} that $x$ is an irregular critical point. 
It may then follow that for $\e$ contained in a cone 
at the origin the corresponding critical point of
$u^\e$ moves outside of the domain $X$ which in turn changes the index.
Example \ref{ex:n2_noInflowOutflow_irregular} gives a concrete illustration of this point.
\begin{proof}
  \emph{Part \ref{co:nonDegeneracy_density_uniform}}. Follows from compactness of $\overline{X}_j\subseteq X$ and the continuity of $\pi_j$.

  \emph{Part \ref{co:nonDegeneracy_density_limitPoint}}. Let $x_\e\to x$ be a convergent sequence of stagnation points on the stratum $X_j$.
  By part \ref{co:nonDegeneracy_density_uniform} $u_j^\e\to u_j$ as $\e\to0$ uniformly which implies
  \begin{align}
    0=\lim_\e u_j^\e\brk*{x_\e}
    =u_j\brk*{x}
  \end{align}
  and thus $x$ is a stagnation point of $u_j$.

  \emph{Part \ref{co:nonDegeneracy_density_nonDeg}}. 
  The following is essentially an adaptation of a proof given in \cite[§2]{Morse1970}.
  We first show that we can choose a $\delta>0$ such that for all $\e\in B_\delta\subseteq\R^d$ the function $u^\e$ has
  no irregular stagnation points.
  Assume not. Then there exists a sequence $\e_k\to0$ and irregular stagnation points $x_k\in\Sigma^\text{irr}\brk*{u^{\e_k}} $ of $u^{\e_k}$.
  By compactness of $X$ we can assume that $x_k\to x$ for some $x\in X$ after taking a sub-sequence.
  After taking a further sub-sequence we can also assume that all $x_k$ lie in a stratum $X_j$.
  The condition that the $x_k\in\Sigma^\text{irr}\brk*{u^{\e_k}}$ are stagnation points
  means that after taking a further sub-sequence there exists a stratum $X_{j-1}$ such that $x_k$ is also stagnation point of this stratum
  by proposition \ref{pr:characterisation_irregular_bd}.
  But then $x\in\overline{X}_j$ is also a stagnation point of $X_{j-1}$ by part \ref{co:nonDegeneracy_density_limitPoint}.
  Analogously $x$ is also stagnation point of $X_j$.
  Thus $x\in\Sigma^\text{irr}$
  is an irregular stagnation point, a contradiction.

  The next part of the proof is inspired by the use of transversality in \cite[§6 Theorem 1.2]{Hirsch1994} to show a similar statement.
  Set $r=2$, $\cE=B_\delta$ and $Y_2=T^*X_j$ in the previous theorem.
  We initially set $Y_1=X_j=\openX$.
  We would like to apply the parametric transversality theorem to the function
  \begin{align*}
    F\colon \cE&\to C^\infty\brk*{X_j,T^*X_j} \\
    \e&\mapsto u^\e
  \end{align*}
  and note that $F^\text{ev}$ is sufficiently smooth. 
  We need to show that $F^\text{ev}$ is transverse to the
  zero section $A\subseteq T^*X_j$. Then the parametric transversality theorem 
  yields a residual $E_j\subseteq \cE$ on which
  $F_\e=u^\e$ is transverse to $A$.
  For this note that for all $(\e,x)\in F^{-1}(A)$ we have
  \begin{align}
    \Image\brk*{DF^\text{ev}_{(\e,x)}}=T_xT^*X_j\label{eq:nonDegeneracy:surjectiveDF}
  \end{align}
  since
  \begin{align*}
    DF^\text{ev}_{(\e,x)}=\begin{bmatrix}
      \Id_{d\times d}\mid Du_x
    \end{bmatrix}
  \end{align*}
  is surjective. 
  Proposition \ref{pr:nonDegeneracy:alternativeCharacterisation}
  now implies that $u^\e$ is non-degenerate on $X_j$ for $\e\in E_j$.
  %
  Analogously we set $Y_1=X_j$ to be an arbitrary stratum in the previous proof and replace
  $u^\e$ with the projection $u_j^\e$. To show that
  equation \eqref{eq:nonDegeneracy:surjectiveDF} holds we resort to the fact that
  \begin{align*}
    DF^\text{ev}_{(\e,x)}
    =D\brk*{u_j^\e(x)}_{(\e,x)}
    =D\pi_j\circ \brk*{Du^\e(x)}_{(\e,x)}
  \end{align*}
  is surjective as a composition of surjective functions.
  Thus there also exists a residual set $E_j\subseteq\cE$ on which $u^\e_j$ is
  non-degenerate on $X_j$.
  % Now to the tangency regularity. 
  % For this we set $Y_2=N^*X_j$ and $Y_1=X_j$. 
  % We would like to apply the parametric transversality theorem to the function
  % \begin{align*}
  %   F\colon E&\to C^\infty(X_j,N^*X_j) \\
  %   \e&\mapsto u_j^{\e,N}
  % \end{align*}
  % Again $F^\text{ev}$ is sufficiently smooth.
  % We need to show that $F^\text{ev}$ is transverse to the
  % zero section $A\subseteq N^*X_j$. Then the parametric transversality theorem 
  % yields a dense $E_j^N\subseteq E$ on which
  % $F$ is transverse to $A$.
  % It now follows for all $(\e,x)\in F^{-1}(A)$ that
  % \begin{align}
  %   \Image\brk*{DF^\text{ev}_{(\e,x)}}=T_xN^*X_j
  % \end{align}
  % since we have that
  % \begin{align*}
  %   DF^\text{ev}_{(\e,x)}
  %   =D\brk*{u_j^{\e,N}(x)}_{(\e,x)}
  %   =D\pi_j^N\circ \brk*{Du^\e(x)}_{(\e,x)}
  % \end{align*}
  % is surjective as a concatenation of surjective mappings. 
  % Proposition \ref{pr:tanRegular_alternativeCharacterisation}
  % yields that $u^{\e,N}$ is tangency regular on $E_j^N$.
  % Now the set
  % \begin{align}
  %   \overline{E}=\brk*{\bigcap_j E_j}\cap\brk*{\bigcap_j E_j^N}\subseteq\R
  % \end{align}
  % is dense in $\R$ and
  % for every $\e\in\overline{E}$ the function $u^\e$ fulfils conditions
  % \ref{co:nonDegeneracy_density_nonDeg} and \ref{co:nonDegeneracy_density_tanReg}.
  Now the intersection
  \begin{align*}
    E=\bigcap_j E_j\subseteq \cE =B_\delta
  \end{align*}
  is residual and
  for every $\e\in E$ the function $u^\e$ fulfils condition
  \ref{co:nonDegeneracy_density_nonDeg}.

  \emph{Part \ref{co:nonDegeneracy_density_etaNbh}}. 
  Let $C_\eta$ denote the open $\eta$-neighbourhood of the set of stagnation points of $u$.
  % Since $u$ has no irregular stagnation points
  We have for any stratum $X_j$ that
  $u_j\neq0$ on the compact set $\overline{X}_j\setminus C_\eta$ which implies that we can choose $\delta>0$ 
  so small that $\abs{u_j}>2\delta$ on $\overline{X}_j\setminus C_\eta$
  for all strata $X_j$.
  For any $\e\in B_\delta$ it then follows that $u^\e$ has no stagnation points on the set $\overline{X}_j\setminus C_\eta$
  which yields the claim.

  \emph{Part \ref{co:nonDegeneracy_density_entrEmerg}}.
  % Since the boundary stagnation points of $u$ have a positive distance to the irregular boundary $\Sigma^\text{irr}$,
  % say $2\eta$ we can choose $\delta$ as in the previous part of the proof.
  Now consider a stratum $X_j$ and the continuous mapping
  \begin{align*}
    \Phi\colon X_j&\to\R_{\geq0}\\
    x&\mapsto \dist\brk*{u(x),\partial \brk*{C_xX}^*}
  \end{align*}
  on $X_j$. Since $u$ has no irregular stagnation points $\Phi$ is positive on the set of stagnation points $C$ of $u_j$ on $X_j$. Thus we can choose $\eta>0$
  such that $\Phi$ is also positive in the neighbourhood $C_{2\eta}$.
  Choose $\delta>0$ smaller than in part \ref{co:nonDegeneracy_density_etaNbh}.
  Now the mapping $\Phi$ attains a positive minimum on the compact set $\overline{C_{\eta}}$.
  We can assume that $\delta>0$ is less than this minimum.
  The choice of $\delta$ in this way ensures that emergent stagnation points of $u_j$ are also emergent stagnation points of $u_j^\e$ on $X_j$.
  Analogous argumentation with $-u$ then ensures that entrant stagnation points of $u_j$ are also entrant stagnation points of $u_j^\e$ on $X_j$.
  Since there are finitely many strata $X_j$ we can choose $\delta>0$ such that part \ref{co:nonDegeneracy_density_entrEmerg} follows.

  \emph{Part \ref{co:nonDegeneracy_density_index}}.
  Pick $\delta>0$ as in part \ref{co:nonDegeneracy_density_entrEmerg}.
  If $x$ is a non-degenerate stagnation point of $u$ on the stratum $X_j$ it follows 
  from the inverse function theorem that there exists for sufficiently small $\delta$
  a neighbourhood around $x$ on which there is a one-to-one correspondence between the
  stagnation points of $u$ and $u^\e$.
  Since there are by proposition \ref{pr:finiteness_critical_points} at most finitely many non-degenerate stagnation points of
  $u$ we can choose $\delta$ to be minimal over all these stagnation points such that this one-to-one correspondence holds.
  The equality of the indexes then follows from $Du^\e=Du$.
\end{proof}

% We have a brief intermezzo
% \begin{proposition}
%   We have that
%   \begin{align*}
%     \partial\Sigma^-\cup\partial\Sigma^+\subseteq\Sigma^0\,.
%   \end{align*}
% \end{proposition}
% \begin{proof}
%   \td{Some proof}
% \end{proof}

% One of the reasons for introducing boundary tangency is the following proposition 
% \begin{proposition}
%   Assume that $\Sigma$ is a $C^1$ manifold and $u\colon X\to T^*X$
%   a tangency regular vector field. Then we have that
%   $\partial\Sigma^+$ is a submanifold.
% \end{proposition}
% \begin{proof}
%   In this case we have that $\partial\Sigma^+=\Sigma^0$.
%   Since
%   \begin{align}
%     \Sigma^0=\brk*{u_j^N}^{-1}\brk*{0}
%   \end{align}
%   And since $u_j^N$ is transverse to the zero section of $N^*\Sigma$ the claim follows.
%   \td{Elaborate}
% \end{proof}

% \td{The following is no longer relevant for this section}
% In the following we need a notion of convergence of subsets on a metric space.
% We define the \emph{Hausdorff metric} for two sets $A,B\subseteq X$ to be given by 
% \begin{align}
%   d_H\brk*{A,B}=\max\brk[c]*{\sup_{x\in A}\dist\brk*{x,B},\,\sup_{y\in B}\dist\brk*{y,A}}
% \end{align}
% where
% \begin{align}
%   \dist\brk*{x,B}=\inf_{y\in B}d(x,y)
% \end{align}
% is the smallest distance from $x$ to $B$.
% We are now able to state the following proposition:
% \td{What happens if one of the sets involved is empty?}
% \begin{proposition}\label{pr:tanReg_convergence_Sigma0}
%   Assume that $\Sigma$ is a $C^1$ manifold and that $u$ is tangency regular
%   Then we have
%   \begin{align}
%     \lim_\e\Sigma^0\brk*{u^\e}=\Sigma^0(u)
%   \end{align}
%   in the topology induced by the Hausdorff metric.
% \end{proposition}
% \begin{proof}
%   Set $E=\R^d$.
%   % One calculates
%   % \begin{align}
%   %   \partial\Sigma^+(u^\e)
%   %   &= \Sigma^0(u^\e)
%   %   &=\brk*{u_j^{\e,N}}^{-1}\brk*{0}
%   %   &=\brk*{\pi_j^N\circ u^\e}^{-1}\brk*{0}
%   % \end{align}
%   % For every $\e$ and every $x\in \Sigma^0\brk*{u^\e}$ there exists
%   % a neighbourhood $U\subseteq\Sigma$ of $x$ and charts
%   % $\phi\colon U\to V\subseteq\R^d-1$ and $\psi\colon N^*U\to V\times W\subseteq\R^{d-1}\times\R$
%   % such that $\phi$ is a diffeomorphism and $\psi$ a vector space isomorphism.
%   For every $x\in \Sigma^0\brk*{u}$ there exists
%   a neighbourhood $U\subseteq\Sigma$ of $x$ and charts
%   $\phi\colon U\to V\subseteq\R^d-1$ and $\psi\colon N^*U\to V\times W\subseteq\R^{d-1}\times\R$
%   such that $\phi$ is a diffeomorphism and $\psi$ a vector space isomorphism.
%   % \begin{center}
%   %   \tikzset{external/export next=false}
%   %   \begin{tikzcd}
%   %     U_\e\subseteq\Sigma \arrow[d,"\phi"]\arrow[r,"u^\e"] & T^*U_\e \arrow[r,"\pi^N"] & N^*U_\e \arrow[d,"\psi"] \\
%   %     V_\e\subseteq\R^{d-1}\arrow[rr,"f^\e"] & & V\times W\subseteq\R^{d-1}\R
%   %   \end{tikzcd}
%   % \end{center}
%   Define $h$ via the following diagram:
%   \begin{center}
%     \tikzset{external/export next=false}
%     \begin{tikzcd}
%       U\times E\subseteq\Sigma\times E \arrow[d,"\phi"]\arrow[r,"u^{\cdot_2}(\cdot_1)"] & T^*U \arrow[r,"\pi^N"] & N^*U \arrow[d,"\pi_W\circ\psi"] \\
%       V\times E\subseteq\R^{d-1}\times E \arrow[rr,"h"] & & W\subseteq\R
%     \end{tikzcd}
%   \end{center}
%   Since $u$ is transverse to the zero section of $N^*U$ the function $h$ is of full rank around the
%   point $(x,0)$ in the $x$ variable.
%   By the implicit function theorem or constant rank theorem there exists  a coordinate permutation
%   and a differentiable function $g\colon \pi_{\R^{d-2}}V\times E\to \R$ on $V$ such that
%   \begin{align}
%     \brk[c]*{\brk*{y,g(y,\e),\e}\colon (y,\e)\in \pi_{\R^{d-2}}V\times E}
%   \end{align}
%   is precisely the set around $(x,0)$ on which $h$ vanishes.
%   Here the sets $U$, $E$ and $V$ potentially shrink and we assume that the coordinate permutation was incorporated into the
%   mapping $\phi$. Since $g$ is continuous it follows at least locally that the
%   set $\Sigma^0\brk*{u^\e}$ depends continuously on the parameter $\e$.
%   This shows that
%   \begin{align}
%     \lim_{\e\to0}\sup_{x\in\Sigma^0\brk*{u}}\dist\brk*{x,\Sigma^0(u^\e)}=0\,.
%     \label{eq:convergence_Sigma0_limsup1}
%   \end{align}

%   It remains to be shown that
%   \begin{align}
%     \lim_{\e\to0}\sup_{x\in\Sigma^0\brk*{u^\e}}\dist\brk*{x,\Sigma^0\brk*{u}}=0\,.
%     \label{eq:convergence_Sigma0_limsup2}
%   \end{align}
%   Assume not. Then there exists sequences $\e_k$ and $x_k\in\Sigma^0\brk*{u^{\e_k}}$ and a $\delta>0$ such that
%   \begin{align}
%     \dist\brk*{x_k,\Sigma^0\brk*{u}}\geq\delta\,.
%   \end{align}
%   By compactness of $\Sigma$ we can assume that $x_k\to x$ in $\Sigma$ after taking a sub-sequence. 
%   But now by continuity of $\pi^N$ we obtain
%   \begin{align}
%     0=\lim_{k}u^{N,\e_k}\brk*{x_k}
%     =\pi^N\circ\lim_{k}\brk*{u\brk*{x_k}+\e_k}
%     =\pi^N\circ u\brk*{\lim_kx_k}
%     =u^{N,0}\brk*{x}
%   \end{align}
%   and thus $x\in\Sigma^0(u)$. But $x_k\to x$ is a contradiction to $\dist\brk*{x_k,x}\geq\delta$.

%   Now equations \eqref{eq:convergence_Sigma0_limsup1} and \eqref{eq:convergence_Sigma0_limsup2} imply that
%   \begin{align}
%     \lim_\e d_H\brk*{\Sigma^0\brk*{u^\e},\Sigma^0\brk*{u}}=0
%   \end{align}
% \end{proof}

% From the previous proof we obtain the corollary
% \begin{corollary}\label{co:tanReg_homotopy}
%   Assume that $\Sigma$ is a $C^1$ manifold and that $u$ is tangency regular.
%   Then there exists a $\delta>0$, such that for every
%   $\e\in B_\delta$ the set $\Sigma^+\brk*{u^\e}$ is homotopic to $\Sigma^+(u)$.
% \end{corollary}
% \begin{proof}
%   Since $\Sigma^0$ is compact we obtain as in the proof above finitely points $x\in\Sigma(u)$,
%   open sets $U=U_x$,
%   $g=g_x$, $\phi=\phi_x$ etc.\ as in the proof above such that the $U_x$ cover $\Sigma^0(u)$.
%   Choose $\eta$ sufficiently small such that the set
%   \begin{align}
%     \brk*{\Sigma^0\brk*{u}}_\eta=\brk[c]*{y\in\Sigma\colon \dist\brk*{y,\Sigma^0\brk*{u}}<\delta}\subseteq \bigcup_xU_x
%   \end{align}
%   is contained in the union of the $U_x$. By the previous proposition we can choose $\delta$ such that 
%   \begin{align}
%     d_H\brk*{\Sigma^0\brk*{u^\e},\Sigma^0\brk*{u}}<\eta
%   \end{align}
%   for all $\e\in B_\delta$. Now fix $\e\in E$.
%   We now construct the homotopy
%   \begin{align}
%     G\colon [0,1]\times\Sigma^+\brk*{u}&\to\Sigma^+\brk*{u^\e}
%   \end{align}
%   as $G(t,\cdot)=\Id$ is the identity outside of $\brk*{\Sigma^0\brk*{u}}_\eta$ 
%   \td{complete construction}
% \end{proof}

% We define the \emph{Kuratowski limit inferior} for a sequence of sets $A_n\subseteq X$ as
% \begin{align}
%   \liminf_n A_n=\brk[c]*{x\in X\colon \limsup_n \dist\brk*{x,A_n}=0}\,.
% \end{align}
% Analogously define the \emph{Kuratowski limit superior}.
% With this notion we can formulate the following proposition
% \begin{proposition}
%   Assume that $\Sigma$ is a $C^1$ manifold. Then there exists a sequence $\e_n$ such that each
%   $\e_n$ is tangency regular and such that the limit
%   \begin{align}
%     \liminf_{n}\Sigma^0\brk*{u^{\e_n}}\subseteq\Sigma^0\brk*{u}
%   \end{align}
%   contains a point in each connected component of $\Sigma^0(u)$.
% \end{proposition}
% \begin{proof}
  
% \end{proof}

% Thus we obtain the corollary
% \begin{corollary}[Density of boundary generic functions for $C^1$ boundary]
%   Let $u$, $\delta$ and $\e$ be as in corollary \ref{} and assume that $\Sigma$ is a $C^1$ manifold. Then
%   we have as $\e\to0$ that
%   \begin{enumerate}[resume]
%     \item $\Sigma^0\brk*{u^\e}$ converges and has a limit contained in $\Sigma^0(u)$
%   \end{enumerate}
% \end{corollary}

\td{Some parts of the proof above are not so clean. Also, do I use the notation $X_j\precsim X_{j+1}$ anywhere?}

\chapter{The Morse inequalities}\label{ch:Morse}

The aim of this chapter is to state and motivate the Morse inequalities for manifolds
with corners. For this we first introduce the Betti numbers of the domain $X$,
then we state the Morse inequalities and finally we give a motivation as to why these
inequalities hold.
After that we state the Morse inequalities in the special case of $d\in\brk[c]*{2,3}$ dimensions 
for a harmonic Morse function $f$.

\section{Betti numbers}

\nomenclature{$b_k\brk*{X}$}{$k$-th Betti number of $X$ as defined in equation \eqref{eq:df_bettiNbrs}}
\nomenclature{$H_k\brk*{X}$}{$k$-th homology group of the space $X$.}
\nomenclature{$H_k\brk*{X,A}$}{$k$-th relative homology group for spaces $A\subseteq X$.}
\nomenclature{$\chi(X)$}{Euler characteristic of $X$. See equation \eqref{eq:Morse_Euler}.}
\nomenclature{$\chi(X,A)$}{Euler characteristic for the relative homology group $H_k\brk*{X,A}$.
    See equation \eqref{eq:Morse_relativeEuler}.}

\td{Motivate homology a little more.}
Let $H_k(X)$ denote the $k$-th homology group of $X$ with coefficients in the field $\K$.
For an introduction and definition of these we refer the reader to \cite[Chapter 2]{Hatcher2002}.
We define the $k$-th Betti number as the dimension
\begin{align}
  b_k=b_k\brk*{X}\leftdef\dim_\K H_k(X)\,.\label{eq:df_bettiNbrs}
\end{align}
%
Now we can define the \emph{Euler characteristic} to be
\begin{align}
  \chi=\chi(X)\leftdef\sum_{k=0}^d\brk*{-1}^{k}b_k(X)\label{eq:Morse_Euler}
\end{align}
the alternating sum of the Betti numbers.
% 
We proceed to give examples for Betti numbers of selected connected domains in $\R^d$.
% 
\begin{table}[h]
  \centering
  \renewcommand{\arraystretch}{3}
  \begin{tabular}{c|c|c|c|c|c}
    Domain & Picture & $b_0$ & $b_1$ & $b_k$, $k\geq2$ & $\chi\brk*{X}$ \\ \hline
    Disk $D$ & 
    \begin{minipage}{0.1\textwidth}
      \def\svgwidth{\textwidth}
      \input{../Figures/n2_domains_disk.pdf_tex}
    \end{minipage}
    & 1 & 0 & 0 & 1 \\
    Annulus $2D\setminus D$ & 
    \begin{minipage}{0.1\textwidth}
      \def\svgwidth{\textwidth}
      \input{../Figures/n2_domains_annulus.pdf_tex}
    \end{minipage}
    & 1 & 1 & 0 & 0 \\
    Two holed button & 
    \begin{minipage}{0.1\textwidth}
      \def\svgwidth{\textwidth}
      \input{../Figures/n2_domains_button.pdf_tex}
    \end{minipage}
    & 1 & 2 & 0 & -1\\
  \end{tabular}
  \caption{Betti numbers for selected domains in $\R^2$.}
  \label{tb:n2_domains_bettiNbrs}
\end{table}
\begin{example}[In flatland]
  In $d=2$ dimensions the zeroth Betti number counts the number of connected components
  of $X$ and the first Betti number counts the number of holes of this domain.
  All other Betti numbers vanish in $\R^2$.
  More concretely, we give the Betti numbers for selected domains in table \ref{tb:n2_domains_bettiNbrs}.
\end{example}
%
\begin{example}[In spaceland]
  In $d=3$ dimensions the zeroth Betti number counts the number of connected components
  of $X$, the first Betti number counts the number of holes and the second Betti number
  counts the number of bubbles of the domain. All other Betti numbers vanish.
  The Betti numbers for selected domains can be seen in table \ref{tb:n3_domains_bettiNbrs}.
\end{example}
\td{clarify final example.}
%
\begin{table}
  \centering
  \renewcommand{\arraystretch}{3}
  \begin{tabular}{c|c|c|c|c|c|c}
    Domain & Picture & $b_0$ & $b_1$ & $b_2$ & $b_k$, $k\geq3$ & $\chi\brk*{X}$ \\ \hline
    Ball $B$ & 
    \begin{minipage}{0.1\textwidth}
      \def\svgwidth{\textwidth}
      \input{../Figures/n3_domains_ball.pdf_tex}
    \end{minipage}
    & 1 & 0 & 0 & 0 & 1 \\
    Solid torus $S^1\times D$ & 
    \begin{minipage}{0.1\textwidth}
      \def\svgwidth{\textwidth}
      \input{../Figures/n3_domains_torus.pdf_tex}
    \end{minipage}
    & 1 & 1 & 0 & 0 & 0 \\
    Ball with bubble $2B\setminus B$ & 
    \begin{minipage}{0.1\textwidth}
      \def\svgwidth{\textwidth}
      \input{../Figures/n3_domains_ballBubble.pdf_tex}
    \end{minipage}
    & 1 & 0 & 1 & 0 & 2 \\
    \makecell{Ball with bubble \\in shape of torus} & 
    \begin{minipage}{0.1\textwidth}
      \def\svgwidth{\textwidth}
      \input{../Figures/n3_domains_ballTorusHole.pdf_tex}
    \end{minipage}
    & 1 & 1 & 1 & 0  & 1\\
  \end{tabular}
  \caption{Betti numbers for selected domains in $\R^3$.}
  \label{tb:n3_domains_bettiNbrs}
\end{table}

\section{The Morse inequalities}

We state the Morse inequalities for manifolds with corners:
\begin{theorem}[Morse inequalities, {\cite[Theorem 2.4]{Agrach1991}}]
  \label{th:Morse_MorseIneq}
  Let $X$ be a manifold with corners and $f\colon X\to\R$ be smooth and Morse.
  Then we have for $l\in\brk[c]*{0,\dots,d}$ the inequalities
  \begin{align}
    \sum_{k=0}^l \brk*{-1}^{k+l}\essind_k(f)\geq \sum_{k=0}^l\brk*{-1}^{k+l}b_k(X)\,.
    \label{eq:MorseIneq_inequality}
  \end{align}
  For $l=d$ we in fact have equality
  \begin{align}
    \sum_{k=0}^d \brk*{-1}^{k}\essind_k(f)= \chi(X)\label{eq:MorseIneq_equality}
  \end{align}
  where $\chi(X)$ denotes the Euler characteristic.
\end{theorem}
% \begin{proof}
  The definition of regular critical points of $f$ and their index given in definition \ref{df:nonDegeneracy} coincides with 
  the definition of a critical point and its co-index of $-f$ given in \cite{Agrach1991}.
  Theorem \ref{th:Morse_MorseIneq} then follows from \cite[Theorem 2.4]{Agrach1991}.
  Nonetheless we will give an idea of the proof.
% \end{proof}

Define for $a\in\R$ the manifold $X^a\leftdef\brk[c]*{x\in X\colon f(x)\leq a}$.
The main idea in the proof of the Morse inequalities for manifolds with corners is to inspect how the topology of the manifold $X^a$ changes as we vary $a$.
This was the idea in Morse's original proof of these inequalities for manifolds without boundary in \cite{Morse1925}.
Later proofs of the Morse inequalities for manifolds without boundary using this approach added more terminology from algebraic topology and differential geometry.
Proofs of the Morse inequalities can be found in \cite[§5]{Milnor1963} for manifolds without boundary and 
in \cite[Theorem 10.2']{Morse1969} for manifolds with $C^1$ boundary.
There also exists proofs using dynamical system techniques
which can be found for instance in \cite{Smale1960}.
We require however the Morse inequalities on manifolds with corners.
This is a special case of stratified Morse theory by Goresky and McPherson which is outlined for instance in \cite[§5.5]{Cisneros2020}.
We will try to avoid the fancy tools that are used in stratified Morse theory and instead
resort to \cite{Agrach1991} and \cite{Handron2002} where the Morse inequalities are shown for
manifolds with corners.
In the following we will outline the main ideas of the proof to convince the reader
as to why equation \eqref{eq:MorseIneq_equality} is reasonable as this will be the only part of the 
Morse inequalities we will use.
\td{Reference Banyaga here.}

% This is the approach used in \cite{Milnor1963}, \cite{Agrach1991} and \cite{Handron2002}.
% The proof involves two main steps. The first is to show the following
% In \cite{Handron2002} one constructs a 
% vector field $G$ on $X$ such that at
% every $x\in\overline{X}_j$ we have $G(x)=-u_j(x)$ where $X_j$ is the stratum of maximum dimension
% such that $u_j(x)$ points into $X$.
% In classical Morse theory for manifolds without boundary one simply sets $G=-\nabla f$.
% It is shown in \cite[§2.4]{Handron2002} that $G$ is a well-defined vector field.
% One then obtains a flow $\phi$ as in the following proposition:
% \begin{proposition}[{\cite[Lemma 1]{Handron2002}}]
%   Let $f$ be a Morse function then $G$ induces a flow $\phi\colon X\times\R_{\geq0}\to X$ such that
%   \begin{enumerate}
%     \item $\phi(\cdot,0)=\Id_X$
%     \item $\partial_t\phi\brk*{x,t}=G\circ\phi\brk*{x,t}$
%   \end{enumerate}
% \end{proposition}
% \begin{proof}
%   See \cite[Lemma 1]{Handron2002}. Note that the requirement that \ref{} implies that
%   $f$ fulfills property $(3)$.
% \end{proof}
% One then uses this flow $\phi$ to show the following:
% \begin{lemma}[Interval without critical value, {\cite[Theorem 7]{Handron2002}} and {\cite[p.7]{Agrach1991}}]
%   \label{le:Morse_homotopicNoCP}
%   Assume that the interval $[a,b]$ contains no critical value of $f$.
%   Then $X^a\simeq X^b$ are homotopic.
% \end{lemma}
% \begin{proof}
%   See for instance \cite[Theorem 7]{Handron2002}.
%   One uses the flow $\phi$ to define a homotopy between $X^a$ and $X^b$.
% \end{proof}

We first cite a result from \cite{Agrach1991}.
\begin{proposition}[{\cite[Theorem 2.1]{Agrach1991}}]
  \label{pr:Morse_TransversalityLemma}
  Let $t_0,t_1\in\R$ and $F\colon \R\times X\to Y$ be a smooth map such that for each $t_0\leq t\leq t_1$ the function
  $f_t=F\brk*{t,\cdot}$ is transverse to a submanifold with corners $W\subseteq Y$.
  Then the sets $f_{t_0}^{-1}\brk*{W}\simeq f_{t_1}^{-1}\brk*{W}$
  are homotopic.
\end{proposition}
\begin{proof}[Idea of proof]
  See \cite[Theorem 2.1]{Agrach1991}.
  The proof involves the construction of a flow $P$ defined on a neighbourhood of $X$
  for which $P_t\brk*{f_{t_0}^{-1}\brk*{W}}\subseteq f_{t}^{-1}\brk*{W}$ for all $t_0\leq t\leq t_1$.
\end{proof}
With this result one can show the following:
\begin{lemma}[Interval without critical value, {\cite[Theorem 7]{Handron2002}} and {\cite[p.7]{Agrach1991}}]
  \label{le:Morse_homotopicNoCP}
  Assume that the interval $[a,b]$ contains no critical value of $f$.
  Then $X^a\simeq X^b$ are homotopic.
\end{lemma}
\begin{proof}
  One sets $f_t=f-t$ in the previous lemma and $W=\R_{\leq0}$.
  Note that $X^c=f_c^{-1}\brk*{W}$ for all $c\in\R$.
  We have for every
  $a\leq t\leq b$ and and $x\in f_t^{-1}\brk*{W}$ that
  \begin{align*}
    Df_t\big\vert_{x}\brk*{C_{x}X}+C_{f(x)}W=C_{f(x)}\R=\R
  \end{align*}
  since $C_{f(x)}W=\R$ for $f(x)<t$ and $$Df_t\big\vert_{x}\brk*{C_xX}=Df\big\vert_{x}\brk*{C_xX}=\R$$
  for $f(x)=t$
  since $f$ has no critical values on the interval $[a,b]$.
  Thus $f_t$ is transverse to $W$ for each $a\leq t\leq b$ and the result follows.
\end{proof}
A similar result is given in \cite[Theorem 7]{Handron2002}.
The proof in \cite[Theorem 7]{Handron2002} also involves the construction of a flow
on the manifold $X$. It requires however an additional technical property, named
property $(3)$, which is why we gave the proof by \cite{Agrach1991} for this lemma.


% We state Morse's lemma according to \cite[§6, Lemma 1.1]{Hirsch1994}
% \begin{lemma}
%   Let $f\colon X\to\R$ be $C^{2+r}$ and $x$ be a non-degenerate
%   critical point of index $k$. Then there exists a $C^r$ chart $(\varphi,U)$ at $x$
%   such that we have
%   \begin{align*}
%     f\colon\varphi^{-1}(y)=f(x)-\sum_{j=1}^ky_j^2+\sum_{j=k+1}^dy_j^2\,.
%   \end{align*}
% \end{lemma}
% \begin{proof}
%   See for example \cite[§6]{Hirsch1994}.
% \end{proof}

We state Morse's lemma according to \cite[Lemma 5]{Handron2002}.
\begin{proposition}[Morse's lemma, {\cite[Lemma 5]{Handron2002}}]
  Let $f\colon X\to\R$ be $C^{2}$ and $x$ be an essential regular non-degenerate
  critical point of index $k$ on the stratum $X_j$ of dimension $n$. Then there exists a
  local chart $\varphi\colon U\to V\subseteq H_{d-n}^d$ such that
  \begin{align}
    f\circ\varphi^{-1}(y)=f(x)-\sum_{j=1}^ky_j^2+\sum_{j=k+1}^ny_j^2+\sum_{j=n+1}^dy_j\,.
    \label{eq:Morse_MorseLemma}
  \end{align}
\end{proposition}
\begin{proof}[Idea of proof]
  The case that $n=d$ is the classical version of the Morse lemma and can be found for instance
  in \cite[§6, Lemma 1.1]{Hirsch1994}.
  Note that the definition of an essential critical point in \cite{Handron2002} 
  fulfilling property $(3)$ also encompasses our definition of a non-degenerate regular
  essential critical point. Here the regularity condition ensures that property $(3)$ in \cite{Handron2002}
  is fulfilled. Hence this statement follows from \cite[Lemma 5]{Handron2002}.
  The idea of the proof involves first applying the Morse lemma on the stratum of the critical point.
  Then this coordinate chart is extended with Taylor in a suitable manner to a
  full coordinate chart on $X$ such that equation \eqref{eq:Morse_MorseLemma} holds.
\end{proof}

Using the Morse lemma one can then show the following result:
\begin{lemma}[Interval with critical value, {\cite[Theorem 8]{Handron2002}} and {\cite[Theorem 2.2]{Agrach1991}}]
  \label{le:Morse_homotopicCP}
  If the interval $[a,b]$ contains one critical value $a<c<b$ with corresponding essential regular non-degenerate critical point
  $x$ of index $k$
  then $X^b$ is homotopic to $X^a$ by attaching the $k$-cell
  $D^{k}$.
\end{lemma}
\begin{proof}[Idea of proof]
  This is proven in \cite[Theorem 8]{Handron2002}.
  Here we note that we do not require what \cite{Handron2002} calls property $(3)$
  since this was only used to show the analogue of lemma \ref{le:Morse_homotopicNoCP} and in the formulation of the
  Morse lemma.
  The proof is in structure very similar to \cite{Milnor1963}.
  One first uses the Morse lemma to choose a suitable coordinate system
  in a neighbourhood of the critical point.
  Then one chooses $\e>0$ so small such that $B_{2\e}\subseteq V$.
  The proof then proceeds in three steps.
  First one defines a region $H$ as in figure \ref{fi:morseIneq_CP}.
  Then one shows that $X^{c-\e}$ with $H$ attached is homotopic to $X^{c+\e}$.
  Finally one shows that $X^{c-\e}$ with the $k$-cell $D^k$ attached is homotopic to
  $X^{c-\e}$ with $H$ attached.
  The claim then follows from
  \begin{align*}
    X^a\cup D^k
    \simeq X^{c-\e}\cup D^k
    \simeq X^{c-\e}\cup H
    \simeq X^{c+\e}
    \simeq X^b
  \end{align*}
  where we also used the result of lemma \ref{le:Morse_homotopicNoCP}.
\end{proof}
\begin{figure}
  \centering
  \begin{subfigure}{0.45\textwidth}
    \centering
    \def\svgwidth{\textwidth}
    \input{../Figures/morseIneq_interiorCP.pdf_tex}
    % \label{fi:morseIneq_interiorCP}
  \end{subfigure}
  \hfill
  \begin{subfigure}{0.45\textwidth}
    \centering
    \def\svgwidth{\textwidth}
    \input{../Figures/morseIneq_cornerCP.pdf_tex}
    % \label{fi:morseIneq_cornerCP}
  \end{subfigure}
  \caption{}
  \label{fi:morseIneq_CP}
\end{figure}

In the original proof \cite{Morse1925} of the Morse inequalities Morse inspected
in the analogues to lemmas \ref{le:Morse_homotopicNoCP} and \ref{le:Morse_homotopicCP} directly how the Betti numbers of the manifold
changed from $X^a$ to $X^b$.
The modern proofs however lean on the language of algebraic topology which
is why we now need to argue how lemmas \ref{le:Morse_homotopicNoCP} and \ref{le:Morse_homotopicCP} imply the Morse inequalities.
This final part of the proof is given in all details in \cite[§I.5]{Milnor1963}.
Since we only use the equality in equation \eqref{eq:MorseIneq_equality} we shall outline its proof.

Denote the $k$-th relative homology group by $H_k\brk*{X,A}$ for spaces $A\subseteq X$.
Once again we refer the reader to \cite[Chapter 2]{Hatcher2002} for details regarding their definition.
We require a result from algebraic topology proven in \cite[Corollary 2.24]{Hatcher2002}:
% \begin{lemma}[Excision theorem, {\cite[Theorem 2.20]{Hatcher2002}}]
%   Given subspaces $Z\subseteq A\subseteq X$ such that $\overline{Z}\subseteq\interior\brk*{A}$
%   then for every $k$ we have that $H_k\brk*{X\setminus Z,A\setminus Z}\cong H_k\brk*{X,A}$
%   are isomorphic.
% \end{lemma}
% \begin{lemma}[Excision theorem, {\cite[Theorem 2.20]{Hatcher2002}}]
%   Given subspaces $A,B\subseteq X$ such that $X\subseteq\interior\brk*{A}\cup\interior\brk*{B}$
%   then for every $k$ we have that $H_k\brk*{B,A\cap B}\cong H_k\brk*{X,A}$
%   are isomorphic.
% \end{lemma}
\begin{proposition}[Corollary of the excision theorem, {\cite[Corollary 2.24]{Hatcher2002}}]
  \label{pr:Morse_excisionCor}
  Let $X=A\cup B$ be a CW-complex. Then we have for every $k$ that $H_k\brk*{X,A}\cong H_k\brk*{B,A\cap B}$
  are isomorphic.
\end{proposition}
Now define the Euler characteristic for relative homology group by
\begin{align}
  \chi\brk*{X,Y}\leftdef \sum_k\brk*{-1}^k\dim_\K H_k\brk*{X,Y}\,.
  \label{eq:Morse_relativeEuler}
\end{align}
It is shown in \cite[§5]{Milnor1963} that this is additive, in the sense that given suitable $X\supseteq Y\supseteq Z$
we have that
\begin{align}
  \chi\brk*{X,Z}=\chi\brk*{X,Y}+\chi\brk*{Y,Z}\label{eq:MorseIneq_additivChi}
\end{align}
Let $a_0<\dots<a_L$ be such that $[a_l,a_{l+1}]$ contains precisely one critical value in its interior with
index $k_l$ and such that $X=X^{a_L}$ and $X^{a_0}=\emptyset$.
It now follows from lemma \ref{le:Morse_homotopicCP} and proposition \ref{pr:Morse_excisionCor} that
\begin{align*}
  H_k\brk*{X^{a_{l+1}},X^{a_{l}}}
  &=H_k\brk*{X^{a_{l}}\cup D^{k_l},X^{a_{l}}} \\
  &= H_k\brk*{D^{k_l},S^{k_l}} \\
  &=\begin{cases}
    \K &\text{ if }k=k_l,\\
    0 &\text{ else}
  \end{cases}
\end{align*}
so
\begin{align}
  \chi\brk*{X^{a_{l+1}},X^{a_l}}=\brk*{-1}^{k_l}\,.\label{eq:Morse_chiSingleCP}
\end{align}
Hence we obtain by inductively applying equation \eqref{eq:MorseIneq_additivChi}
and then \eqref{eq:Morse_chiSingleCP} that
\begin{align*}
  \chi\brk*{X}=\chi\brk*{X^{a_L},X^{a_0}}=\sum_l \chi\brk*{X^{a_{l+1}},X^{a_l}}
  =\sum_k\brk*{-1}^k\ind_k\brk*{f}
\end{align*}
so equation \eqref{eq:MorseIneq_equality} of the Morse inequalities follows
for the case that no two critical points lie in the same level set.
In case there are multiple critical points on the same level set the notation
becomes a little more involved but the idea of the proof is the same.
The proof of the inequalities \eqref{eq:MorseIneq_inequality} involves defining the
Betti numbers for relative homology groups and then making a similar argumentation
as above with these Betti numbers instead of the Euler characteristic. For details we refer the reader to \cite[§5]{Milnor1963}.


% \begin{corollary}[Weak Morse inequalities]
%   Let $X$ be a manifold with corners and $f\colon X\to\R$ Morse. Then we have for $k\in\brk[c]*{0,\dots,d}$
%   the inequalities
%   \begin{align*}
%     \essind_k(f)\geq b_k(X)\,.
%   \end{align*}
% \end{corollary}
% \begin{proof}
%   \td{Write some proof.}
% \end{proof}
In the final part of this chapter we inspect the Morse inequalities in the special case
that $f$ is harmonic.
If we assume that $f$ is harmonic the maximum principle implies that
$M_0=0=M_d$.
If we additionally assume that we have dimensions $d=2$ we obtain from the Morse inequalities (theorem \ref{th:Morse_MorseIneq}) a result from \cite[Corollary 10.1]{Morse1969}.
\begin{corollary}[Morse inequalities for harmonic $f$ in $\R^2$, {\cite[Corollary 10.1]{Morse1969}}]
  Let $X\subseteq\R^2$ be a manifold with corners and $f\colon X\to\R$ be harmonic and Morse.
  Then we have
  \begin{align*}
    \mu_0&\geq b_0 \\
    M+\mu_1-\mu_0&=-\chi\brk*{X}\,.
  \end{align*}
\end{corollary}
In dimensions $d=3$ we obtain from theorem \ref{th:Morse_MorseIneq} a result from \cite[Corollary 10.2]{Morse1969}.
\begin{corollary}[Morse inequalities for harmonic $f$ in $\R^3$, {\cite[Corollary 10.2]{Morse1969}}]
  Let $X\subseteq\R^3$ be a manifold with corners and $f\colon X\to\R$ be harmonic and Morse.
  Then we have
  \begin{align*}
    \mu_0&\geq b_0 \\
    M_1+\mu_1-\mu_0&\geq b_1-b_0 \\
    M_2+\mu_2-M_1-\mu_1+\mu_0&= \chi\brk*{X}\,.
  \end{align*}
\end{corollary}
\td{Perhaps give a classical example of a Morse function to determine the Betti numbers.}


\chapter{Connected entrant boundaries in $\R^2$}

We will start this section by giving an essentially negative answer to question \ref{qu:flowthroughStagnationPoint}
in $d=2$ dimensions. Thus it is not possible to have a harmonic function with interior critical point on a simply connected
planar domain with connected entrant and connected emergent boundaries. The proof of this will involve Morse theory on manifolds with corners which was
introduced in the previous chapter.
We shall then state a result from \cite{Alessandrini1992} which more generally relates the number of entrant components with the number
of critical points in the plane using tools from complex analysis. 
After that we give examples showing that dropping the condition of simply connectedness on the domain yields
a harmonic function with interior stagnation point. 
We will also consider the analogous problem in $d=4$ dimensions and show that there exists a function and domain with the
desired properties.

% \begin{proposition}\label{pr:n2:hf:nonExistence}
%   Let $\Omega$ be homeomorphic to $B_1\subseteq\R^2$. Let further $f\colon\overline{\Omega}\to\R$ be regular harmonic  
%   with critical point $x_1\in\Omega$. Then $\Sigma^-\subseteq\Sigma$ is not connected.
% \end{proposition}
% We shall give two different proofs of this result. One involving level-sets and the other involving invariant manifolds

% \section{A proof involving level-sets}

% \ruggedtodo[]{write omega-limit.}
% \begin{proof}[Sketch of Proof.]
%   Let $y_c=f(x_1)$ and $x_1,\dots,x_M$ be all the critical points such that $f(x_\cdot)=y_c$.
%   We claim that the level set
%   \begin{align*}
%     C=\brk[c]*{f=y_c}\subseteq\overline{\Omega}
%   \end{align*}
%   can be represented by a multigraph $G$
%   which divides the boundary $\Sigma$ into 4 components. To show this let $\gamma_i\colon \brk*{a_i,b_i}\to C$ for $i\in\brk[c]{1,\dots,4}$ parametrise the curves in
%   $C$ intersecting at $x_1$. These can be constructed with the initial value problem
%   \begin{align*} 
%     \gamma'&=\brk*{\nabla f}^\perp\big\vert_\gamma \\
%     \gamma(0) &= \gamma_0
%   \end{align*}
%   where $\gamma_0\in C$ is chosen sufficiently near $x_1$. We assume that the intervals on which the $\gamma_i$ are
%   defined are maximal. We thus have for
%   \begin{align*}
%     \gamma_i^-=\lim_{t\to a_i}\gamma(t) \\
%     \gamma_i^+=\lim_{t\to b_i}\gamma(t)
%   \end{align*}
%   that $\gamma_i^\pm\in\brk[c]*{x_1,\dots,x_M,\Sigma}$ since the $x_j$ are the sole points on $\Omega\cap\overline{C}$
%   at which $\nabla f^\perp=0$. This argument can be applied to all of the 
%   $x_1,\dots,x_M$. We therefore have a situation similar to the one depicted in figure \ref{fi:n2:levelSets:overview}.
  
%   \begin{figure}
%     \centering
%     \def\svgwidth{0.8\textwidth}
%     \input{../Figures/n2_levelSets_overview.pdf_tex}
%     \caption{The situation at hand: The edges represent level curves and the interior vertices critical points.}
%     \label{fi:n2:levelSets:overview}
%   \end{figure}

%   Thus $C$ can be represented by a multigraph $G$ with vertices $v_1,\dots,v_K$ and edges $e_1,\dots,e_L\subseteq C$.
%   In the following we identify the graph $G$ with its planar embedding in $\overline{\Omega}$.
%   Assume $G$ contains a cycle with vertex sequence $v_{i_1},\dots,v_{i_J}$ and edges $e_{i_1},\dots,e_{i_J}$. Then
%   \begin{align*}
%     \partial E = \bigcup_j e_{i_j}\subseteq C
%   \end{align*}
%   is the boundary of a domain $E$ for which $f=y_c$ on $\partial E$. By the maximum principle $f=y_c$ on $E$ and thus
%   $f=y_c$ on $\overline{\Omega}$, a contradiction to the non-degeneracy. Hence $G$ is acyclic and the number of 
%   intersections of $C$ with the boundary $\Sigma$ is at least four and thus the boundary $\Sigma$ is divided into at least four components.
  
%   Now choose four neighbouring components $\omega_1,\dots,\omega_4$ as depicted in figure \ref{fi:n2:levelSets:neighbouringComponents}
%   \begin{figure}
%     \centering
%     \input{../figures/n2_levelSets_selectionOmega.pdf_tex}
%     \caption{The choice of $\omega_1,\dots,\omega_4$.}
%     \label{fi:n2:levelSets:neighbouringComponents}
%   \end{figure}
%   Let $A\subseteq\Omega$ be the domain bounded
%   by $\omega_1$ and $C$ as in the figure. The maximum principle yields that $\omega_1$ contains a local maximum or minimum of $f$ since
%   $f=y_c$ is constant on the other boundaries $\partial A\setminus\omega_1$.
%   By the same argument $\omega_2,\dots,\omega_4$ also contain local extrema. 
%   \ruggedtodo[]{use argument with $\nabla f$ here to show that extrema can be assumed to be alternating.}
%   Since the $\partial\omega_i$ cannot be extremal points on $\Sigma$
%   we can assume without loss of generality (by switching $f$ for $-f$) that $\omega_1$ and $\omega_3$ contain local maxima and $\omega_2 $ and $\omega_4$ local
%   minima. By Hopf's lemma we thus have
%   \begin{align*}
%     \Sigma^-\cap\omega_2\neq\emptyset\neq\Sigma^-\cap\omega_4
%   \end{align*}
%   and 
%   \begin{align*}
%     \Sigma^+\cap\omega_1\neq\emptyset\neq\Sigma^+\cap\omega_3
%   \end{align*}
%   From this the claim follows.
% \end{proof}

% \section{A proof involving invariant manifolds}

% Using invariant manifolds we obtain the following proof.

% \begin{proof}[Sketch of Proof.]
%   Let $x_1,\dots,x_M$ denote the critical points of $f$. Let $\lambda_i\colon\brk*{a_i,b_i}\to\overline{\Omega}$ for $i\in\brk[c]{1,2}$ parametrise the unstable manifolds of the
%   critical point $x_1$ and
%   $\lambda_i\colon\brk*{a_i,b_i}\to\overline{\Omega}$ for $i\in\brk[c]{3,4}$ be chosen to parametrise the stable manifolds of $x_1$.
%   As in the previous proof we can assume the interval on which the $\lambda_i$ are defined to be maximal. We thus have for
%   \begin{align*}
%     \lambda_i^-=\lim_{t\to a_i}\lambda(t) \\
%     \lambda_i^+=\lim_{t\to b_i}\lambda(t)
%   \end{align*}
%   that $\lambda_i^\pm\in\brk[c]*{x_1,\dots,x_M,\Sigma}$ since the $x_j$ are the sole points on $\overline{\Omega}$
%   at which $Df=0$. Thus all invariant manifolds of all critical points form a directed multigraph $G$ with vertices $v_1,\dots,v_K$ and 
%   edges $e_1,\dots,e_L\subseteq\overline{\Omega}$. Here the direction of the edge is determined by whether $f$ increases or decreases
%   along the edge.
%   Once again we identify the graph with its planar embedding.
%   By construction graph is acyclic directed. We claim that the underlying undirected graph is in fact a forest. Thus it remains to
%   be shown that the underlying undirected graph is acyclic.
%   Assume not, i.e.\ we have a undirected cycle A with vertices $x_{i_1},\dots,x_{i_J}$ and edges $e_{i_1},\dots,e_{i_J}$.
%   The set of cycles forms a partial ordering with respect to the property `contains another cycle'.
%   \ruggedtodo[]{More precise.}
%   We can assume that our chosen cycle A
%   contains no other distinct cycles, i.e.\ it is a minimal cycle.
%   We note that each vertex has 2 incoming and 2 outgoing arcs which lie opposite to one another.
%   We also note that the edges cannot cross. 
%   We can thus describe the trail $x_{i_1},\dots,x_{i_J}$ by a set of directives of the type
%   \begin{align*}
%     (d_1,\dots,d_K) \in \brk[c]*{\text{l},\text{r},\text{s}}^J\,.
%   \end{align*}
%   Here l, r and s stand for `left', `right' and `straight' respectively.
%   The underlying idea is that we follow a particular trail and orient all vertices as in figure \ref{fi:n2:invariantMF:directivesDefinition}.
  
%   \begin{figure}
%     \centering
%     \begin{minipage}{0.4\textwidth}
%       \def\svgwidth{0.7\textwidth}
%       \input{../Figures/n2_invariantMF_directivesDefinition.pdf_tex}
%       \caption{Explanation of the directives `l',`r' and `r'.}
%       \label{fi:n2:invariantMF:directivesDefinition}
%     \end{minipage}
%     \hfill
%     \begin{minipage}{0.4\textwidth}
%       \def\svgwidth{1\textwidth}
%       \input{../Figures/n2_invariantMF_directivesExample.pdf_tex}
%       \caption{An example for a cycle.}
%       \label{fi:n2:invariantMF:directivesExample}
%     \end{minipage}
%   \end{figure}

%   An example of the trail `srsr' is given in figure \ref{fi:n2:invariantMF:directivesExample}.
%   We now note that cycles of the type r,\dots,r or l,\dots,l
%   cannot occur as we otherwise would have a directed cycle. Thus there exists a vertex where the chosen direction is s. 
%   Without loss of generality this vertex is $x_{i_1}$.
%   Since we can swap $f$ with $-f$ we can assume without loss of generality that the cycle lies to right of $x_{i_1}$.
%   Now consider new cycle B starting at $x_{i_1}$ with directives r,\dots,r.
%   Since all vertices of B lie within the cycle A we must at some step reach a vertex on the cycle A. But then cycle B is a new distinct cycle
%   contained in cycle A, a contradiction to the minimality of A.
%   Hence every case considered leads to a contradiction and it follows that the underlying undirected multigraph of $G$
%   is acyclic.
  
%   Now call a leaf positive if it lies on the emergent boundary and
%   negative if it lies on the entrant boundary. The case that a leaf is neither positive or negative cannot occur.\ruggedtodo[]{elaborate}
%   We now pick a tree $\widetilde{G}$ out of $G$ and note that
%   there are at least 4 boundary vertices to this tree.
%   By construction we see that each `neighbouring'\ruggedtodo[]{elaborate} leaf of this tree
%   has opposite signage and the claim follows.
% \end{proof}


\section{A negative result for simply connected domains}

We now give a result which is essentially a negative answer to question \ref{qu:flowthroughStagnationPoint}.
It was possible to prove this statement using level sets of critical points or using invariant manifolds.
The following proof involves Morse theory since the techniques of the proof generalise to the three dimensional case.
\begin{proposition}[Negative answer to question \ref{qu:flowthroughStagnationPoint} in $d=2$ dimensions]\label{pr:n2_negativeResult}
  Let $X\subseteq\R^2$ be a simply connected planar manifold with corners and let $f\colon X\to\R$ have no irregular critical points.
  Let $\Sigma=\Sigma_{\leq0}\sqcup\Sigma_{\geq0}$ be a disjoint decomposition of the boundary into simply connected nonempty sets such that
  we have for the entrant boundary $\Sigma^-\subseteq\Sigma_{\leq0}$ and for the emergent boundary $\Sigma^+\subseteq\Sigma_{\geq0}$.
  Then $f$ has no interior critical point.
\end{proposition}

% We start with a technical lemma
% \begin{lemma}
%   Let $u\colon\R^{d}\supset (-\eta,\eta)\times U_0\to\R^d$ be a vector field on an open set $U_0\subset\R^{d-1}$. Assume that on $U$ we
%   have that $u\colon e_1>\delta$ on $\brk[c]{0}\times U_0$ for some $\delta>0$. Then we have for almost every $\e>0$ that $u$ restricted to the cotangent space
%   $T^*U_\e$ is Morse. Here the submanifold $U_\e$ is given as 
%   \begin{align}
%     U_\e=\e\graph(\phi)
%   \end{align}
%   for some suitable function $\phi\in C_c^\infty(U_0;[0,1])$.
% \end{lemma}
% \begin{proof}
%   Let $x_0\in U_0$ be degenerate.
% \end{proof}
% For the following proof we require the following technical lemma
% \begin{lemma}
%   Let $X$ be a $d$ dimensional manifold with boundary and $u\colon X\to\R^d$ a smooth Morse vector field. Assume that $\Gamma\subset X$ is
%   $d-1$ dimensional manifold with boundary not containing any interior critical points of $u$ on $X$ and let $\e>0$. Then there exists a manifold $\Gamma_\e\subseteq U_\e\brk*{\Gamma}$ contained
%   in an $\e$ neighbourhood of $\Gamma$ such that $\partial\Gamma=\partial\Gamma_\e$ and such that $f$ is morse on
%   $\interior(\Gamma_\e)$.
% \end{lemma}
% \begin{proof}
  % Let $x$ be a critical point of $u$ on $\Gamma$. Since $x$ is not an interior critical point there exists a neighbourhood $U\subseteq\Gamma$ of 
  % $x$ such that the normal $n\colon U\to \R^d$ is defined, $\abs*{u\cdot n}>\delta$ for some $\delta>0$ and $\abs{n-n(x)}\leq\delta$.
  % Let $r>0$ such that $B_r(x)\cap\Gamma\subseteq U$. We choose a function $\phi\in C_c^\infty(B_r(x);[0,1])$ such that $\phi(x)\neq0$.
  % Define for $\eta>0$
  % the manifold $\Gamma_\eta=\Gamma+\eta\phi n(x)$. We now claim that for almost all $\eta\leq\e$ the function 
  % \begin{align}
  %   \phi\in C_c^\infty(U;\R)
  % \end{align}
  % and require $\phi(x)\neq0$. Now consider the function given by
  % \begin{align}
  %   G(x,t)=\Phi(x,\eta\phi(x)t)
  % \end{align}
  % where $\eta>0$ and $\Phi$ is the flow induced by the vector field $u$. We note that by construction for every $t$ the set
  % \begin{align}
  %   \Gamma\setminus U\cup \image(G(\cdot,t))
  % \end{align}
  % is a smooth manifold.
%   Our aim is to apply the parametric transversality theorem. 
%   Let $x_0$ be a critical point on $\Gamma$. Let $U_0\subseteq\Gamma$ be an open neighbourhood of $x_0$ and
%   let $\phi_0\colon U_0\to U\subseteq\R^{d-1}$ be a chart. Define further the map
%   \begin{align}
%     \Phi_\e(x)=\Phi(x,f(\e,x))\,.
%   \end{align}
%   Here $\Phi$ denotes the flow induced by $u$ and $f\colon E\times U_0\to\R$ is a suitable function (think bump function).
%   Set $\Psi_\e=\Phi_\e^{-1}$, $x_\e=\Phi_\e(x_0)$ and $U_\e=\Phi_\e(U_0)$.
%   Set $\phi_\e=\phi_0\circ\Psi_\e$ and
%   \begin{align}
%     u^\e = D_x\phi_\e\circ\pi_\e\circ u\circ\phi_\e^{-1}
%   \end{align}
%   where $\pi_\e$ is the restriction onto $T^*U_\e$. We now calculate
%   \begin{align}
%     D_\e u^\e=D_\e D_x\phi_\e+D_x\phi_\e D_e\pi_\e+D_x\phi_\e \pi_\e Du D_\e\phi_\e^{-1}
%   \end{align}
%   where we used the linearity of $D_x\phi_\e$ and $\pi_\e$.
%   We now calculate
%   \begin{align}
%     \Id_{E\times T^*U_\e} &=D_{(\e,x)}\vect{\cdot_1&\Phi_{\cdot_1}(\cdot_2)}\circ\vect{\e&\Psi_\e(x)} \\
%     &=\begin{bmatrix}
%       \Id_E&0\\
%       D_\e\Phi_\e(x) & D_x\Phi_\e(x)
%     \end{bmatrix}
%     \begin{bmatrix}
%       \Id_E &0 \\
%       D_\e\Psi_\e(x) & D_x\Psi_\e(x)
%     \end{bmatrix} \\
%     &= 
%     \begin{bmatrix}
%       \Id_E &0 \\
%       D_\e\Phi_\e(x)+D_x\Phi_\e(x)D_\e\Psi_\e(x) & D_x\Phi_\e(x)D_x\Psi_\e(x)
%     \end{bmatrix}
%   \end{align}
%   Thus in particular
%   \begin{align}
%     D_x\Psi_\e=\brk*{D_x\Phi_\e}^{-1}
%   \end{align}
%   Now notice that
%   \begin{align}
%     D_\e\Phi_\e(x)
%     =D_t\Phi D_\e f(\e,x)=u D_\e f 
%   \end{align}
%   and
%   \begin{align}
%     D_x\Phi_\e
%     =D_x\Phi + D_t\Phi D_x f=D_x\Phi + u \otimes D_x f
%   \end{align}
%   by the property of the flow.
  
%   Hence
%   \begin{align}
%     D_x\phi_\e=D\phi_0 D_x\Psi_\e
%   \end{align}
%   which implies
%   \begin{align}
%     D_\e D_x\phi_\e=D^2\phi_0\brk*{D_x\Psi_\e,D_x\Psi_\e}+D\phi_0 D_\e D_x\Psi_\e
%   \end{align}
%   We also see
%   \begin{align}
%     D_\e\phi_\e^{-1}=D_\e\brk*{\Phi_\e\circ\phi_0^{-1}}
%     =D_\e\Phi_\e D\phi_0^{-1}
%   \end{align}

%   Now we look at $\pi_\e$. This is given as 
%   \begin{align}
%     \pi_\e(u)=\sum_i\partial^\e_i(e_i)\cdot u\partial^\e_i
%   \end{align}
% \end{proof}

\begin{proof}
  % Let $x_1,x_2\in\Sigma^0(f)$ be two points on different connectivity components which we will fix later.
  Let $\gamma=\brk[c]*{x_1,x_2}=\partial\Sigma_{\leq0}$.
  Then we can cut the domain along a curve $\Gamma$ such that the endpoints $\gamma=\partial\Gamma$
  of the cut coincide with $x_1$ and $x_2$, that is $\partial\Gamma=\brk[c]*{x_1,x_2}$.
  Now we obtain two new domains $X^+$ and $X^-$ such that $\partial X^+\cap\Sigma_{\leq0}\subseteq\gamma$ and
  $\partial X^-\cap\Sigma_{\geq0}\subseteq\gamma$. We can assume that $\Gamma$ is a smooth manifold and corresponds to the stratum 
  $X_{\Gamma^+}$ for $X^+$ and $X_{\Gamma^-}$ for $X^-$.
  Analogously $\gamma$ corresponds to strata $X_{\gamma^\pm}$ on $X^\pm$.
  % We also assume that the corner points $x_1,x_2\in\partial\Gamma$ correspond to the strata $X_{1}$ and $X_{2}$.
  Locally around the corner point $x_1$ we have a situation depicted as in figure \ref{fi:n2_cutOmega_flowthrough}.
  \begin{figure} 
    \centering
    \input{../Figures/n2_cutOmega_corneredMf.pdf_tex}
    \caption{The situation at hand.}
    \label{fi:n2_cutOmega_flowthrough}
  \end{figure}
  We assume that we chose $\Gamma$ in such a way that it forms an acute angle with $u=\nabla f$ at the boundary points $\gamma$.
  % More concretely this condition is equivalent to that there exists an open neighbourhood $U_1$ of $x_1$ such that
  % $n_\Gamma\cdot u< u$ on $U_1$.
  % Here $n_\Gamma\colon\Gamma\to S^1\subseteq\R^2$ denotes the normal of the cut $\Gamma$ which points in the direction of the flow.
  % Without loss of generality $x_1$ is not an essential critical point of $-f$ on $X^-$.
  % The point $x_1$ may or may not however be a critical point of $f$ on $X^+$.
  % Analogously we can choose $\Gamma$ in such a way around $x_2$.
  For the following argumentation we require that $u$ is strongly Morse on both $X^+$ and $X^-$, so assume for a moment that this
  is the case.
  Since each point of $\gamma$ is an essential critical point for either $f$ or $-f$ on precisely one of the domains $X^+$ or $X^-$ we have
  the relation
  \begin{align}
    \ind_{\gamma^+,0}(f)+\ind_{\gamma^+,0}(-f)+\ind_{\gamma^-,0}(f)+\ind_{\gamma^-,0}(-f)=2\,.\label{eq:n2_disproof_morse_relgamma}
  \end{align}
  We now focus our attention on $X^+$. Since no essential critical points of $f$ lie on $\Sigma^+\setminus\gamma$
  it follows for the boundary type numbers that
  \begin{align}
    \mu^+_k=\ind_{\Gamma^+,k}(f)+\ind_{\gamma^+,k}(f)\,.\label{eq:n2_disproof_morse_muplus}
  \end{align}
  Analogously we have on $X^-$ that
  \begin{align}
    \nu^-_k=\ind_{\Gamma^-,k}(-f)+\ind_{\gamma^-,k}(-f)\,.\label{eq:n2_disproof_morse_numinus}
  \end{align}
  % where we took into account that $\ind_{\gamma,k}(-f)=0$.
  In addition we have on $\Gamma$ that the emergent critical points of $f$ on $X^+$ are the
  entrant critical points of $-f$ on $X^-$, that is
  \begin{align}
    \ind_{\Gamma^+,0}(f)=\ind_{\Gamma^-,1}(-f)\qquad\text{ and }\qquad 
    \ind_{\Gamma^+,1}(f)=\ind_{\Gamma^-,0}(-f)\,.\label{eq:n2_disproof_morse_relationIndex} 
  \end{align}
  Using equations \eqref{eq:n2_disproof_morse_muplus}, \eqref{eq:n2_disproof_morse_numinus} and \eqref{eq:n2_disproof_morse_relationIndex}
  we obtain
  \begin{align}
    \mu^+_0-\ind_{\gamma^+,0}(f)=\nu^-_1 \qquad\text{ and }\qquad
    \mu^+_1=\nu^-_0-\ind_{\gamma^-,0}(-f)\,.\label{eq:n2_disproof_morse_relationMuNu}
  \end{align}
  Consider the Morse inequality for $f$ on $X^+$
  \begin{align}
    M^++\mu^+_1-\mu^+_0=-\chi(X^+)=-\chi(X)\label{eq:n2_disproof_morse_morseineqplus}
  \end{align}
  and the Morse inequality for $-f$ on $X^-$
  \begin{align}
    M^-+\nu^-_1-\nu^-_0=-\chi(X^-)=-\chi(X)\,.\label{eq:n2_disproof_morse_morseineqminus}
  \end{align}
  We now add equations \eqref{eq:n2_disproof_morse_morseineqplus} and \eqref{eq:n2_disproof_morse_morseineqminus}
  and insert relations \eqref{eq:n2_disproof_morse_relationMuNu} to obtain
  \begin{align*}
    M^-+M^+-\ind_{\gamma^+,0}(f)-\ind_{\gamma^-,0}(-f)=-2\chi(X)=-2\,.
  \end{align*}
  Since $\ind_{\gamma^+,0}(f)+\ind_{\gamma^-,0}(-f)\leq2$ by equation \eqref{eq:n2_disproof_morse_relgamma} and $M^\pm\geq0$ we must in fact have $M^\pm=0$ from which the claim follows.

  % \ref{pr:tanReg_convergence_Sigma0}
  % \ref{co:tanReg_homotopy}
  % \ref{co:density_boundaryGeneric}

  % The statement now remains to be shown for $u$ which are not Morse on $\Gamma$.
  % Let $u^\e\to u$ for $\e\in E$ be a family of boundary generic functions with respect to the 
  % stratification $X^+\cup X^-$ as in corollary 
  % \ref{co:density_boundaryGeneric}.
  % By proposition \ref{pr:tanReg_convergence_Sigma0} the set $\Sigma^0\brk*{u^\e}$ converges
  % to $\Sigma^0\brk*{u}$ as $\e\to0$.
  % Choose $\delta$ sufficiently small according to corollary \ref{co:tanReg_homotopy}
  % and now assume that $\e\in E_\delta=B_\delta\cap E$.
  % Now take a sufficiently small $\eta>0$ such that $\Gamma$ has no critical points in
  % $\overline{B_\eta\brk*{x_1}}\cup \overline{B_\eta\brk*{x_2}}$. 
  % We modify for every
  % $\e\in E_\delta$ the cut $\Gamma$ to yield a cut $\Gamma_\e$ such that $\Gamma=\Gamma_\e$
  % outside of $B_\eta(x_1)\cup B_\eta(x_2)$ and such that $\Gamma_\e$ intersects the boundary $\Sigma$
  % precisely at $\Sigma^0\brk*{u^\e}$.
  % Furthermore by choosing $\delta$ sufficiently small we can also ensure that
  % $\Gamma$ has no critical points of $u^\e$ inside of $\overline{B_\eta\brk*{x_1}}\cup \overline{B_\eta\brk*{x_2}}$
  % and that $\Gamma_\e$ is slanted in such a way that $u^\e$ has no critical points on
  % $\Gamma_\e\cap B_\eta\brk*{x_1}\cap B_\eta\brk*{x_2}$.
  
  
  % Now $u^\e$ is by construction strongly Morse on $\Gamma^\e$.
  % By the above argument the statement holds for $u^\e$ with the modified cut $\Gamma^\e$.
  % $$\brk[c]*{X_j}_{j\in\cJ}\cup\brk[c]*{X_\Gamma}\cup\brk[c]*{X_j}_{j\in\brk[c]*{1,2}}$$
  % of $X$. Again by proposition \ref{} we have that $\Sigma^0(u^\e)\to\Sigma^0(u)$ for $\e\to0$.
  % This implies that if we choose the cut $\Gamma^\e$ for $u^\e$ as in figure \ref{}
  % we obtain that for all $u^\e$ all

  The claim remains to be shown in the case that $f$ is not strongly Morse on $X^+$ and $X^-$. In this case let
  $E^+,E^-\subseteq B_\delta$ be as in corollary \ref{co:density_boundaryGeneric} applied separately to the domains $X^+$ and $X^-$.
  Since $E^+$ and $E^-$ are residual in $B_\delta$ we can in particular pick an $\e\in E^+\cap E^-$ by the Baire category theorem.
  It follows from the slanted angles at which $\Gamma$ approaches $\gamma$ that if the points $x_1$, $x_2$ are essential critical points of $f$
  that they then are in fact regular.
  Hence we obtain that
  \begin{align*}
    \ind_{\gamma^+,k}\brk*{f^\e}=\ind_{\gamma^+,k}(f)\qquad\text{ and }\qquad 
    \ind_{\gamma^-,k}\brk*{-f^\e}=\ind_{\gamma^-,k}(-f)\,.
    % \label{eq:n2_disproof_morse_indexApprox}
  \end{align*}
  By the same corollary $u^\e$ has no essential stagnation points on $\Sigma^+(u)$
  and $-u$ has no essential stagnation points on $\Sigma^-(u)$.
  % \begin{align}
  %   \ind_{j,X_k}\brk*{f^\e}=\ind_{j,X_k}(f)\qquad\text{ and }\qquad 
  %   \ind_{j,X_k}\brk*{-f^\e}=\ind_{j,X_k}(-f)
  %   \label{eq:n3_disproof_morse_indexApprox}
  % \end{align}
  % for all $j$ and strata $X_k$.
  The claim then follows by the calculations above where we replace
  $f$ with $f^\e$ and then note that $M^\e=M$.
\end{proof}
% \begin{proposition}
%   Let $X$ be a simply connected manifold with corners and $f\colon X\to\R$ harmonic and Morse. 
%   Assume further that $\Sigma^-$ is connected. Then $f$ cannot have an interior critical point.
% \end{proposition}
% \begin{proof}
%   Since $\Sigma^-$ is connected we can cut the domain along a cut $\Gamma$ such that the endpoints $\partial\Gamma$ of
%   $\Gamma$ coincide with the endpoints of $\Sigma^-$. Thus we obtain two domains $X^+$ and $X^-$ with boundaries
%   $\partial X^+=\Gamma\cup\Sigma^{\geq0}$ and $\partial X^-=\Gamma\cup\Sigma^-$.
%   On $X^+$ we obtain the Morse inequalities 
% \end{proof}
% \subsubsection*{A proof involving the argument principle}

% \begin{proposition}
%   Let $X$ be a simply connected manifold with corners and $f\colon X\to\R$ harmonic with an
%   interior critical point.
%   Then $\Sigma^-$ is not connected.
% \end{proposition}
% \begin{proof}
%   Assume not.
%   Let $h\in\Hol(X)$ be the holomorphic function given by $h=\nabla f$.
%   Let $\gamma\colon \R\supseteq (t_0,t_2) \to\Sigma$ traverse the boundary of $X$ such that
%   the interior of $X$ lies to the left of $\gamma$.
%   Without loss of generality $\gamma(t_0)$ is the point where $\gamma$ enters the entrant boundary $\Sigma^-$.
%   Let $\gamma(t_1)$ denote the point at which $\gamma$ leaves the entrant boundary $\Sigma^-$.
%   As $\gamma$ traverses $\Sigma^-$ we have that $h$ points into $\Omega$ and thus lies to the left of
%   the tangent $T_\gamma X$. Thus we obtain for the change in argument of $\arg h$ that
%   \begin{align*}
%     \arg h(\gamma(t_1))-\arg h(\gamma(t_0))=\gamma'(t_0)-\gamma'(t_1)+\pi k
%   \end{align*}
%   where $k\in\brk[c]{-1,0,1}$. Similarly we obtain for the change in argument of $\arg h$ as $\gamma$ traverses
%   $\Sigma^+\cup\Sigma^0$ that
%   \begin{align*}
%     \arg h(\gamma(t_2))-\arg h(\gamma(t_1))=\gamma'(t_2)-\gamma'(t_1)+\pi k
%   \end{align*}
%   We then obtain with the argument principle
%   \begin{align*}
%     2\pi M=\int_{\partial X}\dif{\arg(h(z))}
%   \end{align*}
% \end{proof}

\section{A generalisation of this result}

% The strategy in the above proofs can be generalised to show the following
% \begin{conjecture}
%   Let $X\subseteq\R^2$ be a manifold with corners with Betti numbers $b_0=1$ and $b_1$.
%   Let further $f\colon X\to\R$ be Morse harmonic with $M$ critical points.
%   Assume that 
%   $\overline{\Sigma^-}\subseteq\Sigma$ on a given connected component 
%   of the boundary $\Sigma$
%   consists of at most one connected component. Then we have
%   \begin{align*}
%     \frac{4}{3}M\leq b_1+1\,.
%   \end{align*}
% \end{conjecture}
% This inequality can probably be improved considerably.

We could also have used tools from complex analysis to show proposition \ref{pr:n2_negativeResult}.
In fact, using complex analysis \cite{Alessandrini1992} gives a more refined result
for which we require the next definition.

\begin{definition}[Number of entrant / emergent boundary components, {\cite{Alessandrini1992}}]
Let $J^\pm$ denote the number of connected components of $\Sigma^\pm$ which are proper
subsets of a component of $\Sigma$.
Consider a disjoint decomposition of the boundary $\Sigma=\Sigma_{\geq0}\sqcup\Sigma_{\leq0}$ such
that $\Sigma_{\geq0}\subseteq\Sigma^{\geq0}$ and $\Sigma_{\leq0}\subseteq\Sigma^{\leq0}$.
Let now $J^{\geq0}$ denote the minimal number of connected components of $\Sigma_{\geq0}$ 
which are proper subsets of a component of $\Sigma$.
\end{definition}

We state a consequence of a result from \cite[Theorem 2.1 and 2.2]{Alessandrini1992}:
\begin{proposition}[Special case of {\cite[Theorem 2.1 and 2.2]{Alessandrini1992}}]\label{pr:alessandrini_inflowOutflow}
  Let $X\subseteq\R^d$ be a bounded domain with a boundary consisting of simple closed $C^{1,\alpha}$ curves.
  Let $u\colon X\to \R$ be a harmonic vector field, nonzero on each component.
  Then we have the relation
  \begin{align}
    M\leq -\chi\brk*{X}+\frac{J^++J^-}{2}\label{eq:n2_Alessandrini1}
  \end{align}
  where $M$ denotes the number of stagnation points of $u$, counting multiplicities.
  If in addition we assume that there are no irregular stagnation points then we have
  \begin{align}
    M\leq -\chi\brk*{X}+J^{\geq0}\,.\label{eq:n2_Alessandrini2}
  \end{align}
\end{proposition}
% \begin{proof}
  For a proof we refer the reader to \cite[Theorem 2.1]{Alessandrini1992} and \cite[Theorem 2.2]{Alessandrini1992}. Here one sets $\underline{\alpha}=n$ to be the outer unit normal and $D=\chi\brk*{X}$
  to be the Euler characteristic.
% \end{proof}

If we set $X$ to be homeomorphic to the disk such that $\chi\brk*{X}=1$ and have a
decomposition of the boundary $\Sigma$ as in proposition \ref{pr:n2_negativeResult}, that is $J^\pm=J^{\geq0}=1$,
we then obtain from proposition \ref{pr:alessandrini_inflowOutflow} that $M\leq0$
and $f$ has no interior critical point.

\section{The case of holes in the domain}

If we set $J^\pm=J^{\geq0}=1$ in relations \eqref{eq:n2_Alessandrini1} or \eqref{eq:n2_Alessandrini2}
we obtain the condition on the number of interior stagnation points
\begin{align}
  M\leq-\chi\brk*{X}+1\,.\label{eq:n2_Alessandrini_specialCase}
\end{align}
This indicates that if we allow for holes in the domain $X$ it is possible to have a vector field with simply
connected entrant boundary and interior stagnation points.
In fact we will give two examples where we have equality in equation \eqref{eq:n2_Alessandrini_specialCase}
for the cases $\chi\brk*{X}=0$ and $\chi\brk*{X}=-1$.
For this define two differential operators in $d=2$ dimensions by
\begin{align}
  \nabla^\perp f=\Curl f\leftdef\vect{-\partial_2f \\ \partial_1f}\label{eq:n2_nablaPerp}
\end{align}
and
\begin{align*}
  \curl u\leftdef-\partial_1u_2+\partial_2u_1\,.
\end{align*}
\nomenclature{$\nabla^\perp$}{Orthogonal gradient. Given by equation \eqref{eq:n2_nablaPerp}.}

The next proposition gives us a recipe to generate harmonic vector fields.
\begin{proposition}
  Let $\psi\colon\R^2\supseteq X\to\R$ be harmonic then $u=\nabla^\perp\psi$ is a harmonic vector field.
\end{proposition} 
\begin{proof}
  We have
  \begin{align*}
    \diver u = \diver\nabla^\perp \psi=0
  \end{align*}
  and one calculates
  \begin{align*}
    \curl u = \curl\nabla^\perp \psi = -\Delta \psi = 0
  \end{align*}
  from which the claim follows.
\end{proof}
The function $\psi$ is also called a \emph{stream function}.
The next example is our first example of a harmonic vector fields
in $d=2$ dimensions with an interior stagnation points for which 
we have inflow on one simply connected boundary component and outflow on another simply connected boundary
component.

\begin{example}[Flow through tube with hole and stagnation point]\label{ex:n2_flowthroughHole}
  Consider the stream function
  \begin{equation}
    \begin{aligned}
    \psi\colon \R^2\setminus\brk[c]*{-e_1,e_1}&\to\R \\
    x&\mapsto\Phi_2\brk*{x-e_1}+x_1
    \end{aligned}\label{eq:n2:hvf:InflowOutflow:singleHole}
  \end{equation}
  where
  \begin{align}
    \Phi_2=\log(\abs{\cdot})\label{eq:n2_defPhi}
  \end{align}
  is a multiple of the fundamental solution of the Laplace equation on $\R^2$ and $e_i$ is the $i$-th unit vector.
  A plot of the streamlines in figure \ref{pl:n2_hvf_InflowOutflow_asymmetric_single} indicates that $u=\nabla^\perp\psi$ fulfils the
  requirements on the domain
  $$X=\psi^{-1}\brk*{[-0.5,2]}\cap \brk*{\R\times[-2,2]}\,.$$
  \begin{figure}
    \centering
    \includegraphics[width=0.6\textwidth]{../Plots/HarmonicVectorFields_gr3.eps}
    \caption{A plot of $u=\nabla^\perp\psi$ in the region $\psi^{-1}\brk*{[-0.5,2]}\cap \brk*{\R\times[-2,2]}$.
    Here $\psi$ is given by equation \eqref{eq:n2:hvf:InflowOutflow:singleHole}.}
    \label{pl:n2_hvf_InflowOutflow_asymmetric_single}
  \end{figure}
  Indeed, an elementary calculation reveals that the origin is a stagnation point of $u$.
\end{example}
\nomenclature{$\Phi_2$}{Multiple of the fundamental solution of the Laplace equation on $\R^2$. Given by equation \eqref{eq:n2_defPhi}.}
Example \ref{ex:n2_flowthroughHole} highlights the importance of the requirement in proposition \ref{pr:n2_negativeResult} that the domain be simply connected.
We now give a similar example, this time with two holes in the domain and two interior stagnation points.

\begin{example}[Flow through tube with two holes and stagnation points]
  We consider the stream function
  \begin{equation}
    \begin{aligned}
    \psi\colon\R^2\setminus\brk[c]*{-e_1,e_1}&\to\R \\
    x&\mapsto\Phi_2\brk*{x-e_1}-\Phi_2\brk*{x+e_1}+x_1
    \end{aligned}\label{eq:n2:hvf:noInflowNoOutflow:doubleHoles}
  \end{equation}
  A plot of the streamlines in figure \ref{pl:n2_hvf_InflowOutflow_symmetric_region} indicates that $u=\nabla^\perp\psi$ 
  on the domain
  $$X=\psi^{-1}\brk*{[-0.7,0.7]}\cap \brk*{\R\times[-2,2]}$$
  has the desired properties.
  \begin{figure}
    \centering
    \includegraphics[width=0.6\textwidth]{../Plots/HarmonicVectorFields_gr2.eps}
    \caption{A plot of $u=\nabla^\perp\psi$ in the region $\psi^{-1}\brk*{[-0.7,0.7]}\cap \brk*{\R\times[-2,2]}$.
    Here $\psi$ is given by equation \eqref{eq:n2:hvf:noInflowNoOutflow:doubleHoles}.}
    \label{pl:n2_hvf_InflowOutflow_symmetric_region}
  \end{figure}
\end{example}

\section{The case of $d=4$ dimensions}

We ask whether there exists a harmonic vector field on a simply connected domain with connected entrant boundary and with interior stagnation point 
in a dimension higher than $d=2$. Indeed, in $d=4$ dimensions we can readily give an example
of such a harmonic vector field.
\begin{example}[Connected entrant boundary in $d=4$ dimensions]\label{ex:n4}
  Consider as domain $X=B_1\subseteq\R^4$ the unit ball and
  the harmonic function 
  \begin{equation}
    \begin{aligned}
    f\colon X&\to \R \\
    x &\mapsto x_1^2+x_2^2-x_3^2-x_4^2\,.
    \end{aligned}
    \label{eq:n4_deff}
  \end{equation}
  This has a critical point at the origin.
  We will show in proposition \ref{pr:n4_connectedBd} that the entrant boundary $\Sigma^-$ is
  in fact connected.
\end{example}

\begin{proposition}[Simply connected entry boundary in example \ref{ex:n4}]\label{pr:n4_connectedBd}
  The harmonic function given by equation \eqref{eq:n4_deff} has simply connected entrant boundary.
\end{proposition}
\begin{proof}
  First observe that the boundary $\Sigma=S^3$ can be away from the equator locally parametrised by the coordinates $\barx = (x_2,x_3,x_4)$
  for which we have $\abs{\barx}\leq 1$. By the condition
  \begin{align}
    \sum_i x_i^2 = 1\label{eq:n4:ball}
  \end{align}
  on the boundary $\Sigma=S^3$ we have that $x_1$ is then uniquely determined up to sign.
  Thus we have have defined parametrisations
  \begin{align}
    \begin{aligned}\phi_\pm\colon \R^3\supseteq B_1&\to \Sigma\subseteq\R^4 \\
    \barx&\mapsto x=\brk*{x_1,\barx}\text{ such that } \pm x_1\geq0
    \end{aligned}\label{eq:n4:parametrisation}
  \end{align}
  with inverses $\psi_\pm = \brk*{\phi_\pm}^{-1}$.
  We now calculate the gradient of $f$
  \begin{align*}
    \nabla f = 2\vect{x_1 & x_2 & -x_3 & -x_4}^\top
  \end{align*}
  and the outer unit normal to the boundary $\Sigma$ is given by
  \begin{align*}
    n = \vect{x_1 & \cdots & x_4}^\top\,.
  \end{align*}
  Thus we have $x\in\Sigma^\pm$ iff
  \begin{align*}
    0<\pm \nabla f\cdot n = \pm 2\brk*{x_1^2+x_2^2-x_3^2-x_4^2}\,.
  \end{align*}
  Using condition \eqref{eq:n4:ball} we obtain the equivalent condition
  \begin{align*}
    0<\pm 1-2\brk*{x_3^2+x_4^2}
  \end{align*}
  Define the cylinder
  \begin{align*}
    C = \brk[c]*{\barx\in \R^3\colon x_3^2+x_4^2<1/2} = \R\times B_{1/\sqrt{2}}\subseteq\R^3
  \end{align*}
  If we return to our parametrisation \eqref{eq:n4:parametrisation} we see that we have $\barx\in B_1\cap C$ iff
  $\phi_\pm(\barx)\in \Sigma^+$ and hence 
  \begin{align*}
    B_1\cap C=\psi_\pm\brk*{\Sigma^+}
  \end{align*}
  and 
  \begin{align*}
    B_1\setminus C=\psi_\pm\brk*{\Sigma^-}\,.
  \end{align*}
  Since $\phi_+$ is a homeomorphism onto the northern hemisphere and
  $\phi_-$ a homeomorphism onto the southern hemisphere and the surface $S^2$
  corresponds to the equatorial sphere the claim then follows.
  The situation is depicted in figure \ref{fi:n4_sigma}.
  \begin{figure}[h]
    \centering
    \def\svgwidth{0.7\textwidth}
    \input{../Figures/n4_sigma.pdf_tex}
    \caption{Visualisation of the situation in the proof of proposition \ref{pr:n4_connectedBd}.}
    \label{fi:n4_sigma}
  \end{figure}
\end{proof}



\chapter{Connected entrant boundaries in $\R^3$}
\label{ch:n3_inflowOutflow}

In the following chapter we will discuss question \ref{qu:flowthroughStagnationPoint} in the case of $d=3$ dimensions.
That is, we are looking for a harmonic function with interior stagnation point on a simply connected domain and connected entrant boundary.
We will first give a negative answer in the case of a cylinder.
After that we will use Morse theory to essentially argue that the number of interior stagnation points
of such an example must be an even number.
Finally we will give an example of a function and a domain with the desired properties.

\section{A negative result for the cylinder}

The following proof comes from \cite{Wahlen2023} and is a negative answer to question \ref{qu:flowthroughStagnationPoint}
for the cylinder.
\begin{proposition}\label{pr:n3_inflowOutflowCylinder}
  Let $X=[0,1]\times \overline{U}\subseteq\R^3$ be a cylinder where $U\subseteq\R^2$ is an open set.
  Let further $f\colon X\to\R$ be
  harmonic such that the sides
  $[0,1]\times \partial U=\Sigma^0$ are the tangential boundary,
  the lid $\brk[c]{0}\times U=\Sigma^+$ is the entrant boundary and
  the lid $\brk[c]{1}\times U=\Sigma^-$ is the emergent boundary. 
  Then $f$ cannot have an interior critical point.
\end{proposition}
\begin{proof}
  Assume not. Since
  \begin{align*}
    \Delta(\partial_1f)=\partial_1(\Delta f)=0
  \end{align*}
  we have by the maximum principle that $\partial_1 f$ attains its minimum on the boundary $\Sigma$. Since $\partial_1 f(x)=0$ for some interior point 
  by assumption and $\partial_1 f>0$ on the lids $\brk[c]{x_1=0}\cup\brk[c]{x_1=1}$ there exists a point
  $x\in(0,1)\times \partial U$ such that $\partial_1f(x)$ is minimal on $X$. But then we have by Hopf's lemma
  that
  \begin{align*}
    0<\nabla (\partial_1f)\cdot n=\partial_1(\nabla f\cdot n)=0\,,
  \end{align*}
  a contradiction.
\end{proof}

\section{A condition on the interior type numbers}

Mimicking the proof of proposition \ref{pr:n2_negativeResult} in two dimensions we obtain a condition on the type numbers for a harmonic function with interior
stagnation point and simply connected entrant boundary.
\begin{proposition}\label{pr:n3_inflowOutflowRels}
  Let $X\subset\R^3$ be a compact manifold with corners.
  Let $f\colon X\to\R$ be a Morse harmonic function. Assume that the strictly entrant boundary $\Sigma^-$ is non-empty and simply connected
  and that $\gamma=\partial\Sigma^-$ is a one-dimensional manifold with corners homeomorphic to the circle $S^1\subseteq\R^2$.
  Then we have that
  \begin{align*}
    M_1-M_2=0\,.
  \end{align*}
\end{proposition}
\begin{proof}
  As in the two dimensional case we split the domain $X$ with a surface $\Gamma$ such that
  $\partial\Gamma=\gamma=\partial\Sigma^-$.
  Denote the two arising domains by $X^+$ and $X^-$ where $\partial X^-\cap\Sigma^+\subseteq\gamma$ and
  $\partial X^+\cap \Sigma^-\subseteq\gamma$.
  Since by proposition \ref{pr:finiteness_critical_points} there are finitely many interior critical points in $X$
  we can also assume that no interior critical points lie on $\Gamma$.
  Furthermore we assume that $\Gamma$ approaches $\gamma$ at a slanted angle.
  For the following argumentation we require that $f$ is strongly Morse on both $X^+$ and
  $X^-$ so assume for a moment that this is the case.
  By assumption we have that $\gamma$ is homeomorphic to the circle $\R/\Z$.
  Since $f$ is non-degenerate the
  the number of maxima and minima of $f$ on $\gamma$ must be equal and thus
  \begin{align}
    \ind_{\gamma^+,0}(f)+\ind_{\gamma^-,1}(-f)=\ind_{\gamma^+,1}(f)+\ind_{\gamma^-,0}(-f)
    \label{eq:n3_disproof_morse_maxMinRel}
  \end{align}
  % \begin{align}
  %   \ind_{\gamma^+,0}(f)+\ind_{\gamma^-,1}(-f)=2l
  % \end{align}
  % for some $l\in\N$.\ruggedtodo{elaborate this}
  We now turn our attention to $X^+$. Since no essential critical points lie on $\Sigma^+$ 
  it follows for the boundary type numbers that
  \begin{align}
    \mu^+_k=\ind_{\Gamma^+, k}(f)+\ind_{\gamma^+,k}(f)\,.\label{eq:n3_disproof_morse_muplus}
  \end{align}
  Analogously we have on $X^-$ that
  \begin{align}
    \nu^-_k=\ind_{\Gamma^-,k}(-f)+\ind_{\gamma^-,k}(-f)\,.\label{eq:n3_disproof_morse_numinus}
  \end{align}
  In addition we have that the emergent critical points on $\Gamma=\Gamma^+$ of $f$ on $X^+$ are the
  entrant critical points on $\Gamma=\Gamma^-$ of $-f$ on $X^-$, that is
  \begin{equation}
    \begin{aligned}
      \ind_{\Gamma^+,0}(f)&=\ind_{\Gamma^-,2}(-f) \\
      \ind_{\Gamma^+,1}(f)&=\ind_{\Gamma^-,1}(-f) \\
      \ind_{\Gamma^+,2}(f)&=\ind_{\Gamma^-,0}(-f)\label{eq:n3_disproof_morse_relationIndex} 
    \end{aligned}\,.
  \end{equation}
  Using equations \eqref{eq:n3_disproof_morse_muplus}, \eqref{eq:n3_disproof_morse_numinus} and \eqref{eq:n3_disproof_morse_relationIndex}
  we obtain
  \begin{equation}
    \begin{aligned}
      \mu^+_0-\nu^-_2&=\ind_{\gamma^+,0}(f) \\
      \mu^+_1-\nu^-_1&=\ind_{\gamma^+,1}(f)-\ind_{\gamma^-,1}(-f) \\
      \mu^+_2-\nu^-_0&=-\ind_{\gamma^-,0}(-f)
    \end{aligned}\,.\label{eq:n3_disproof_morse_relationMuNu}
  \end{equation}
  We observe the Morse inequalities for $f$
  \begin{align}
    M_2^++\mu^+_2-M_1^+-\mu^+_1+\mu^+_0=\chi(X^+)=\chi(X)\,.\label{eq:n3_disproof_morse_morseineqplus}
  \end{align}
  and the Morse inequalities for $-f$
  \begin{align}
    M_1^-+\nu^-_2-M_2^--\nu^-_1+\nu^-_0=\chi(X^-)=\chi(X)\label{eq:n3_disproof_morse_morseineqminus}
  \end{align}
  where the $M_k$ continue to denote the interior type numbers of $f$.
  We now subtract equation \eqref{eq:n3_disproof_morse_morseineqminus} from \eqref{eq:n3_disproof_morse_morseineqplus}
  and insert relations \eqref{eq:n3_disproof_morse_relationMuNu} to obtain
  then with equation \eqref{eq:n3_disproof_morse_maxMinRel}
  \begin{align*}
    0&=M_1^--M_2^-+M_1^+-M_2^++\ind_{\gamma^+,0}(f)+\ind_{\gamma^-,1}(-f)-\ind_{\gamma^+,1}(f)-\ind_{\gamma^-,0}(-f) \\
    &= M_1-M_2
  \end{align*}
  from which the claim follows.


  The claim remains to be shown in the case that $f$ is not strongly Morse on $X^+$ and $X^-$. In this case let
  $E^+,E^-\subseteq B_\delta$ be as in corollary \ref{co:density_boundaryGeneric} applied separately to the domains $X^+$ and $X^-$.
  Since $E^\pm$ are residual in $B_\delta$ we can in particular pick a $\e\in E^+\cap E^-$ by the Baire category theorem.
  Since $x_1$, $x_2$ are non-degenerate critical points of $f$
  due to the slanted angle at which
  $\Gamma$ approaches $\gamma$
  we obtain that
  \begin{align*}
    \ind_{\gamma,k}\brk*{f^\e}=\ind_{\gamma,k}(f)\qquad\text{ and }\qquad 
    \ind_{\gamma,k}\brk*{-f^\e}=\ind_{\gamma,k}(-f)
    % \label{eq:n3_disproof_morse_indexApprox}
  \end{align*}
  By the same corollary we can assume that $f^\e$ has no essential critical points on
  $\Sigma^+(f)$ and $-f^\e$ has no essential critical points on $\Sigma^-(f)$.
  The claim then follows by the calculations above where we replace
  $f$ with $f^\e$ and then note that $M_1^\e=M_1$ and $M_2^\e=M_2$.
\end{proof}


\section{THE example}

Based on example \ref{ex:n4} in $d=4$ dimensions of a harmonic vector field with interior stagnation point
the author argued that it would be simplest to construct such a vector field in $d=3$ dimensions in a similar manner.
More specifically we choose as domain the ball and polynomials as our harmonic function. 
In choosing the ball as domain we also take into account the result from proposition \ref{pr:n3_inflowOutflowCylinder}
which is a negative result to question \ref{qu:flowthroughStagnationPoint} for the cylinder.
Based on the result from proposition \ref{pr:n3_inflowOutflowRels} we see that the number of stagnation
points must be at least two.
The author then implemented a Mathematica routine to generate harmonic polynomials
with two stagnation points and a plotting function to inspect what occurs.
Indeed, this approach yielded a function with the desired properties as
we shall discuss in this section.
\begin{example}[A harmonic function with interior critical point and simply connected entrant boundary]
  \label{ex:n3_polynomial_defn}
  Consider the domain $X=\overline{B}_r\subseteq\R^3$ with $r>0$ sufficiently large, and the harmonic function
  \begin{align}
    \begin{aligned}
    f\colon X&\to\R \\
    x&\mapsto \frac{x_1^2}{2}-\frac{x_1^3}{3}-\frac{x_2^2}{2}+x_1x_2^2+x_2x_3
    \end{aligned}
    \label{eq:n3_polynomial_defnf}
  \end{align}
  This induces the harmonic vector field
  \begin{align*}
    u\colon X&\to\R^3 \\
    x&\mapsto\nabla f(x)=\vect{x_1(1-x_1)+x_2^2 \\
      x_2(2x_1-1)+x_3 \\
      x_2}
  \end{align*}
  It follows from setting $u(x)=0$ that $x_2=0$
  and then $x_3=0$ and $x_1\in\brk[c]*{0,1}$. Thus we have that $x\in\brk[c]*{0,e_1}$
  are the sole possible zeroes of $u$. Conversely one sees that these are zeroes of $u$.
  Hence $f$ has two interior critical points for $r>1$.
  Figure \ref{pl:n3_hf_inflowOutflowStagnationPoint_overview}
  shows a stream plot of $u$ with the two interior stagnation points highlighted as black dots.
  The boundary of the domain is shaded in blue for $\Sigma^-$ and in red for $\Sigma^+$.
  The stereographic projection of the boundary is plotted in figure \ref{pl:n3_hf_inflowOutflowStagnationPoint_Surface}.
  This plot indicates that the entrant boundary and the emergent boundary are simply connected.
  Indeed, we will show this in theorem \ref{th:n3_polynomial_connectedInflowOutflow}.
  \begin{figure}
    \centering
    \includegraphics[width=0.6\textwidth]{../plots/n3_hf_inflowOutflow_Ball_overview.pdf}
    \caption{A stream plot of the function $u$. The interior stagnation points are highlighted in black.
    $\Sigma^+$ is shaded red, $\Sigma^-$ blue.}
    \label{pl:n3_hf_inflowOutflowStagnationPoint_overview}
  \end{figure}
  \begin{figure}
    \centering
    \includegraphics[width=0.6\textwidth]{../plots/n3_hf_inflowOutflow_Ball_Surface.pdf}
    \caption{Stereographic projection of the surface $\Sigma$. $\Sigma^+$ is shaded red, $\Sigma^-$ blue.}
    \label{pl:n3_hf_inflowOutflowStagnationPoint_Surface}
  \end{figure}
  % We will give a formal proof of this in proposition \ref{pr:n3_polynomial_simplyConnected}.
\end{example}

The remainder of this section will be devoted to the proof of the following theorem:
\begin{theorem}\label{th:n3_polynomial_connectedInflowOutflow}
  The harmonic function given by equation \eqref{eq:n3_polynomial_defnf} on the sphere
  has interior stagnation points and connected emergent and entrant
  boundaries for sufficiently large $r>0$.
\end{theorem}

Before we proceed to the proof we require some definitions from algebraic geometry.
For an introduction this subject we refer the reader to \cite{Gathmann2023}, \cite{Harris1992} or \cite{Hartshorne1977}.
For polynomials $p_1,\dots,p_k\in\R\brk[s]*{x_1,\dots,x_d}$ and a set $U\subseteq\R^d$ we denote the
variety generated by these polynomials on $U$ by $V_U\brk*{p_1,\dots,p_k}$.
In the case that $U=\R^d$ we write $V(\dots)=V_U(\dots)$.
\begin{definition}[Smoothness, {\cite[§5]{Hartshorne1977}}]
  We call a $k$ dimensional algebraic variety $V_U\brk*{p_1,\dots,p_n}$ \emph{smooth} or \emph{non-singular}
  if the the Jacobian
  \begin{align*}
    \begin{bmatrix}
      \nabla p_1 & \cdots & \nabla p_n
    \end{bmatrix}^\top
  \end{align*}
  is of rank $d-k$ on $V_U\brk*{p_1,\dots,p_n}$. This criterion of smoothness is also called the
  \emph{Jacobi criterion}. By the implicit function theorem this means that the variety $V_U\brk*{p_1,\dots,p_n}$
  in fact defines a $d-k$ dimensional submanifold of $\R^d$.
\end{definition}
\nomenclature{$V_U\brk*{\dots}$, $V\brk*{\dots}$}{Algebraic variety.}

The proof of theorem \ref{th:n3_polynomial_connectedInflowOutflow} requires lemmas \ref{pr:n3_polynomial_smoothness} and \ref{pr:n3_polynomial_smoothConnected}
which we will show later on.
\begin{proof}[Proof of theorem {\ref{th:n3_polynomial_connectedInflowOutflow}}]
  It was already discussed in example \ref{ex:n3_polynomial_defn} that $f$ has an interior critical point at the
  origin and is harmonic.
  For the connectedness of the entrant and emergent boundaries we calculate
  \begin{align}
    rn\cdot u(x) = x_1^2(1-x_1)+x_2^2(3x_1-1)+2x_2x_3\rightdef p_1(x)\label{eq:n3_polynomial_defp1}
  \end{align}
  and define further
  \begin{align}
    P_2(r,x)\leftdef x_1^2+x_2^2+x_3^2-r^2\,.\label{eq:n3_polynomial_defP2}
  \end{align}
  Thus we have that the tangential boundary $\Sigma^0=V\brk*{p_1,P_2(r,\cdot)}$
  is precisely the variety generated by the polynomials $p_1$ and $P_2(r,\cdot)$ for a
  fixed radius $r>0$.
  In lemma \ref{pr:n3_polynomial_smoothness} we will show that the variety $V\brk*{p_1,P_2(r,\cdot)}$ is in fact smooth
  and in lemma \ref{pr:n3_polynomial_smoothConnected} we will then show that it is in fact connected.
  Thus $\Sigma^0$ then defines a simple closed curve on $\Sigma$
  and the stereographic projection of $\Sigma^0$ defines a simple closed planar curve.
  This is indicated by the black curve in figure \ref{pl:n3_hf_inflowOutflowStagnationPoint_Surface}.
  By the Jordan curve theorem this curve then splits the plane into two connected regions, 
  one of which is simply connected.
  The preimage of these connected regions under the stereographic projections then corresponds
  precisely to the entrant and emergent boundaries.
  From this it follows that the entrant and emergent
  boundaries are simply connected which proves the theorem.
\end{proof}

From now onwards we assume that $p_1$ and $P_2$ are given by equations \ref{eq:n3_polynomial_defp1} and \ref{eq:n3_polynomial_defP2}.
We first show the smoothness which was required in the proof of theorem \ref{th:n3_polynomial_connectedInflowOutflow}.
\begin{lemma}[Smoothness]\label{pr:n3_polynomial_smoothness}
  There exists $R>0$ such that for every $r>R$ the variety $V\brk*{p_1,P_2\brk*{r,\cdot}}$ is smooth.
\end{lemma}
\begin{proof}
  One calculates
  \begin{align*}
    T\leftdef\vect{\nabla p_1(x)&\frac{1}{2}\nabla_x P_2(r,x)}=
    \begin{bmatrix}
      -3x_1^2+3x_2^2+2x_1 & x_1\\
      6x_1x_2-2x_2+2x_3&x_2 \\
      2x_2&x_3
    \end{bmatrix}
  \end{align*}
  By the Jacobi criterion it is sufficient to show that this matrix is
  of full rank on $V\brk*{p_1,P_2\brk*{r,\cdot}}$.
  This is equivalent to showing that
  \begin{align*}
    0&\neq \det\begin{bmatrix}
      T_{11}&T_{12}\\T_{21}&T_{22}
    \end{bmatrix}
    =-9x_1^2x_2+3x_2^3+4x_1x_2-2x_1x_3
    \rightdef h_1(x)\,, \\
    0&\neq \det\begin{bmatrix}
      T_{21}&T_{22}\\T_{31}&T_{32}
    \end{bmatrix}
    =6x_1x_2x_3-2x_2x_3+2x_3^2-2x_2^2
    \rightdef h_2(x)\text{ or } \\
    0&\neq \det\begin{bmatrix}
      T_{31}&T_{32}\\T_{11}&T_{12}
    \end{bmatrix}
    =2x_1x_2+3x_1^2x_3-3x_2^2x_3-2x_1x_3
    \rightdef h_3(x)
  \end{align*}
  for any $x\in V\brk*{p_1,P_2\brk*{r,\cdot}}$. This in turn is equivalent to showing that
  \begin{align}
    V\brk*{p_1,P_2\brk*{r,\cdot},h_1,h_2,h_3}=\emptyset\,.\label{eq:n3_ex_smoothness_varCond}
  \end{align}
  Indeed, consider the variety
  \begin{align}
    V\brk*{p_1,h_1,h_2,h_3}\,. \label{eq:n3_ex_smoothness_subvar}
  \end{align}
  Maple calculates the Gröbner basis with lexicographic order $x_1<x_2<x_3$
  \begin{align}
    & 72x_1^8 - 198x_1^7 + 228x_1^6 - 153x_1^5 + 56x_1^4 - 5x_1^3\,,\label{eq:n3_ex_smoothness_pol1} \\
    & 72x_1^5x_2 - 126x_1^4x_2 + 102x_1^3x_2 - 51x_1^2x_2 + 5x_1x_2\,, \label{eq:n3_ex_smoothness_pol2}\\
    & -24x_1^7 + 42x_1^6 - 2x_1^5 - 23x_1^4 + 7x_1^3 + 10x_1x_2^2\,, \label{eq:n3_ex_smoothness_pol3} \\
    & 48x_1^4x_2 - 60x_1^3x_2 + 13x_1^2x_2 + 15x_2^3\,, \\
    & 24x_1^4x_2 - 30x_1^3x_2 + 29x_1^2x_2 - 10x_1x_2 + 5x_1x_3\,, \\
    & 72x_1^7 - 126x_1^6 + 6x_1^5 + 69x_1^4 - 31x_1^3 + 10x_1^2 - 10x_2^2 + 20x_2x_3\,, \\
    & -72x_1^7 + 414x_1^6 - 654x_1^5 + 399x_1^4 - 97x_1^3 + 10x_1^2 - 30x_2^2 + 20x_3^2\,.\label{eq:n3_ex_smoothness_poln}
  \end{align}
  For an introduction to Gröbner bases we refer the reader to for example \cite{Cox2015}.
  We will however only use the fact that the polynomials \eqref{eq:n3_ex_smoothness_pol1}-\eqref{eq:n3_ex_smoothness_poln}
  generate the variety \eqref{eq:n3_ex_smoothness_subvar}.
  We see from the basis vector \eqref{eq:n3_ex_smoothness_pol1} that
  for $x\in V\brk*{p_1,h_1,h_2,h_3}$ the coordinate $x_1$ can take only finitely many values.
  It then follows with \eqref{eq:n3_ex_smoothness_pol2} that also $x_2$ can take only finitely many values
  and finally with \eqref{eq:n3_ex_smoothness_pol3} that $x_3$ can also take only finitely many values.
  So the variety \eqref{eq:n3_ex_smoothness_subvar} contains finitely many points.
  Thus if we choose $R$ so large that all of these points are contained in the ball $B_R$ then we have
  that \eqref{eq:n3_ex_smoothness_varCond} holds for all $r>R$.
\end{proof}
  % We will show this in two steps. 
  % First we claim that for any $\eta>0$ we have
  % \begin{align}
  %   V\brk*{P,Q,R_1,R_2,R_3}\setminus C_\eta^r=\emptyset\,
  %   \label{eq:n3_ex_smoothness_step1}
  % \end{align}
  % for $r$ sufficiently large. 
  % Since the homogeneous parts of maximal degree satisfy
  % \begin{align*}
  %   \brk*{P}_3&=-x_1^3+x_1x_2^2=x_1(x_2^2-x_1^2) \\
  %   \brk*{R_1}_3&=-5x_1^2x_2+x_2^3=x_2(x_2^2-5x_1^2) \\
  %   \brk*{R_2}_3&=2x_1x_2x_3 \\
  %   \brk*{R_3}_3&=3x_1^2x_3-x_2^2x_3=x_3(3x_1^2-x_2^2)
  % \end{align*}
  % we obtain for the variety
  % \begin{align}
  %   V\brk*{\brk*{P}_3,\brk*{R_1}_3,\brk*{R_2}_3,\brk*{R_3}_3}=\R e_3
  %   \label{eq:n3_3x_smoothness_homogVar}
  % \end{align}
  % Now observe that we have for $x\in C_\eta^1$ that
  % \begin{align*}
  %   \frac{1}{r^6}\brk*{P^2+\sum_jR_j^2}\brk*{rx}
  %   =\underbrace{\brk*{\brk*{P}_3^2+\sum_j\brk*{R_j}_3^2}}_{>0\text{ on }C_\eta^1\text{ by }\eqref{eq:n3_3x_smoothness_homogVar}}\brk*{x}+\bigO\brk*{\frac{1}{r}}
  % \end{align*}
  % and thus for $r$ sufficiently large equation \eqref{eq:n3_ex_smoothness_step1} does indeed hold.
  % We now claim that $\neq0$ on $V(Q)\setminus B_{r\eta}\brk*{re_3}$ for $r$ sufficiently large.
  % To show this, observe that for $x\in C_\eta^1$ we have
  % \begin{align*}
  %   \frac{1}{r^3}R_1\brk*{rx}=\underbrace{\brk*{R_1}_3\brk*{x}}_{\neq0\text{ for }rx\notin\tubular_\eta\brk*{\R e_3}}+\bigO\brk*{\frac{1}{r}}
  % \end{align*}
  % and thus for $r$ sufficiently large we indeed have $R_1\neq0$ on the desired set.
  % Analogous argumentation with $R_2$, $R_3$ and $P$ yield .

  % We now show for any sufficiently small $\eta>0$ we have that
  % \begin{align*}
  %   V\brk*{P,Q,R_1,R_2,R_3}\cap B_{r\eta}\brk*{re_3}=\emptyset
  % \end{align*}
  % for all sufficiently large $r$.
  % For this we inspect 

  % In the second part we show that
  % \begin{align*}
  %   V\brk*{P,Q,R_1,R_2,R_3}\cap \tubular_\eta\brk*{\R e_3}=\emptyset
  % \end{align*}
  % for sufficiently large $r$.
  % For this note that for $x\in S^2\cap\tubular_{\eta/r}\brk*{\R e_3}$ we have
  % \begin{align*}
  %   \frac{1}{r^2}R_2(rx)=\underbrace{2x_3^2}_{>1\text{ for }r\text{ large}}+\bigO\brk*{\frac{1}{r}}
  % \end{align*}
  % from which this claim also follows.


% \begin{proposition}\label{pr:n3_polynomial_simplyConnected}
%   The harmonic function given by equation \eqref{eq:n3_polynomial_defnf} has simply connected emergent and entrant boundaries.
% \end{proposition}
% \begin{proof}
%   % Consider the inverse stereographic projection given by 
%   % \begin{align*}
%   %   \psi\colon \R^2&\to B_r\setminus\brk[c]*{re_1} \\
%   %   x&\mapsto \frac{r}{s^2+1}\vect{s^2-1 \\ x}
%   % \end{align*}
%   % where $s=\abs{x}$.
%   It will be shown in proposition \ref{pr:n3_polynomial_smoothConnected} that there exists $r>0$ such that
%   $\Sigma^0$ is smooth and connected.
%   The stereographic projection
%   of $\Sigma^0$ then defines a simple closed planar curve.
%   This is indicated by the black curve in figure \ref{pl:n3_hf_inflowOutflowStagnationPoint_Surface}.
%   By the Jordan curve theorem this curve then splits the plane into two connected regions, 
%   one of which is simply connected.
%   The preimage of these connected regions under the stereographic projections then corresponds
%   precisely to the entrant and emergent boundaries from which the claim follows.
% \end{proof}
  % If we precompose with the inverse stereographic projection we obtain
  % \begin{align*}
  %   &\brk*{rn\cdot u}\circ\psi (x) \\
  %   &= \frac{r^2}{\brk*{s^2+1}^3}\brk*{\brk*{s^2-1}^2\brk*{\brk*{s^2+1}-r\brk*{s^2-1}}+x_1^2\brk*{3r\brk*{s^2-1}-\brk*{s^2+1}}+2x_1\brk*{s^2+1}x_2}
  % \end{align*}
  % which vanishes precisely iff
  % \begin{align*}
  %   0&=\frac{1}{r}\brk*{s^2-1}^2\brk*{\brk*{s^2+1}-\brk*{s^2-1}}+x_1^2\brk*{3\brk*{s^2-1}-\frac{1}{r}\brk*{s^2+1}}+\frac{1}{r}2x_1\brk*{s^2+1}x_2 \\
  %   &=\frac{1}{r}\brk*{s^2+1}\brk*{\brk*{s^2-1}^2-x_1^2}-\brk*{s^2-1}^3+3\brk*{s^2-1}x_1^2+\frac{1}{r}2x_1x_2\brk*{s^2+1}
  % \end{align*}
  % Writing $\e=1/r$ and setting
  % \begin{align*}
  %   p^\e(x)=\e\brk*{\brk*{s^2+1}\brk*{\brk*{s^2-1}^2-x_1^2}+2x_1x_2\brk*{s^2+1}}-\brk*{s^2-1}^3+3\brk*{s^2-1}x_1^2
  % \end{align*}
  % we see that this is equivalent to the condition $p^\e(x)=0$.

  % It then follows from the Jordan curve theorem that this variety splits the plane into two components, namely one where 
  % $p^\e$ is positive and one where it is negative. The image of these sets under the stereographic projection is then precisely
  % $\Sigma^+$ and $\Sigma^-$ respectively and it follows that these sets are simply connected.

  % we also calculate for this part
  % \begin{align*}
  %   \nabla q_1(x)=2\vect{3x_1^2x_2 + x_1x_2^2 + x_2^3 - x_1 + x_2 \\ x_1^3 + x_1^2x_2 + 3x_1x_2^2 + 2x_2^3 + x_1}
  % \end{align*}
  % and
  % \begin{align*}
  %   D^2q_1(x)=2\begin{bmatrix}
  %     6x_1x_2 + x_2^2 - 1 & 3x_1^2 + 2x_1x_2 + 3x_2^2 + 1 \\
  %     *& x_1^2 + 6x_1x_2 + 6x_2^2
  %   \end{bmatrix}
  % \end{align*}
  % Now notice that we have around the point $\pm e_2$ that
  % \begin{align*}
  %   D^2q_1(\pm e_2)=2\begin{bmatrix}
  %     0 & 4 \\
  %     4 & 6
  %   \end{bmatrix}
  % \end{align*}
  % which is of full rank. 

  % \begin{align*}
  %   \psi\colon \R^2&\to B_r\setminus\brk[c]*{re_3} \\
  %   x&\mapsto \frac{r}{s^2+1}\vect{x \\ s^2-1}
  % \end{align*}
  % where $s=\abs{x}$. We calculate
  % \begin{align*}
  %   rn\cdot u(x) = x_1^2(1-x_1)+x_2^2(3x_1-1)+2x_2x_3
  % \end{align*}
  % If we now precompose with the inverse stereographic projection we obtain
  % \begin{align*}
  %   &\brk*{rn\cdot u}\circ\psi (x) \\
  %   &= \frac{r^2}{\brk*{s^2+1}^3}\brk*{x_1^2\brk*{\brk*{s^2+1}-rx_1}+x_2^2\brk*{3rx_1-\brk*{s^2+1}}+2x_2\brk*{s^2+1}\brk*{s^2-1}}
  % \end{align*}
  % which vanishes precisely iff
  % \begin{align}
  %   0&=x_1^2\brk*{\brk*{s^2+1}-rx_1}+x_2^2\brk*{3rx_1-\brk*{s^2+1}}+2x_2\brk*{s^2+1}\brk*{s^2-1} \\
  %   &=\brk*{s^2+1}\brk*{x_1^2-x_2^2}-rx_1^3+3rx_1x_2^2+2x_2\brk*{s^4-1}
  % \end{align}


We now define $p_2$ to be the dehomogenisation of $P_2$, that is
\begin{align*}
  p_2\leftdef P_2(1,\cdot)\,.
\end{align*}
Analogously let $P_1$ denote the homogenisation of $p_1$, that is
\begin{align*}
  P_1(\e,x)\leftdef\e^3p_1\brk*{x/\e}\,.
\end{align*}
By rescaling the variety $V\brk*{p_1,P_2(r,\cdot)}$ we obtain
\begin{align}
  V\brk*{p_1,P_2(r,\cdot)}=rV\brk*{x\mapsto p_1(rx),p_2}
  =rV\brk*{P_1(\e,\cdot),p_2}=r\cV_\e\label{eq:n3_polynomial_smoothConnected_relVeps}
\end{align}
where we set $\e=1/r$ and $\cV_\e\leftdef V\brk*{P_1(\e,\cdot),p_2}$. Motivated by taking the limit $r\to\infty$ we
inspect the variety $\cV_0$ closer.
The next proposition is required in the proof of lemma \ref{pr:n3_polynomial_smoothConnected}. It essentially states that the varieties
$\cV_\e\to\cV_0$ converge as $\e\to0$ outside of singular points.
We will thus also need a notion of convergence of subsets on a metric space.
\begin{definition}[Hausdorff metric, tubular neighbourhood]
  The \emph{Hausdorff metric} for two sets $A,B\subseteq X$ is given by 
  \begin{align}
    d_H\brk*{A,B}=\max\brk[c]*{\sup_{x\in A}\dist\brk*{x,B},\,\sup_{y\in B}\dist\brk*{y,A}}
    \label{eq:def_HausdorffMetric}
  \end{align}
  where
  \begin{align}
    \dist\brk*{x,B}=\inf_{y\in B}d(x,y)\label{eq:def_distance}
  \end{align}
  is the smallest distance from $x$ to $B$.
  % We also require the definition of tubular neighbourhoods.
  For a given $\delta>0$ and a subset $A\subseteq\R^d$ we call the union of $\delta$ balls
  \begin{align}
    \tubular_\delta\brk*{A}=\bigcup_{x\in A}B_\delta(x)\label{eq:def_tubularNbh}
  \end{align}
  a \emph{tubular neighbourhood} of $A$.
\end{definition}
% We have the following proposition, the proof of which will span several propositions.
\nomenclature{$d_H(A,B)$}{Hausdorff metric. See equation \eqref{eq:def_HausdorffMetric}.}
\nomenclature{$\dist(x,A)$}{Distance between $x$ and $A$. See equation \eqref{eq:def_distance}}
\nomenclature{$\tubular_\delta(A)$}{Tubular neighbourhood of $A$. See equation \eqref{eq:def_tubularNbh}.}

\begin{proposition}[Convergence of $\cV_\e$ at smooth points]\label{pr:n3_polynomial_convergenceSmoothSet}
  Let $U\subseteq \R^3$ be an open set such that $\cV_0$ is smooth
  in an open neighbourhood of $\overline{U}$. Let further $\eta>0$.
  Then there exists a $\delta>0$ such that for all $\e<\delta$ we have that the Hausdorff distance
  satisfies
  \begin{align*}
    d_H\brk*{\cV_\e\cap U,\cV_0\cap U}<\eta
  \end{align*}
  and additionally $\cV_\e\cap U$ is isotopic to $\cV_0\cap U$.
\end{proposition}
\begin{proof}
  Consider the mapping
  \begin{align*}
    F=\vect{P_1\\p_2}\colon \R^4\to\R^2\,.
  \end{align*}
  Since $V\brk*{P_1(0,\cdot),p_2}$ is smooth on an open neighbourhood of $\overline{U}$
  we have by the Jacobi criterion that
  \begin{align}
    DF(0,\cdot) = \left[\begin{array}{c|c}
        D_\e P_1(0,\cdot)&D_x P_1(0,\cdot)\\
        0&D p_2
      \end{array}\right]\label{eq:n3_polynomial_homotopic_df}
  \end{align}
  is of full rank on $\overline{U}$.
  By the implicit function theorem there exists at every point $x\in\overline{U}$ open neighbourhoods
  $\Omega_x\subseteq \R^4$ of $(0,x)$ and $\omega_x\subseteq\R^3$, a coordinate permutation $I\in O(4)$
  and a continuously differentiable mapping $g_x\colon\omega_x\to\R$ such that
  \begin{align*}
    V\brk*{P_1,p_2}\cap \Omega_x=\brk[c]*{I\brk*{y,g_x(y)}\colon y\in\omega_x}\,.
  \end{align*}
  Since $D_xF(0,x)$ is of full rank we can assume (possibly after shrinking the open sets) that $I$ does not permute the $\e$-coordinate.
  Thus we can write $y=(\e,y_1,y_2)\in\omega_x$.
  We can also assume that $\Omega_x=B_{\delta_x}\times W_x\subseteq\R^4$ for some open $W_x\subseteq\R^3$ and 
  some $\delta_x>0$.
  Hence we also obtain that $\omega_x=B_{\delta_x}\times w_x$ for some open $w_x\subseteq\R^2$ and we can define our
  isotopy on $\Omega_x$ as
  \begin{align*}
    \varphi_x\colon B_{\delta_x}\times w_x&\to W_x\\
    y&\mapsto \proj_{\R^4\to W_x}I\brk*{y,g_x\brk*{y}}\,.
  \end{align*}
  Note that $\varphi_x\brk*{\brk[c]*{\e}\times w_x}=\cV_\e\cap W_x$.
  From this it also follows that we can choose $\delta_x$
  such that
  \begin{align*}
    d_H\brk*{\cV_\e\cap W_x,\cV_0\cap W_x}<\eta\,.
  \end{align*}
  Now for $x\in\overline{U}$ the $\Omega_x$ form an open cover of $\overline{U}$.
  By compactness there exists a finite subcover.
  Set $\delta>0$ to be the minimum of all 
  $\delta_x$ for the $\Omega_x$ in this finite subcover and the claim follows.
\end{proof}

The next lemma shows the connectedness of the variety $V\brk*{p_1,P_2(r,\cdot)}$.
Because the proof is quite lengthy, a part of the proof has been split off into
proposition \ref{pr:n3_polynomial_regularH} which will be proved later on.
% In the following we assume that $\e=1/r$ if $\e>0$ and $r>0$.
% \begin{figure}
%   \centering
%   \input{../Figures/n3_polynomial_projectionDegenerate.pdf_tex}
%   \caption{A sketch of the set $V\brk*{p^0}$.}
% \end{figure}

\begin{lemma}[Connectedness]\label{pr:n3_polynomial_smoothConnected}
  There exists an $r>0$ such that the planar variety $V\brk*{p_1,P_2(r,\cdot)}$
  has one connectivity component.
\end{lemma}
\begin{proof}
  By lemma \ref{pr:n3_polynomial_smoothness} there exists a $R>0$ such that for all $r>R$ we have that the
  variety $V\brk*{p_1,P_2(r,\cdot)}$ is smooth and by equation \eqref{eq:n3_polynomial_smoothConnected_relVeps}
  $\cV_\e$ is also smooth for $\e<1/R$.
  We inspect $\cV_0$ closer.
  Observe that
  \begin{align*}
    P_1(0,x)=-x_1^3+3x_1x_2^2
  \end{align*}
  which is the monkey saddle embedded into $\R^3$. We thus define curves
  \begin{align*}
    \tialpha^\pm\leftdef\brk[c]*{t\vect{\pm\sqrt{3}&1}^\top \colon t\in\R}
  \end{align*}
  and $\tialpha^0\leftdef\brk[c]*{0}\times\R$.
  We then define $\alpha^\bullet\leftdef\brk*{\tialpha^\bullet\times\R}\cap S^2$.
  Setting $A\leftdef\alpha^-\cup\alpha^+\cup\alpha^0$
  we have the relation
  \begin{align*}
    \cV_0=V\brk*{P_1(\e,\cdot),p_2}
    =A\,.
  \end{align*}
  Thus $\cV_0$ consists of six smooth arcs originating at the singularity $e_3$ and
  ending at the singularity $-e_3$. Similar to the classical beach ball.
  Now consider for $\rho>0$ the open sets $W_\rho\leftdef B_\rho\times\R\subseteq\R^3$ and $U_\rho\leftdef\R^3\setminus W_\rho$.
  Since $\cV_0$ is smooth in a neighbourhood of $\overline{U}_\rho$ we obtain from proposition \ref{pr:n3_polynomial_convergenceSmoothSet}
  that in a certain sense $\cV_\e$ is obtained from $\cV_0$ by a small deformation on $U_\rho$.
  Thus in order to show connectedness of $\cV_\e$ for sufficiently small $\e>0$ we have to inspect what happens
  around the points $\pm e_3$.
  Now observe that we have the symmetry
  \begin{align}
    p_1(x_1,-x_2,-x_3)=p_1(x)\label{eq:n3_polynomial_smoothConnected_symmetr}
  \end{align}
  and thus it suffices to inspect what happens around the point $e_3$.
  For this parametrise the neigh\-bour\-hood $S^2\cap \brk*{B_{1/2}\times\R_{\geq0}}$
  of $e_3$
  by the diffeomorphism
  \begin{align*}
    \psi\colon B_{1/2}&\to S^2\cap \brk*{B_{1/2}\times\R_{\geq0}}\\
    \tix&\mapsto x=\vect{\tix&\sqrt{1-\abs{\tix}^2}}^\top\,.
  \end{align*}
  We set
  \begin{align*}
    \widetilde{\cV}_\e\leftdef\psi^{-1}\brk*{\cV_\e\cap \brk*{B_{1/2}\times\R_{\geq0}}}
    =V_{B_{1/2}}\brk*{x\mapsto P_1\brk*{\e,x_1,x_2,\sqrt{1-x_1^2-x_2^2}}}
    =V_{B_{1/2}}\brk*{\tiP_1\brk*{\e,\cdot}}
  \end{align*}
  where we defined
  \begin{align*}
    \tiP_1(\e,x)\leftdef P_1\brk*{\e,x_1,x_2,\sqrt{1-x_1^2-x_2^2}}
    =-x_1^3+3x_1x_2^2+\e\brk*{x_1^2-x_2^2+x_2\sqrt{1-x_1^2-x_2^2}}\,.
  \end{align*}
  In a similar manner we define $\tialpha^\bullet\leftdef\psi^{-1}\brk*{\alpha^\bullet}$, $\tiU_\rho\leftdef\psi^{-1}\brk*{U_\rho}$,
  $\tiW_\rho\leftdef\psi^{-1}\brk*{W_\rho}$
  and $\tiA\leftdef\psi^{-1}\brk*{A}$.
  Now let the sets $W$ and $C\subseteq W$ be as in proposition \ref{pr:n3_polynomial_regularH}.
  Pick $\rho>0$ so small that $\tiW_{2\rho}\subseteq W$. 
  Now we can pick $\eta$ smaller than the minimum distance between two arcs of $\widetilde{\cV_0}$ on $\tiU_{\rho}$.
  We also assume that $\eta$ is smaller than the Hausdorff distance between $\brk*{\tialpha^0\cup\tialpha^-}\cap\tiU_\rho$
  and $C$.
  Now choose $\delta$ as in proposition \ref{pr:n3_polynomial_convergenceSmoothSet}. We can assume that $0<\e<\delta$.
  We thus have a situation as in figure \ref{fi:n3_polynomial_arcOverview}.
  \begin{figure}
    \centering
    \input{../Figures/n3_polynomial_arcOverview.pdf_tex}
    \caption{An overview of the situation around $e_3$.}
    \label{fi:n3_polynomial_arcOverview}
  \end{figure}
  \begin{figure}
    \centering
    \input{../Figures/n3_polynomial_arcNumbering.pdf_tex}
    \caption{The numbering of the arcs around $e_3$.}
    \label{fi:n3_polynomial_arcNumbering}
  \end{figure}
  \begin{figure}
    \centering
    \input{../Figures/n3_polynomial_arcConnections.pdf_tex}
    \caption{The connection of the arcs at $\pm e_3$.}
    \label{fi:n3_polynomial_arcConnections}
  \end{figure}
  Number the arcs lying close to $A\cap U_\rho$ as in figure \ref{fi:n3_polynomial_arcNumbering}.
  Since $\tigamma$ by proposition \ref{pr:n3_polynomial_regularH} splits $\tiW_{2\rho}$ and lies in $C\cap\widetilde{\cV}_\e$ we must have that
  $\tigamma$ in fact connects arcs 3 and 6.
  As the variety is smooth we must also have that arcs 1 and 2 are connected
  and analogously that arcs 4 and 5 are connected.
  By equation \eqref{eq:n3_polynomial_smoothConnected_symmetr} the situation around $-e_3$ is analogous but mirrored.
  We thus obtain analogous connections between the six arcs at $-e_3$ which is summarised in figure \ref{fi:n3_polynomial_arcConnections}.
  Thus we in fact have that $\cV_\e$ is connected.
  The claim then follows from relation \eqref{eq:n3_polynomial_smoothConnected_relVeps}.
\end{proof}

The following proposition is part of the proof of lemma \ref{pr:n3_polynomial_smoothConnected}:
\begin{proposition}\label{pr:n3_polynomial_regularH}
  Let $\tiU_\rho$, $\tialpha^\bullet$, $\tiA$, $\widetilde{\cV}_\e$ and $\tiP_1$ be as in the proof of lemma \ref{pr:n3_polynomial_smoothConnected}.
  There exists an open cube $W\subseteq\R^2$ containing the origin and a set 
  $C\subseteq W$ such that $C$ has positive Hausdorff distance to the set
  $\brk*{\tialpha^0\cup\tialpha^-}\cap \tiU_\rho$ for any $\rho>0$
  and such that for any sufficiently small $\e>0$ there is an arc $\tigamma$
  entirely contained in $C\cap\widetilde{\cV}_\e$ splitting $W$ into two parts.
\end{proposition}
\begin{proof}
  We borrow notation from the proof of lemma \ref{pr:n3_polynomial_smoothConnected}.
  Let $W\subseteq\R^2$ be an open cube around the origin which we fix later.
  Define polynomials
  \begin{align}
    \tiq_1(x)&\leftdef-x_1^3+3x_1x_2^2\label{eq:n3_polynomial_regularH_defq1} \\ 
    \tiq_2(x)&\leftdef x_1^2-x_2^2+x_2\sqrt{1-x_1^2-x_2^2} \label{eq:n3_polynomial_regularH_defq2}
  \end{align}
  % \begin{align*}
  %   \tip_1(x)=\tiP_1(1,x)=p_1\brk*{x_1,x_2,\sqrt{1-x_1^2-x_2^2}}
  % \end{align*}
  and observe that
  \begin{align}
    \tiP_1(\e,\cdot)=\tiq_1+\e\tiq_2\,.\label{eq:n3_polynomial_regularH_relTiP}
  \end{align}
  % Here we use $\brk*{\cdot}_k$ to refer to the parts homogeneous of degree $k$ and
  % $\brk*{\cdot}_{\leq k}$ to refer to the parts homogeneous of degree $\leq k$.
  By equation \eqref{eq:n3_polynomial_regularH_defq1} $\tiq_1$ is a monkey saddle
  and $V_W\brk*{\tiq_1}=\tiA$ is
  similar to figure \ref{fi:n3_polynomial_intersectionOriginDegenerate}.
  The signs in the figure indicate the sign of $\tiq_1$ in a given region.
  From equation \eqref{eq:n3_polynomial_regularH_defq2}
  we obtain that $\nabla \tiq_2(0)=e_2$ and $\tiq_2(0)=0$.
  Hence we observe that the $V_W\brk*{\tiq_2}$ looks similar to figure \ref{fi:n3_polynomial_intersectionOriginOtherTerm}
  for a sufficiently small neighbourhood $W$.
  More concretely we choose $W$ so small that the arc $\tibeta=V_W\brk*{\tiq_2}$ has positive distance to $\tiA\cap \tiU_\rho$ for
  any $\rho>0$ and such that a given vertical line in $W$ intersects $\tibeta$ in precisely one point.
  Now we claim that the set $C$ consisting of the vertical lines between $\tialpha^+$
  and $\tibeta$ fulfils the claim.

  We first show that there exists a curve $\tigamma$ through the origin which is
  entirely contained in $C\cap \widetilde{\cV}_\e$.
  For this note that we have $\tiP_1\brk*{\e,0}=0$ and $\nabla_x\tiP_1\brk*{\e,x}\big\vert_{x=0}=\e e_2$
  and thus there exists locally around the origin a parametrisation $\tigamma(t)=\brk*{t,\tigamma_2(t)}$.
  By a similar argument there also exists locally a parametrisation $\tibeta(t)=\brk1{t,\tibeta_2(t)}$.
  We see that $\tigamma$ lies locally below $\tialpha^+$ and thus we need to show that $\tigamma_2$ also lies locally
  above $\tibeta_2$ on the right half plane and locally below $\tibeta_2$ on the left half plane.
  We calculate derivatives
  \begin{align*}
    D\tiq_1\big\vert_{x=0}&=0 \\
    D^2\tiq_1\big\vert_{x=0}&=0 \\
    D^3\tiq_1\big\vert_{x=0}\brk*{v,v,v}&=-6v_1^3+18v_1v_2^2
  \end{align*}
  and
  \begin{align*}
    D\tiq_2\big\vert_{x=0}&=e_2^\top\\
    D^2\tiq_2\big\vert_{x=0}&=\begin{bmatrix}
      2&\\
      &-2
    \end{bmatrix} \\
    D^3\tiq_2\big\vert_{x=0}\brk*{v,v,v}&=3v_1^2v_2+v_2^3
  \end{align*}
  and now by relation \eqref{eq:n3_polynomial_regularH_relTiP}
  \begin{align}
    \begin{aligned}
    Dh\big\vert_{x=0}&=\e D_x\tiq_2\\
    D^2h\big\vert_{x=0}&=\e D_x^2\tiq_2 \\
    D^3h\big\vert_{x=0}\brk*{v,v,v}&=-6v_1^3+18v_1v_2^2+\e\brk*{3v_1^2v_2+v_2^3}
    \,.
    \end{aligned}
    \label{eq:n3_polynomial_regularH_DPDq}
  \end{align}
  where we wrote $h(x)=\tiP_1(\e,x)$ for brevity. We have $0=h\circ\tigamma$ and thus
  \begin{align}
    0=\partial_t\brk*{h\circ\tigamma}\big\vert_{t=0}=\brk*{Dh\big\vert_{\tigamma}\tigamma'}_{t=0}
    =\e\tigamma_2'(0)\label{eq:n3_polynomial_regularH_gammaDer1}
  \end{align}
  so $\tigamma_2'(0)=0$ and in particular $\tigamma'(0)=e_1$.
  Taking another derivative we get
  \begin{align}
    \begin{aligned}
    0&=\partial_t^2\brk*{h\circ\tigamma}\big\vert_{t=0}  \\
    &=\brk*{D^2h\big\vert_{\tigamma}\brk*{\tigamma',\tigamma'}+Dh\big\vert_{\tigamma}\tigamma''}_{t=0} \\
    &=\brk*{D^2h\big\vert_{x=0}\brk*{e_1,e_1}+Dh\big\vert_{x=0}\tigamma''}_{t=0} \\
    &=\e\brk*{2+\tigamma_2''}(0)
    \end{aligned}
    \label{eq:n3_polynomial_regularH_gammaDer2}
  \end{align}
  so $\tigamma''(0)=-2e_2$.
  The third derivative then yields
  \begin{align*}
    0&=\partial_t^3\brk*{h\circ\tigamma}\big\vert_{t=0} \\
    &=\brk*{D^3h\big\vert_{\tigamma}\brk*{\tigamma',\tigamma',\tigamma'}
    +3D^2h\big\vert_{\tigamma}\brk*{\tigamma',\tigamma''}
    +Dh\big\vert_{\tigamma}\tigamma'''}_{t=0} \\
    &=\brk*{D^3h\big\vert_{x=0}\brk*{e_1,e_1,e_1}
    -6D^2h\big\vert_{x=0}\brk*{e_1,e_2}
    +Dh\big\vert_{x=0}\tigamma'''}_{t=0} \\
    &=\brk*{-6+\e\brk*{\tigamma_2'''}}(0)
  \end{align*}
  so $\tigamma_2'''(0)=6/\e$.
  Analogously we observe that it follows from $0=\tiq_2\circ\tibeta$ that
  \begin{align}
    0=\e\partial_t\brk*{\tiq_2\circ\tibeta}\big\vert_{x=0}
    =\e\brk*{D\tiq_2\big\vert_{\tigamma}\tibeta'}_{t=0}
    \label{eq:n3_polynomial_regularH_betaDer1}
  \end{align}
  and
  \begin{align}
    0=\e\partial_t^2\brk*{\tiq_2\circ\tibeta}\big\vert_{x=0}
    =\e\brk*{D^2\tiq_2\big\vert_{\tigamma}\brk*{\tibeta',\tibeta'}+D\tiq_2\big\vert_{\tigamma}\tibeta''}_{t=0}\,.
    \label{eq:n3_polynomial_regularH_betaDer2}
  \end{align}
  By the relations \eqref{eq:n3_polynomial_regularH_DPDq}, equation \eqref{eq:n3_polynomial_regularH_betaDer1} is identical to
  equation \eqref{eq:n3_polynomial_regularH_gammaDer1} 
  and equation  \eqref{eq:n3_polynomial_regularH_betaDer2} is identical to equation 
  \eqref{eq:n3_polynomial_regularH_gammaDer2} with $\tigamma$ replaced by $\tibeta$.
  Now equations  \eqref{eq:n3_polynomial_regularH_gammaDer1} and  \eqref{eq:n3_polynomial_regularH_gammaDer2}
  determined $\tigamma'(0)$ and $\tigamma''(0)$ uniquely and thus we have that
  $\tigamma(0)=\tibeta(0)$, $\tigamma'(0)=\tibeta'(0)$ and $\tigamma''(0)=\tibeta''(0)$.
  For the third derivative we observe that
  \begin{align*}
    0&=\partial_t^3\brk*{\tiq_2\circ\tibeta}\big\vert_{t=0} \\
    &=\brk*{D^3\tiq_2\big\vert_{\tigamma}\brk*{\tibeta',\tibeta',\tibeta'}
    +3D^2\tiq_2\big\vert_{\tigamma}\brk*{\tibeta',\tibeta''}
    +D\tiq_2\big\vert_{\tigamma}\tibeta'''}_{t=0} \\
    &=\brk*{D^3\tiq_2\big\vert_{x=0}\brk*{e_1,e_1,e_1}
    -6D^2\tiq_2\big\vert_{x=0}\brk*{e_1,e_2}
    +D\tiq_2\big\vert_{x=0}\tibeta'''}_{t=0} \\
    &=\tibeta_2'''(0)
  \end{align*}
  so $\tibeta'''(0)=0$.
  Thus we obtain
  \begin{align*}
    \partial_t^k\brk*{\tigamma_2-\tibeta_2}\big\vert_{t=0}&=0 
  \end{align*}
  for $k\leq2$ and
  \begin{align*}
    \partial_t^3\brk*{\tigamma_2-\tibeta_2}\big\vert_{t=0}&=6/\e>0\,.
  \end{align*}
  Hence we indeed have that $\tigamma_2>\tibeta_2$ in a sufficiently small neighbourhood of the origin for $t>0$
  and also that  $\tigamma_2<\tibeta_2$ in a sufficiently small neighbourhood for $t<0$.

  Now that we have established that $\tigamma$ lies locally in $C$ it remains to be shown that
  $\tigamma$ indeed reaches the boundary $\partial W$.
  For this let $\tigamma\colon [0,b)\to C$ be a maximally extended parametrisation of $\tigamma$.
  Since $C$ is compact there exists a sequence $t_k\to b$ such that $x_k=\tigamma\brk*{t_k}\to x$
  is convergent. Then we have by continuity that also $h(x)=0$ so also $x\in\cV_\e$.
  As $\cV_\e$ is smooth we have that $Dh(x)$ is of full rank. Thus by the implicit function theorem 
  we must in fact have that $b<\infty$ and the parametrisation of $\tigamma$ can be extended beyond
  the point $b$. But this means that $x\in\partial C$.
  Again by smoothness $x$ cannot lie in the origin. 
  Now note that
  $\tiP_1(\e,\cdot)=\tiq_1<0$ on the arc $\tibeta$ and that
  $\tiP_1(\e,\cdot)=\tiq_2>0$ on the arc $\tialpha^+$.
  So $\tigamma$ cannot intersect $\partial C$ on $\tibeta$ or on $\tialpha$.
  Thus we must have that $x\in\partial W$ and hence $\tigamma$ splits $W$ in the right half plane into two parts.
  % Now we have that $0\in\widetilde{\cV}_\e$. Since
  % $\nabla_x\tiP(\e,0)=e_2$ there exists a curve $\tigamma$ 
  % By the intermediate value theorem thus there must be for each
  % $(x_1,0)\in W$ a corresponding point 
  % $(x_1,\tigamma(x_1))\in V_W\brk1{\tiP_1(\e,\cdot)}=\widetilde{\cV}_\e$ sandwiched between $\tibeta$ and $\tialpha^+$.  
  % Since $\widetilde{\cV}_\e$ is smooth $\tigamma$ in fact defines an arc which we also denote by $\tigamma$.
  % An analogous argumentation using signage extends $\tigamma$ to the third quadrant.
  % On the left half plane note that we have the symmetries
  % \begin{align*}
  %   \tiq_2(-x_1,x_2)=
  % \end{align*}
  On the left half plane the argumentation is analogous.
  Then $\tigamma$ divides the plane into two
  parts which yields the claim.
  For clarity the idea of the proof is also depicted in figure \ref{fi:n3_polynomial_intersectionOrigin_overview}.
  Also note that as a consequence $\widetilde{\cV}_\e$
  looks similar to figure \ref{fi:n3_polynomial_intersectionOriginRegular}.
  \begin{figure}
    \centering
    \begin{subfigure}[b]{0.3\textwidth}
    \centering
    \input{../Figures/n3_polynomial_intersectionOriginDegenerate_new.pdf_tex}
    \caption{Sketch of the set $V\brk*{\tiq_1}$.}
    \label{fi:n3_polynomial_intersectionOriginDegenerate}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.3\textwidth}
    \centering
    \input{../Figures/n3_polynomial_intersectionOriginLine_new.pdf_tex}
    \caption{Sketch of the set $V\brk*{\tiq_2}$.}
    \label{fi:n3_polynomial_intersectionOriginOtherTerm}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.3\textwidth}
    \centering
    \input{../Figures/n3_polynomial_intersectionOriginRegular_new.pdf_tex}
    \caption{Sketch of the set $\widetilde{\cV}_\e$.}
    \label{fi:n3_polynomial_intersectionOriginRegular}
    \end{subfigure}
    \caption{Sketches of varieties.}
  \end{figure}
  \begin{figure}
    \centering
    \input{../Figures/n3_polynomial_intersectionOrigin_overview.pdf_tex}
    \caption{An overview of the situation in proposition \ref{pr:n3_polynomial_regularH}.}
    \label{fi:n3_polynomial_intersectionOrigin_overview}
  \end{figure}
\end{proof}

% \begin{lemma}[Smooth curves in ]
%   Let $X\subseteq\R^2$ be compact and $\gamma=V_X(p)\subseteq X$ a smooth one-dimensional variety
%   intersecting the boundary.
%   Then $\gamma$ intersects the boundary at least twice. 
% \end{lemma}
% \begin{proof}
%   Let $\gamma\colon [a,b)\to X$ be a parametrisation of the curve $\gamma$, possibly excluding an endpoints.
%   Since $X$ is compact there exists a sequence $t_k\to b$ such that $x_k=\gamma\brk*{t_k}\to x$ is
%   convergent. Then we have by continuity that $p(x)=0$ so also $x\in V_X(p)$.
%   Since $V_X(p)$ is smooth we have that $Dp(x)$ is of full rank.
%   Thus by the implicit function theorem we must in fact have that $b<\infty$
%   and the parametrisation of $\gamma$ can in fact be
%   extended beyond the point $b$. But this means that $x\in\partial X$.
%   Analogous argumentation for a sequence $t_k\to a$ yields a further point on the boundary $\partial X$.
% \end{proof}

\section{An example with positive distance between the entrant and emergent boundaries}

In the previous example we showed that $\Sigma^+$ is separated from $\Sigma^-$ by the curve
$\Sigma^0=V\brk*{p_1,P_2(r,\cdot)}$. In the following we will show that it is possible to thicken 
this curve $\Sigma^0$ without loosing the fundamental properties of the solution. 
More concretely, we construct a harmonic function $f_\rho$ for which the entrant and
emergent boundaries are simply connected, have positive distance from one another
and such that $f_\rho$ has an interior stagnation point.
For this we use the notation from the previous example.
We need a preliminary result:
\begin{proposition}[Existence of a cutoff function]\label{pr:n3_thickening_cutoff}
  Let $\Sigma$ and $\Sigma^0$ be as in example \ref{ex:n3_polynomial_defn}. For every $\rho>0$ there exists a cutoff function $\theta_\rho\colon\Sigma\to[0,1]$ such that
  \begin{enumerate}
    \item $\theta_\rho=1$ outside of the tubular neighbourhood $\tubular_{\rho}\brk*{\Sigma^0}$,\label{en:n3_thickening_cutoff_1}
    \item $\theta_\rho$ has support contained in $\Sigma\setminus\Sigma^0$ and\label{en:n3_thickening_cutoff_2}
    \item $\brk[a]*{\theta_\rho p_1}_\Sigma=0$, where $\brk[a]*{h}_X\leftdef\int_Xh$ denotes the mean of a function $h\colon X\to Y$.\label{en:n3_thickening_cutoff_3}
  \end{enumerate}
\end{proposition}
\nomenclature{$\brk[a]*{h}_X$}{Mean $\int_Xh$ of a function $h\colon X\to Y$.}
\begin{proof}
  Let $\theta^+_\lambda\colon \Sigma\to[0,1]$ be a family of cutoff functions smoothly depending on $\lambda$ such that
  $\theta^+_\lambda=1$ outside of $\tubular_{\lambda}\brk*{\Sigma^0}\cup \Sigma^-$ and $\theta_\lambda^+$ has
  support contained in $\Sigma^+$.
  Analogously we let $\theta^-_\lambda\colon\Sigma\to[0,1]$ be a family of cutoff functions smoothly depending on $\lambda$
  such that $\theta^-_\lambda=1$ outside of $\tubular_{\lambda}\brk*{\Sigma^0}\cup \Sigma^+$ and $\theta_\lambda^-$ has
  support contained in $\Sigma^-$.
  We can also assume that both $\theta^+_\lambda$ and $\theta^-_\lambda$ are monotonously increasing in $\lambda$.
  Set 
  \begin{align}
    \titheta_\rho=\theta^+_\rho+\theta^-_{\lambda\brk*{\rho}}
    \label{eq:n3_thickening_cutoff_titheta}
  \end{align}
  where $\lambda\colon\R_{\geq0}\to\R_{\geq0}$
  is a suitably chosen map. By construction the support of $\titheta_\rho$ lies outside of 
  the set $\Sigma\setminus\Sigma^0$ so $\titheta_\rho$ fulfils condition \ref{en:n3_thickening_cutoff_2}.
  For condition \ref{en:n3_thickening_cutoff_3}
  we calculate
  \begin{align}
    \brk[a]*{\titheta_\rho p_1}_\Sigma
    =\brk[a]*{\theta_\rho^+p_1}_{\Sigma^+}+\brk[a]*{\theta_{\lambda\brk*{\rho}}^-p_1}_{\Sigma^-}
    \label{eq:n3_thickening_cutoff_meanVal}
  \end{align}
  Now we have that $p_1<0$ on $\Sigma^-$ and that $p_1>0$ on $\Sigma^+$.
  Thus $\brk[a]*{\theta_\rho^+p_1}_{\Sigma^+}>0$ is monotonically increasing with $\rho$ and
  \begin{align*}
    \brk[a]*{\theta_\rho^+p_1}_{\Sigma^+}\longrightarrow \brk[a]*{p_1}_{\Sigma^+}\rightdef c^+
  \end{align*}
  as $\rho\to0$.
  Analogously $\brk[a]*{\theta_{\lambda}^-p_1}_{\Sigma^-}<0$ is
  monotonically and continuously decreasing with $\lambda$ and 
  \begin{align*}
    \brk[a]*{\theta_\lambda^-p_1}_{\Sigma^-}\longrightarrow \brk[a]*{p_1}_{\Sigma^-}\rightdef c^-
  \end{align*}
  as $\lambda\to0$. It follows from the divergence theorem that
  \begin{align*}
    0=r\int_X\Delta f=\int_\Sigma r\nabla f\cdot n=\brk[a]*{p_1}_\Sigma
    =c^++c^-
  \end{align*}
  where $n\Sigma\to S^2$ is the outer unit normal.
  It then follows that for each $\rho>0$ there exists a $\lambda(\rho)>0$ such that
  \begin{align*}
    \brk[a]*{\theta_\rho^+p_1}_{\Sigma^+}=\brk[a]*{\theta_{\lambda(\rho)}^-p_1}_{\Sigma^-}
  \end{align*}
  so by equation \eqref{eq:n3_thickening_cutoff_meanVal} $\titheta_\rho$ also fulfils condition \ref{en:n3_thickening_cutoff_3}.
  In fact we can also assume that $\lambda(\rho)\to0$ as $\rho\to0$.
  Now choose $\tilambda(\rho)$ such that $\max\brk1{\tilambda,\lambda(\tilambda)}<\rho$.
  This defines a function $\tilambda\colon \R_{\geq0}\to\R_{\geq0}$ and we set
  $\theta_\rho\leftdef \titheta_{\tilambda(\rho)}$. 
  % It remains to show property \ref{en:n3_thickening_cutoff_1}.
  Property \ref{en:n3_thickening_cutoff_1} then follows from the fact that $\titheta_\rho=1$ outside of the neighbourhood $\tubular_{\max\brk*{\rho,\lambda(\rho)}}\brk*{\Sigma^0}$ by
  equation \ref{eq:n3_thickening_cutoff_titheta}.
\end{proof}
With the help of this cutoff function $\theta_\rho$ we can now formulate our main result in this section:
\begin{example}[Thickening $\Sigma^0$]
  \label{ex:n3_thickening}
  Let $f$ and $X$ be as in example \ref{ex:n3_polynomial_defn} and the cutoff function $\theta_\rho$ be as in
  the previous proposition.
  % Define for $\rho>0$ the cutoff function $\theta_\rho\colon\Sigma\to[0,1]$ by the
  % condition that $\theta_\rho=1$ outside of $\tubular_{\rho}\brk*{\Sigma^0}$ and 
  % support contained in $\supp\theta_\rho\subseteq\Sigma\setminus\Sigma^0$.
  % We additionally require that
  % \begin{align*}
  %   \brk[a]*{\theta_\rho p_1}_\Sigma=0
  % \end{align*}
  % where $\brk[a]*{h}_X\leftdef\int_Xh$ denotes the mean of a function $h\colon X\to Y$
  % and $p_1=r\nabla f\cdot n$ as in the previous section.
  % We argue first that such a cutoff function $\theta_\rho$ exists.
  Consider now the solution $f_\rho$ to the system
  \begin{align*}
    \Delta f_\rho&=0 &&\text{ on }X, \\
    \nabla f_\rho\cdot n&=\theta_\rho\brk*{\nabla f\cdot n} &&\text{ on }\Sigma, \\
    \brk[a]*{f_\rho}_X&=\brk[a]*{f}_X &&
  \end{align*}
  where $n\colon\Sigma\to S^2$ is the outer unit normal.
  By definition of $f_\rho$ the entrant and emergent boundaries are simply connected
  and have positive distance from one another.
  We will show in proposition \ref{pr:n3_thickening_cp} that there exists $\rho>0$ such that $f_\rho$ has an interior
  critical point.
\end{example}
\nomenclature{$\lesssim$}{$x\lesssim y$ means there exists a constant $c\geq1$ such that $x\leq cy$.}

\begin{proposition}[Structural stability]\label{pr:n3_thickening_cp}
  Let $x$ be a non-degenerate interior critical point of $f$.
  Then there exist $\Rho>0$ and $\e>0$ such that for all $\rho\leq\Rho$ the function $f_\rho$ from example
  \ref{ex:n3_thickening} has an interior critical point in $\overline{B}_\e(x)$.
\end{proposition}
\begin{proof}
  To simplify notation we only show this for the interior critical point of $f$ at the origin $x=0$.
  Define $g_\rho\leftdef f_\rho-f$.
  By linearity $g_\rho$ is a solution the system
  \begin{align*}
    \Delta g_\rho&=0 &&\text{ on }X, \\
    \nabla g_\rho\cdot n&=\brk*{\theta_\rho-1}\brk*{\nabla f\cdot n} &&\text{ on }\Sigma, \\
    \brk[a]*{g_\rho}_X&=0 &&
  \end{align*}
  To simplify notation we write $x\lesssim y$ instead of $x\leq cy$ for
  some constant $c\geq1$ which is independent of $\rho$.
  We have that
  \begin{align*}
    \\
    \norm*{Dg_\rho}_{L^2\brk*{X;\R^d}}^2
    &\annotateAbove{\text{divergence Theorem}}{=}{0.1}{0.1} \int_{\Sigma}g_\rho\brk*{\nabla g_\rho\cdot n} \\ \\
    &\annotateAbove{\text{Cauchy-Schwarz}}{\leq}{0}{0} \norm*{g_\rho}_{L^2\brk*{\Sigma}}\norm*{\nabla g_\rho\cdot n}_{L^2\brk*{\Sigma}} \\ \\
    &\annotateAbove{\text{trace theorem}}{\lesssim}{0}{0} \norm*{g_\rho}_{W^{1,2}\brk*{X}}\norm*{\nabla g_\rho\cdot n}_{L^2\brk*{\Sigma}} \\ \\
    &\annotateAbove{\text{Poincaré-Wirtinger}}{\lesssim}{0}{0} \norm*{Dg_\rho}_{L^2\brk*{X;\R^d}}\norm*{\nabla g_\rho\cdot n}_{L^2\brk*{\Sigma}}
  \end{align*}
  and thus together with dominated convergence
  % \begin{align*}
  %   \norm*{Dg_\rho}_{L^2\brk*{X;\R^d}}\lesssim\norm*{\nabla g_\rho\cdot n}_{L^2\brk*{\Sigma}}\,.
  % \end{align*}
  % Note that we have by dominated convergence
  \begin{align*}
    \norm*{Dg_\rho}_{L^2\brk*{X;\R^d}}\lesssim\norm*{\nabla g_\rho\cdot n}_{L^2\brk*{\Sigma}}
    =\norm*{\brk*{\theta_\rho-1} \brk*{\nabla f\cdot n}}_{L^2\brk*{\Sigma}}\longrightarrow0
  \end{align*}
  as $\rho\to0$.
  As a consequence of this we obtain on the one hand that for a compactly contained open set
  $\brk[c]*{0}\Subset U\Subset X$ with smooth boundary we have
  \begin{align}
    \begin{aligned}
    \\
    \norm*{Dg_\rho}_{L^\infty\brk*{U;\R^{d\times d}}}
    &\annotateAbove{\text{mean value property}}{\lesssim}{0}{0} \norm*{Dg_\rho}_{L^1\brk*{X;\R^{d\times d}}}\\ \\
    &\annotateAbove{\text{Cauchy-Schwarz}}{\lesssim}{0}{0} \norm*{Dg_\rho}_{L^2\brk*{X;\R^{d\times d}}}
    \longrightarrow0
    \end{aligned}
    \label{eq:n3_thickening_cp_dg}
  \end{align}
  as $\rho\to0$.
  It also follows for a compactly contained open set $U\Subset V\Subset X$ with smooth boundary that
  \begin{align}
    \begin{aligned}
    \\
    \norm*{D^2g_\rho}_{L^\infty\brk*{U;\R^{d\times d}}}
    &\annotateAbove{\text{mean value property}}{\lesssim}{0}{0} \norm*{D^2g_\rho}_{L^1\brk*{V;\R^{d\times d}}}\\ \\
    &\annotateAbove{\text{Cauchy-Schwarz}}{\lesssim}{0}{0} \norm*{D^2g_\rho}_{L^2\brk*{V;\R^{d\times d}}}\\ \\
    &\annotateAbove{\text{interior regularity}}{\lesssim}{0}{0} \norm*{Dg_\rho}_{L^2\brk*{X;\R^{d}}}\longrightarrow0
    \end{aligned}
    \label{eq:n3_thickening_cp_d2g}
  \end{align}
  as $\rho\to0$.
  % \begin{align*}
  %   \norm*{g_\rho}_{L^\infty\brk*{U_1}}
  %   \stackrel{\text{mean value property}}{\lesssim}\norm*{g_\rho}_{L^1\brk*{U_2}}
  %   \stackrel{\text{Poincaré-Wirtinger}}{\lesssim}\norm*{Dg_\rho}_{L^2\brk*{U_2}}
  %   \lesssim \norm*{Dg_\rho\cdot n}_{L^2\brk*{\partial U_2}}
  % \end{align*}
  % By interior regularity we have that
  % \begin{align*}
  %   \norm*{D^2g_\rho}_{L^\infty\brk*{U_1}}
  %   \lesssim \norm*{D^2g_\rho}_{L^2\brk*{U_2}}
  %   \lesssim \norm*{Dg_\rho}_{L^2\brk*{U_3}}
  %   \lesssim \norm*{Dg_\rho}_{L^\infty\brk*{U_4}}
  % \end{align*}
  % and by the divergence theorem further
  % \begin{align*}
  %   \norm*{Dg_\rho}_{L^2\brk*{U_3}}^2
  % \end{align*}
  % We claim that for $k\in\N$
  % \begin{align*}
  %   \norm*{D^k\brk*{f_\rho-f}}_{L^\infty\brk*{B_2}}\longrightarrow0\text{ as }\rho\to0\,.
  % \end{align*}
  % Indeed, setting $g_\rho\leftdef f_\rho-f$ one obtains from the mean value property of $g_\rho$ that
  % \begin{align*}
  %   \norm*{g_\rho}_{L^\infty\brk*{B_1}}
  %   &\stackrel{\text{mean value property}}{\lesssim}\norm*{g_\rho}_{L^1\brk*{B_r}} \\
  %   &\stackrel{\text{Poincaré-Wirtinger}}{\lesssim}\norm{\nabla g_\rho}_{L^1\brk*{B_r}} \\
  %   &\stackrel{\text{Hölder}}{\lesssim}\norm{\nabla g_\rho}_{L^2\brk*{B_r}} \\
  %   &=\brk*{\int_\Omega\Delta g_\rho^2\dif x}^{1/2} \\
  %   &\stackrel{\text{divergence theorem}}{=}\brk*{\int_\Sigma\nabla g_\rho^2\cdot n\dif x}^{1/2} \\
  %   &=\brk*{\int_\Sigma\brk*{\theta_\rho-1}\brk*{\nabla f\cdot n}\dif x}^{1/2}\longrightarrow0
  % \end{align*}
  % as $\rho\to0$. It then follows 
  % We then choose $\rho$ so small that

  We would like to apply a fixed point theorem. For this we define a mapping 
  \begin{align*}
    F_\rho\brk*{y}= y -D^2f\big\vert_0^{-1}Df_\rho(y)
  \end{align*}
  where we used the fact that $D^2f\big\vert_0$ is bijective by non-degeneracy.
  We denote by $\norm*{\cdot}_{\text{Op}}$ the operator norm induced by $L^\infty\brk*{U;\R^d}$, that is
  \begin{align*}
    \norm{h}_{\text{Op}}=\sup_{y\in L^\infty\brk*{U;\R^d}\setminus\brk[c]*{0}}\frac{\norm*{hy}_{L^\infty\brk*{U;\R^d}}}{\norm*{y}_{L^\infty\brk*{U;\R^d}}}
  \end{align*}
  for some function $h\in L^\infty\brk*{U;\R^{d\times d}}$.
  Set $U=B_\e\subseteq\R^3$ to be an open ball around the origin with radius $\e>0$.
  We calculate the derivative
  \begin{align*}
    DF_\rho=\Id -D^2f\big\vert_0^{-1}D^2f_\rho
  \end{align*}
  and take the operator norm
  \begin{align}
    \frac{1}{c}\norm*{DF_\rho}_{\text{Op}}\leq\norm*{D^2f\big\vert_0-D^2f_\rho}_{\text{Op}}
    \leq \norm*{D^2f\big\vert_0-D^2f}_{\text{Op}}+\norm*{D^2g_\rho}_{\text{Op}}
    \label{eq:n3_thickening_cp_DF}
  \end{align}
  for some constant $c\geq1$ independent of $\rho$.
  Now we have by continuity that
  $$\norm*{D^2f\big\vert_0-D^2f}_{\text{Op}}\lesssim \norm*{D^2f\big\vert_0-D^2f}_{L^\infty\brk*{U;\R^{d\times d}}}\longrightarrow0$$
  as $\e\to0$.
  Pick $\e>0$ such that $\norm*{D^2f\big\vert_0-D^2f}_{\text{Op}}\leq 1/\brk*{4c}$.
  Now we have for $\rho\to0$ that 
  $$\norm*{D^2g_\rho}_{\text{Op}}\lesssim\norm*{D^2g_\rho}_{L^\infty\brk*{U;\R^{d\times d}}}\longrightarrow0$$
  by equation
  \eqref{eq:n3_thickening_cp_d2g}. Thus there exists a $\Rho>0$ such that $\norm*{D^2g_\rho}_{\text{Op}}\leq1/\brk*{4c}$
  for all $\rho\leq\Rho$.
  By equation \eqref{eq:n3_thickening_cp_DF} it then follows that
  $\norm*{DF_\rho}_{\text{Op}}\leq 1/2$
  for all $\rho\leq\Rho$.
  Since we have by equation \eqref{eq:n3_thickening_cp_dg} that
  \begin{align*}
    \abs*{F_\rho(0)}=\abs*{D^2f\big\vert_0^{-1}Df_\rho(0)}
    \lesssim \abs{Df_\rho(0)}
    =\abs{Dg_\rho(0)}\leq\norm*{Dg_\rho}_{L^\infty\brk*{U;\R^d}}\longrightarrow0
  \end{align*}
  as $\rho\to0$ we can also additionally choose $\Rho>0$ such that for all $\rho\leq\Rho$ we have that
  $\abs*{F_\rho(0)}\leq \e/2$.
  We then have for all $\rho\leq\Rho$ that
  $F_\rho\brk*{\overline{B}_\e}\subseteq \overline{B}_\e$ and $F_\rho$ is a contraction.
  It then follows from fixed point theorems that for every $\rho\leq\Rho$
  the function $F_\rho$ has a fixed point, say $y_\rho\in \overline{B}_\e$. This then fulfils by the construction of $F_\rho$ the equation
  \begin{align*}
    y_\rho=F_\rho\brk*{y_\rho}=y_\rho-D^2f\big\vert_0^{-1}Df_\rho\brk*{y_\rho}
  \end{align*}
  which implies that $Df_\rho\brk*{y_\rho}=0$ and $y_\rho$ is an interior critical point.
\end{proof}



\chapter{No in- or outflow in $\R^2$}
\label{ch:n2_hvf_noInflowNoOutflow}

In the second part of this thesis we will discuss harmonic vector fields without
inflow or outflow through the boundary.
More generally we will first consider harmonic vector fields without boundary critical points.
Here we will show in proposition \ref{pr:n2_hvf_noInflowNoOutflow} that in $d=2$ dimensions there is a strong relation between the 
number of critical points and the domain topology.
More concretely we will show that the number of critical points $M$ equals under certain conditions the negative Euler characteristic $-\chi\brk*{X}$.
This relation between the domain topology in the plane and the number of critical points also shows up for instance
for Green functions for instance in
\cite[p.133]{Nehari1975}.
We will then discuss briefly how this relates to the Poincaré-Hopf index theorem.
After that we will give examples which illustrate these results.


% \begin{proposition}[Upper bound on $M$]
%   Let $d=2$ and $\Omega$ be a compact manifold with corners with Betti numbers $b_0=1$, and $b_1$.
%   Let further $u\colon X\to\R^2$ be 
%   a Morse harmonic vector field without inflow or outflow.
%   Then we have $$M+1\leq b_1\,.$$
% \end{proposition}
% \begin{proof}[Sketch of proof.]
%   As in the second proof of proposition \ref{pr:n2:hf:nonExistence} the critical manifolds form a directed multigraph.
%   Since no critical manifold can intersect with the boundary each vertex
%   of the graph has degree 4 and we thus have $2M$ edges. Now we obtain with Euler's polyhedron formula
%   for a planar graph with multiple components
%   \begin{align*}
%     \text{\# minimal cycles}
%     &= \text{\#faces}-1 \\
%     &= 1+\text{\#components}-\text{\#vertices}+\text{\#edges} -1 \\
%     &\geq 1+1-M+2M -1 = M+1
%   \end{align*}
%   Here we use the term `minimal' as in the second proof of proposition \ref{pr:n2:hf:nonExistence}.
%   Note that each minimal cycle must contain a hole of the domain since else we could restrict $u$ to a simply
%   connected region containing this cycle. Then by proposition \ref{pr:n2:hvf:simplyConnected} $u$ would correspond to the gradient of 
%   a harmonic function in this region and we would obtain a contradiction as in the proof of proposition \ref{pr:n2:hf:nonExistence}.
%   Hence the number of minimal cycles is a lower bound on the number of holes $b_1$ of the domain.
% \end{proof}

% In fact using the Morse inequalities we can obtain the stronger result.

\section{A condition on the number of stagnation points}
Our first result relates the number of critical points with the domain topology.
We shall give two proofs of this result, one involving Morse theory and the other involving
the argument principle. The reason for this is that the result follows quickly from the
argument principle. However, the techniques of the proof involving Morse theory generalise
more readily to $d=3$ dimensions.
\begin{proposition}\label{pr:n2_hvf_noInflowNoOutflow}
  Let $X\subset\R^2$ be a compact manifold with corners and Betti numbers $b_0=1$, and $b_1$
  and let $u\colon X\to\R^2$ be
  a strongly Morse harmonic vector field without boundary stagnation points.
  Then we have the relation $M=-\chi(X)$ where $M$ denotes the number of stagnation points and
  $\chi(X)$ is the Euler characteristic of $X$.
\end{proposition}
\begin{proof}
  We slit the domain $X$ such that it is homeomorphic to the disk as is 
  depicted in figure \ref{fi:n2_hvf_slitDomain}.
  Denote the slit by $\Gamma$. Since the number of interior stagnation points is 
  finite by proposition \ref{pr:finiteness_critical_points}, we can choose $\Gamma$ in such a way that it does not contain
  any interior stagnation points.
  We write denote the boundary of $\Gamma$ by $\gamma=\partial\Gamma=\Gamma\cap\Sigma$
  and define points $\brk[c]*{x_1,\dots,x_{2b_1}}=\gamma$.
  Note that there are $2b_1$ many such points.
  % We can assume that $\Gamma$ is a smooth manifold.
  % Now at the point $x_1$
  % we have that $u$ is parallel to the boundary $\Sigma$.
  % Thus we can slant
  % the cut in such a way such that $x_1$ is an essential stagnation point of index $0$ of $u$ on the stratification
  % of $\tiX$.
  % Here $\tiX$ denotes the covering space of $X$ generated by the cut $\Gamma$.
  % We denote the induced strata by $\Gamma$ also with $\Gamma$. Note that then $x_1$ is no
  % essential stagnation point for $-u$.
  % We modify the cut for the other points $x_2,\dots,x_{2b_1}$ as with $x_1$.
  Without loss of generality we can assume that $\Gamma$ and $u$ form an acute angle at each point of $\gamma$.
  The situation is depicted in figure \ref{fi:n2_hvf_slitDomain}.
  \begin{figure}
    \centering
    \input{../Figures/n2_cutOmega_noInflowNoOutflow.pdf_tex}
    \caption{How we slit the domain.}
    \label{fi:n2_hvf_slitDomain}
  \end{figure}
  For the following argumentation we require that $u$ is strongly Morse on the new domain $\tiX$ 
  so assume for a moment that this is the case.
  Since each $x_j$ is either an essential critical point of $u$ or of $-u$ on the slit domain $\tiX$ we have that
  \begin{align}
    \ind_{\gamma,0}(u)+\ind_{\gamma,0}(-u)=2b_1\,.\label{eq:n2_hvf_noInflowNoOutflow_relgamma}
  \end{align}
  Since there are no stagnation points on $\Sigma$ we have the relations
  \begin{align}
    \mu_k=\ind_{\Gamma,k}(u)+\ind_{\gamma,k}(u) \qquad\text{ and }\qquad
    \nu_k=\ind_{\Gamma,k}(-u)+\ind_{\gamma,k}(-u)\label{eq:n2_hvf_noInflowNoOutflow_relationsMuIndex}
  \end{align}
  for all $k\in\brk[c]*{0,1}$.
  All entrant stagnation points of $u$ on $\Gamma$ are also emergent
  stagnation points of $-u$ on $\Gamma$ (and vice versa) and hence we have the relations
  \begin{align}
    \ind_{\Gamma,0}(u)=\ind_{\Gamma,1}(-u) \qquad\text{ and }\qquad
    \ind_{\Gamma,1}(u)=\ind_{\Gamma,0}(-u)\,.\label{eq:n2_hvf_noInflowNoOutflow_relationsIndex}
  \end{align}
  Equations \eqref{eq:n2_hvf_noInflowNoOutflow_relationsMuIndex} and \eqref{eq:n2_hvf_noInflowNoOutflow_relationsIndex}
  yield 
  \begin{align}
    \mu_0-\ind_{\gamma,0}(u)=\nu_1 \qquad\text{ and }\qquad
    \mu_1=\nu_0-\ind_{\gamma,0}(-u)\,.\label{eq:n2_hvf_noInflowNoOutflow_relationsMuNu}
  \end{align}
  Since $\tiX$ is now simply connected $u$ is 
  by proposition \ref{pr:n2:hvf:simplyConnected}
  the gradient of a harmonic function $f$ on this new domain.
  For this $f$ we have the Morse inequalities
  \begin{align}
    M+\mu_1-\mu_0&=-\chi(\tiX)=-1 \label{eq:n2_hvf_MorseInequalities_1}
  \end{align}
  and for $-f$ the Morse inequalities
  \begin{align}
    M+\nu_1-\nu_0&=-\chi(\tiX)=-1\,. \label{eq:n2_hvf_MorseInequalities_2}
  \end{align}
  Adding equations \eqref{eq:n2_hvf_MorseInequalities_1} and \eqref{eq:n2_hvf_MorseInequalities_2} and using the relation
  \eqref{eq:n2_hvf_noInflowNoOutflow_relationsMuNu} and then \eqref{eq:n2_hvf_noInflowNoOutflow_relgamma} we obtain
  \begin{align*}
    -2=2M-\ind_{\gamma,0}(u)-\ind_{\gamma,0}(u)
    =2M-2b_1
  \end{align*}
  from which the claim follows.

  The claim remains to be shown in the case that $u$ is not strongly Morse on $\tiX$. In this case let
  $u^\e$ for $\e\in E$ be a strongly Morse function as in corollary \ref{co:density_boundaryGeneric}.
  Since the $x_1,\dots,x_{2b_1}\in\gamma$ are non-degenerate stagnation points of $u$
  due to the slanted angle at which
  $\Gamma$ approaches $\gamma$
  we obtain that
  \begin{align}
    \ind_{\gamma,k}\brk*{u^\e}=\ind_{\gamma,k}(u)\qquad\text{ and }\qquad 
    \ind_{\gamma,k}\brk*{-u^\e}=\ind_{\gamma,k}(-u)
    \label{eq:n2_disproof_morse_indexApprox}
  \end{align}
  By the same corollary $u^\e$ has no stagnation points on $\Sigma$.
  The claim then follows by the calculations above where we replace
  $u$ with $u^\e$ and then note that $M^\e=M$.
\end{proof}
We now give an alternative and simpler proof of proposition \ref{pr:n2_hvf_noInflowNoOutflow} using the argument principle.
\begin{proof}[Alternative proof]
  As before we slit the domain such that it is homeomorphic to a disk. By proposition \ref{pr:n2:hvf:simplyConnected} $u$ is the gradient of a
  harmonic function $f$ on this new domain $\tiX$. Let $h\in\Hol(\tiX)$ be the holomorphic function given by $h=\nabla f$.
  Let $\gamma$ traverse the boundary of the slit domain such that the domain lies to the left of $\gamma$.
  We now determine the change of argument $\arg h$ along $\gamma$. For this
  consider first the the slits. Since $\nabla f$ is continuously differentiable
  along the slit and $\gamma$ traverses the slit once in one direction and once in the other,
  the contribution to the change of $\arg h$ from the slits vanishes.
  On the other hand as $\gamma$ traverses the boundary $\Sigma$ the contribution to the change in
  argument of $\arg h$ is $2\pi$ for every hole in the domain 
  since $h\cdot\gamma'=u\cdot\gamma'$ does not change sign as $\gamma$ traverses a hole in clockwise direction.
  Similarly the contribution to the change in argument of $\arg h$ is $-2\pi$ for the outer boundary component
  which is traversed counterclockwise.
  Since we have $b_1$ holes in the domain the total change of $\arg h$ as $\gamma$ traverses $\Sigma$ is
  $2\pi(b_1-1)$.
  Since $h$ has no poles it follows from the argument principle (see for example \cite[Chapter VIII]{Gamelin2001}) that
  \begin{align*}
    2\pi(b_1-1)=\int_\gamma\dif\arg (h(z)) =  2\pi M
  \end{align*}
  from which the claim follows.
\end{proof}

We say that $u$ has no \emph{inflow} on a boundary subset $S\subseteq\Sigma$ if $\Sigma^-\cap S=\emptyset$ and
that it has no \emph{outflow} if $\Sigma^+\cap S=\emptyset$.
Armed with this definition we can give the following corollary.
\begin{corollary}\label{co:n2_noInflowNoOutflow}
  Let $X$ be a compact manifold with corners and $u\colon X\to\R^2$ a strongly Morse
  harmonic vector field without inflow or outflow on
  $\Sigma$. Then we have the relation $M=-\chi(X)$ where $M$ is the number of stagnation points
  and $\chi(X)$ is the Euler characteristic of $X$.
\end{corollary}
This corollary could also have been proved using the Poincaré-Hopf index theorem.
For this define:
\begin{definition}[{\cite[Definition 1.1.1]{Brasselet2009}}]
  The \emph{Poincaré-Hopf index} $\ind_{\text{PH},x}(f)$ of an isolated
  interior stagnation point $x$ of $u$ is the degree of the Gauss map $u/\abs{u}\colon S^{d-1}_\e(x)\to S^{d-1}$
   for sufficiently small $\e>0$.
  The \emph{total index} $\ind_{\text{PH}}(u)$ is the sum of indexes $\ind_{\text{PH},x}(f)$
  for every interior stagnation point $x$ of $u$.
\end{definition}
Note that in $d=2$ dimensions a point $x$ with Morse index $k$ has Poincaré-Hopf index $(-1)^k$.
Thus we have for a harmonic vector field in $d=2$ dimensions that $M=-\ind_\text{PH}(u)$ and thus corollary \ref{co:n2_noInflowNoOutflow}
also follows from the Poincaré-Hopf index theorem:
\begin{theorem}[Poincaré-Hopf index theorem, {\cite[§6]{Milnor1965}}]
  Let $u\colon X\to\R^d$ be a vector field on a manifold with corners without inflow. Then we have
  that the total index $\ind_\text{PH}(u)$ equals the Euler characteristic $\chi(X)$.
\end{theorem}
For a proof we refer the reader for instance to \cite[§6]{Milnor1965}.


\section{Examples of harmonic vector fields}

We would like to illustrate the previous results with examples.
We first give an example of a harmonic vector field in $d=2$ dimensions without 
inflow or outflow and with one stagnation point.
\begin{example}[No in- or outflow]
  Consider the stream function
  \begin{equation}
    \begin{aligned}
    \psi\colon\R^2\setminus\brk[c]*{-e_1,e_1}&\to\R \\
    x&\mapsto\Phi_2\brk*{x-e_1}+\Phi_2\brk*{x+e_1}
    \end{aligned}\label{eq:n2:hvf:noInflowNoOutflow}
  \end{equation}
  where $\Phi_2$ is as in example \ref{ex:n2_flowthroughHole}.
  A plot of the streamlines in figure \ref{pl:n2_hvf_noInflowNoOutflow}
  indicates that $u=\nabla^\perp\psi$
  in the domain $X=\psi^{-1}\brk*{[-1,1]}$ has the desired properties.
  \begin{figure}
    \centering
    \includegraphics[width=0.6\textwidth]{../Plots/HarmonicVectorFields_gr1.eps}
    \caption{A plot of $u=\nabla^\perp\psi$ in the domain $\psi^{-1}\brk*{[-1,1]}$.
      Here $\psi$ is given by equation \eqref{eq:n2:hvf:noInflowNoOutflow}.}
    \label{pl:n2_hvf_noInflowNoOutflow}
  \end{figure}
  Indeed, since $\psi$ is constant on each component of $\Sigma$ the function $u$ has 
  neither inflow nor outflow.
  It follows from $\psi(-x)=\psi(x)$ that $u(-x)=-u(x)$ 
  and thus the origin $x=0$ is a stagnation point.
  By proposition \ref{pr:n2_hvf_noInflowNoOutflow} it is in fact the
  sole stagnation point of $u$ on $X$.
\end{example}

In a second example given by \cite{Wahlen2023} we start with the domain rather than the function.
\begin{example}[No in- or outflow]
  Set $X=\overline{B_4}\setminus\brk*{B_1(2e_1)\cup B_1(-2e_1)}$ to be the domain.
  We let the stream function $\psi$ be determined by the system
  \begin{equation}
    \begin{aligned}
      \Delta \psi&=0 &&\text{on }\openX, \\
      \psi&=0 &&\text{on the outer ring }4S^1, \\
      \psi&=1 &&\text{on the inner rings }S^1(-2e_1)\cup S^1(2e_1),
    \end{aligned}\label{eq:n2:hvf:roundRegion:noInflowNoOutflow}
  \end{equation}
  and set $u=\nabla^\perp\psi$.
  A numerical solution to this system is plotted in figure \ref{pl:n2_hvf_roundRegion_noInflowNoOutflow}.
  \begin{figure}
    \centering
    \includegraphics[width=0.6\textwidth]{../Plots/HarmonicVectorFields_gr4.eps}
    \caption{A plot of $u=\nabla^\perp\psi$ where $\psi$ is the numerical solution to
    \eqref{eq:n2:hvf:roundRegion:noInflowNoOutflow}.}
    \label{pl:n2_hvf_roundRegion_noInflowNoOutflow}
  \end{figure}
  Again, it follows from symmetry that the origin is a stagnation point and
  from proposition \ref{pr:n2_hvf_noInflowNoOutflow} that it is in fact the sole stagnation point of $u$.
\end{example}

Our third example highlights the importance of assuming that $u$ be Morse in corollary \ref{co:n2_noInflowNoOutflow}.
\begin{example}[Stagnation points on the boundary]\label{ex:n2_noInflowOutflow_irregular}
  In this example given by \cite{Wahlen2023} we again start by fixing the domain.
  Let $X=\overline{B}_4\setminus\brk*{B_1(2e_1)\cup B_1(-2e_1)}$ be the domain as before.
  We let the stream function $\psi$ be determined by the system
  \begin{equation}
    \begin{aligned}
      \Delta \psi&=0 &&\text{on }\openX, \\
      \psi&=0 &&\text{on the outer ring }4S^1, \\
      \psi&=-1 &&\text{on the left inner ring }S^1(-2e_1), \\
      \psi&=1 &&\text{on the right inner ring }S^1(2e_1),
    \end{aligned}\label{eq:n2:hvf:roundRegion:InflowOutflow}
  \end{equation}
  and then set $u=\nabla^\perp\psi$.
  The numerical solution to this system is plotted in figure \ref{pl:n2_hvf_roundRegion_InflowOutflow}.
  \begin{figure}
    \centering
    \includegraphics[width=0.6\textwidth]{../Plots/HarmonicVectorFields_gr5.eps}
    \caption{A plot of $u=\nabla^\perp\psi$ where $\psi$ is the numerical solution to
    \eqref{eq:n2:hvf:roundRegion:InflowOutflow}.}
    \label{pl:n2_hvf_roundRegion_InflowOutflow}
  \end{figure}
  Here we obtain from the symmetry $\psi(-x_1,x_2)=\psi(x)$ that $\psi=0$ on
  the $x_2$-axis. Since also $\psi=0$ on $4S^1$ we have two stagnation points
  at $\pm4e_2$.
  This function again has no in- or outflow through the boundary. The domain contains
  two holes so $\chi\brk*{X}=-1$. Now $u$ has no interior stagnation point, seemingly contradicting
  corollary \ref{co:n2_noInflowNoOutflow}. But since the two stagnation points
  at $\pm4e_2$ lie on the boundary $u$ is in fact not Morse and thus we cannot apply corollary \ref{co:n2_noInflowNoOutflow}.
  This shows the importance of the assumption that $u$ is Morse.
  Proposition \ref{pr:n2_noInflowOutflow_halfBd}
  essentially states that in this case the stagnation points of $u$ on the boundary
  count half as much as stagnation points in the interior.
  This explains why there are two critical points in this example.
\end{example}

\begin{proposition}[Critical points on the boundary, {\cite[Theorem 1.1]{Alessandrini1992}}]\label{pr:n2_noInflowOutflow_halfBd}
  Let $X\subseteq\R^2$ be bounded with piecewise $C^{1,\alpha}$ boundary.
  Let further $f\colon X\to\R$ be harmonic, not constant on each connectivity component 
  and constant on each boundary component. Then there exist finitely many critical
  points $x_1,\dots,x_k\in X$ of $u$ with multiplicities $m_1,\dots,m_k$ and we have that
  \begin{align*}
    \sum_{x_j\in\openX}m_j+\frac{1}{2}\sum_{x_j\in \Sigma}m_j=-\chi\brk*{X}\,.
  \end{align*}
\end{proposition}
\begin{proof}
  The proof uses complex analysis techniques and can be found in \cite{Alessandrini1992}.
\end{proof}

\chapter{No in- or outflow in $\R^3$}

In $\R^3$ our results to question \ref{qu:noInflowNoOutflow} remain unsatisfactory.
Nonetheless we will state them in this final chapter.
The question from \cite[p.198]{Lortz1970} remains if it is possible to have a harmonic vector field in $\R^3$ with
interior stagnation point and no in- or outflow through the boundary.
This can be generalised to the question if it is possible to have a harmonic vector field
$u\colon \R^3\supseteq X\to\R^3$ with interior critical points and 
without critical points on the boundary.
We remark that the boundary $\Sigma$ cannot have a component homeomorphic to
the sphere $S^2$ as a direct consequence of the hairy ball theorem.
% We obtain as a quick consequence of the hairy ball theorem
% \begin{proposition}
%   Let $X$ have Betti numbers $b_0$, $b_1$ and $b_2$.
%   Let $u\colon X\to\R$
%   be a Morse harmonic vector field without boundary stagnation points. Then we have
%   \begin{align*}
%     b_2\leq b_1\,.
%   \end{align*}
% \end{proposition}
% \begin{proof} 
%   Assume not. Since $X$ has $b_2$ bubbles and $b_1$ holes there exists by the pigeon hole
%   principle a bubble $\Gamma\subseteq\Sigma$ without a hole. Since $u$ has no boundary stagnation points on $\Gamma$ we
%   the restriction $u\vert_\Gamma$ does not vanish. But $\Gamma$ is homeomorphic to the Ball in contradiction to the hairy ball theorem.
% \end{proof}
We can also give a nontrivial condition on the interior critical points of such a $u$
using the techniques of previous proofs:
\begin{proposition}
  Let $X\subseteq\R^3$ be a compact manifold with corners and Betti numbers $b_0$, $b_1$ and $b_2$.
  Let $u\colon X\to\R$ be a strongly Morse harmonic vector field without boundary critical points.
  Then the following relation for
  the interior type numbers of $u$ holds:
  \begin{align*}
    M_1=M_2\,.
  \end{align*}
\end{proposition}
\begin{proof}
  As in the two dimensional case we cut the domain $X$ with a surface $\Gamma$ such that the slit domain is
  homeomorphic to a ball with bubbles.
  Since the number of interior stagnation points of $u$ is finite by proposition \ref{pr:finiteness_critical_points}, we can choose $\Gamma$ in such a way
  that it does not contain any stagnation points. We also denote the arcs at which $\Gamma$ meets $\Sigma$ by 
  $\gamma_1,\dots,\gamma_{b_1}\subseteq\partial\Gamma$. Note that there are $b_1$ many such curves.
  We can assume that $\Gamma$ and the $\gamma_j$ are manifolds with corners and that $\Gamma$ approaches
  each $\gamma_j$ at a slanted angle.
  The cut now yields a new domain $\tiX$ which is a covering space of $X$.
  On this covering space we denote the cover of the cut $\Gamma$ and the sets $\gamma_j$ by
  $\Gamma^i$ and $\gamma_j^i$ with $i\in\brk*{1,2}$.
  Since this new domain $\tiX$ is homeomorphic to a ball with bubbles
  the vector field $u=\nabla f$ is the gradient of a harmonic function $f$ by proposition \ref{pr:n2:hvf:simplyConnected}.
  For the following argumentation we require that $u$ is strongly Morse on $\tiX$, so assume for a moment that this is the case.
  Now we have that each $\gamma_j$ is homeomorphic to the circle $S^1\subseteq\R^2$.
  Since $f$ is non-degenerate the number of maxima and minima of $f$ on $\gamma_j^1\cup\gamma_j^2$ must be equal and thus
  \begin{align}
    \sum_i\brk*{\ind_{\gamma_j^i,0}(f)+\ind_{\gamma_j^i,1}(-f)}=\sum_i\brk*{\ind_{\gamma_j^i,1}(f)+\ind_{\gamma_j^i,0}(-f)}\,.
    \label{eq:n3_hvf_noInflowNoOutflow_maxMinRel}
  \end{align}

  Since on $\Gamma$ all entrant stagnation points of $u$ are also emergent
  stagnation points of $-u$ (and vice versa) we have the relations
  \begin{equation}
    \begin{aligned}
    \ind_{\Gamma^1,0}(\pm u)&=\ind_{\Gamma^2,2}(\mp u) \\
    \ind_{\Gamma^1,1}(\pm u)&=\ind_{\Gamma^2,1}(\mp u) \\
    \ind_{\Gamma^1,2}(\pm u)&=\ind_{\Gamma^2,0}(\mp u)\,.
    \end{aligned}\label{eq:n3_hvf_noInflowNoOutflow_relationsIndex}
  \end{equation}
  % and similarly we obtain on $\gamma_j^i$ the relations
  % \begin{equation}
  %   \begin{aligned}
  %   \ind_{\gamma^1,0}(\pm u)&=\ind_{\gamma^2,1}(\mp u) \\
  %   \ind_{\gamma^1,1}(\pm u)&=\ind_{\gamma^2,0}(\mp u)\,.
  %   \end{aligned}\label{eq:n3_hvf_noInflowNoOutflow_relationsIndex_gamma}
  % \end{equation}
  As there are no boundary critical points on $\Sigma$ it follows for the 
  boundary type numbers that
  \begin{equation}
    \begin{aligned}
    \mu_k=\sum_i\brk*{\ind_{\Gamma^i,k}+\sum_j\ind_{\gamma_j^i,k}}(f) \\
    \nu_k=\sum_i\brk*{\ind_{\Gamma^i,k}+\sum_j\ind_{\gamma_j^i,k}}(-f)\,.
    \end{aligned}\label{eq:n3_hvf_noInflowNoOutflow_relationsMuIndex}
  \end{equation}
  Equations \eqref{eq:n3_hvf_noInflowNoOutflow_relationsMuIndex} and \eqref{eq:n3_hvf_noInflowNoOutflow_relationsIndex}
  yield
  \begin{equation}
    \begin{aligned}
    \mu_0-\nu_2&=\sum_{i,j}\ind_{\gamma_j^i,0}(f) \\
    \mu_1-\nu_1&=\sum_{i,j}\brk*{\ind_{\gamma_j^i,1}(f)-\ind_{\gamma_j^i,1}(-f)} \\
    \mu_2-\nu_0&=-\sum_{i,j}\ind_{\gamma_j^i,0}(-f)
    \end{aligned}
    \label{eq:n3_hvf_noInflowNoOutflow_relationsMuNu}
  \end{equation}
  For $f$ we have the Morse inequalities
  \begin{align}
    M_2+\mu_2-M_1-\mu_1+\mu_0&=-\chi\brk*{\tiX} \label{eq:n3_hvf_MorseInequalities_1}
  \end{align}
  and for $-f$ the Morse inequalities
  \begin{align}
    M_1+\nu_2-M_2-\nu_1+\nu_0=-\chi\brk*{\tiX} \label{eq:n3_hvf_MorseInequalities_2}\,.
  \end{align}
  Subtracting equation \eqref{eq:n3_hvf_MorseInequalities_2} from \eqref{eq:n3_hvf_MorseInequalities_1} and using the relation
  \eqref{eq:n3_hvf_noInflowNoOutflow_relationsMuNu} we obtain
  together with equation \eqref{eq:n3_hvf_noInflowNoOutflow_maxMinRel} that
  \begin{align*}
    0&=2\brk*{M_2-M_1}
    +\sum_{i,j}\brk*{\ind_{\gamma_j^i,0}(f)
    -\ind_{\gamma_j^i,1}(f)
    +\ind_{\gamma_j^i,1}(-f)
    -\ind_{\gamma_j^i,0}(-f)} \\
    &=2\brk*{M_2-M_1}
  \end{align*}
  from which the claim follows.

  The claim remains to be shown in the case that $f$ is not strongly Morse on $X^+$ and $X^-$. In this case let
  $f^\e$ for $\e\in E$ be a strongly Morse function as in corollary \ref{co:density_boundaryGeneric}.
  Since $x_1$, $x_2$ are non-degenerate critical points of $f$
  due to the slanted angle at which
  $\Gamma$ approaches each $\gamma_j$
  we obtain that
  \begin{align}
    \ind_{\gamma_j,k}\brk*{f^\e}=\ind_{\gamma_j,k}(f)\qquad\text{ and }\qquad 
    \ind_{\gamma_j,k}\brk*{-f^\e}=\ind_{\gamma_j,k}(-f)
    \label{eq:n3_hvf_noInflowNoOutflow_morse_indexApprox}
  \end{align}
  By the same corollary we can assume that $f^\e$ has no critical points on
  $\Sigma$.
  The claim then follows by the calculations above where we replace
  $f$ with $f^\e$ and then note that $M_1^\e=M_1$ and $M_2^\e=M_2$.
\end{proof}

As a consequence we obtain the following:
\begin{corollary}
  Let $X$ be a compact manifold with corners and $u\colon X\to\R^d$ a strongly Morse harmonic vector field
  without inflow or outflow on the boundary $\Sigma$. The we have that
  \begin{align*}
    M_1=M_2\,.
  \end{align*}
\end{corollary}



% \printnomenclature

\glsaddall
\printunsrtglossary[type=symbols,style=long]


% TODO: potentially add Irwin, smooth dynamical systems
% \chapter{Bibliography}
%Main source
%\printbibliography[heading=none, keyword={main}]
%\noindent Other sources

\nocite{*}
\printbibliography
\td{add literature, check that all literature is used.}

\includepdf[pages={2}]{../Mall/omslag.pdf}

\end{document}